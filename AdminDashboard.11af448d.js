function e(e,s,a,t){Object.defineProperty(e,s,{get:a,set:t,enumerable:!0,configurable:!0})}function s(e){return e&&e.__esModule?e.default:e}var a=globalThis.parcelRequire3f2f,t=a.register;t("dXtBz",function(s,t){Object.defineProperty(s.exports,"__esModule",{value:!0,configurable:!0}),e(s.exports,"default",()=>j);var l=a("ayMG0"),i=a("acw62"),r=a("aOD4d"),c=a("2A5UH"),n=a("4XiCD"),d=a("v5TqP"),o=a("hyYFF"),h=a("gqAsg"),m=a("izP1S"),u=a("fAZ67"),x=a("6AR8M"),b=a("ilpIi");function j({user:e,onLogout:s}){let[a,t]=(0,i.useState)([]),[j,f]=(0,i.useState)([]),[p,g]=(0,i.useState)([]),[v,y]=(0,i.useState)(null),[N,S]=(0,i.useState)([]),[C,P]=(0,i.useState)(!1),[A,D]=(0,i.useState)({name:""}),[E,T]=(0,i.useState)({id:null,name:"",username:"",password:"",freePeriodMode:"auto",manualFreePeriods:0}),[k,w]=(0,i.useState)({id:null,className:"",name:"",subjectType:"Core",hoursPerWeek:6,isContinuous:!1,blockSize:2,teacher:""}),_=j.filter(e=>"staff"===e.role),M=(e,s)=>{S(a=>[...a,{message:e,type:s}])};(0,i.useEffect)(()=>{(async()=>{P(!0);try{let e=await (0,b.getDocs)((0,b.collection)(u.db,"classes")),s=await (0,b.getDocs)((0,b.collection)(u.db,"staff")),a=await (0,b.getDocs)((0,b.collection)(u.db,"subjects")),l=await (0,b.getDocs)((0,b.collection)(u.db,"timetable"));t(e.docs.map(e=>({id:e.id,...e.data()}))),f(s.docs.map(e=>({id:e.id,...e.data()}))),g(a.docs.map(e=>({id:e.id,...e.data()}))),l.empty||y(l.docs[0].data()),M("Data loaded successfully","success")}catch(e){M("âš  Could not load cloud data","error"),console.error(e)}P(!1)})()},[]);let F=async()=>{if(!A.name)return M("Enter class name","error");if(a.find(e=>e.name===A.name))return M("Class already exists","error");try{let e=await (0,b.addDoc)((0,b.collection)(u.db,"classes"),{name:A.name});t([...a,{id:e.id,name:A.name}]),D({name:""}),M("Class added successfully!","success")}catch(e){M("Failed to add class","error")}},R=async e=>{if(window.confirm("Delete this class?"))try{await (0,b.deleteDoc)((0,b.doc)(u.db,"classes",e)),t(a.filter(s=>s.id!==e)),M("Class deleted","success")}catch(e){M("Failed to delete class","error")}},W=async()=>{if(!E.name||!E.username)return M("Fill all required fields","error");try{if(E.id){let{password:e,...s}=E;return await (0,b.updateDoc)((0,b.doc)(u.db,"staff",E.id),s),f(j.map(e=>e.id===E.id?{...e,...s}:e)),Y(),M("Staff updated successfully!","success")}if(!E.password)return M("Password required for new staff","error");let e=`${E.username}@timetable.com`,s=(await (0,x.createUserWithEmailAndPassword)(u.auth,e,E.password)).user.uid,a={name:E.name,username:E.username,freePeriodMode:E.freePeriodMode,manualFreePeriods:E.manualFreePeriods,role:"staff",firebaseUid:s},t=await (0,b.addDoc)((0,b.collection)(u.db,"staff"),a);await (0,b.setDoc)((0,b.doc)(u.db,"users",s),{fullName:E.name,username:E.username,role:"staff"}),f([...j,{id:t.id,...a}]),Y(),M("Staff added successfully!","success")}catch(e){M("âš  Staff operation failed: "+e.message,"error")}},$=e=>{T({...e,password:""}),window.scrollTo({top:0,behavior:"smooth"})},Y=()=>{T({id:null,name:"",username:"",password:"",freePeriodMode:"auto",manualFreePeriods:0})},I=async e=>{if(window.confirm("Delete this staff member?"))try{await (0,b.deleteDoc)((0,b.doc)(u.db,"staff",e)),f(j.filter(s=>s.id!==e)),M("Staff deleted","success")}catch(e){M("Failed to delete staff","error")}},z=async()=>{if(!k.className||!k.name||!k.teacher)return M("Fill all required fields","error");try{if(k.id)return await (0,b.updateDoc)((0,b.doc)(u.db,"subjects",k.id),k),g(p.map(e=>e.id===k.id?k:e)),O(),M("Subject updated successfully!","success");let e=await (0,b.addDoc)((0,b.collection)(u.db,"subjects"),k);g([...p,{id:e.id,...k}]),O(),M("Subject added successfully!","success")}catch(e){M("Subject operation failed","error")}},B=e=>{w(e),window.scrollTo({top:document.getElementById("subject-section").offsetTop-100,behavior:"smooth"})},O=()=>{w({id:null,className:"",name:"",subjectType:"Core",hoursPerWeek:6,isContinuous:!1,blockSize:2,teacher:""})},H=async e=>{if(window.confirm("Delete this subject?"))try{await (0,b.deleteDoc)((0,b.doc)(u.db,"subjects",e)),g(p.filter(s=>s.id!==e)),M("Subject deleted","success")}catch(e){M("Failed to delete subject","error")}},L=async()=>{P(!0);try{let e=new(0,m.TimetableGenerator)(a,_,p),s=e.validate();if(!s.valid){M("Validation errors: "+s.errors.join("; "),"error"),P(!1);return}let t=e.generate();if(t.success){let e={classTimetables:t.classTimetables,staffTimetables:t.staffTimetables},s=(0,b.collection)(u.db,"timetable"),a=await (0,b.getDocs)(s);a.empty?await (0,b.addDoc)(s,e):await (0,b.updateDoc)((0,b.doc)(u.db,"timetable",a.docs[0].id),e),y(e),M("Timetable generated successfully!","success"),setTimeout(()=>{document.getElementById("view-timetables")?.scrollIntoView({behavior:"smooth"})},1e3)}else M("Generation failed: "+t.error,"error")}catch(e){M("Error: "+e.message,"error")}P(!1)};return C?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.default,{}),(0,l.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",color:"white",fontSize:"24px"},children:"Loading..."})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.default,{}),(0,l.jsx)("div",{className:"header",children:(0,l.jsxs)("div",{className:"header-content",children:[(0,l.jsx)("h1",{children:"ðŸ« Admin Dashboard"}),(0,l.jsxs)("div",{className:"header-actions",children:[(0,l.jsx)("button",{className:"theme-toggle",children:"ðŸŒ™"}),(0,l.jsx)("button",{className:"btn btn-danger btn-sm",onClick:s,children:"Logout"})]})]})}),(0,l.jsxs)("div",{className:"content",children:[(0,l.jsxs)("div",{className:"section",children:[(0,l.jsxs)("div",{className:"section-header",children:[(0,l.jsx)("span",{className:"section-icon",children:"ðŸ“š"}),(0,l.jsx)("h2",{className:"section-title",children:"Manage Classes"})]}),(0,l.jsxs)("div",{className:"card",children:[(0,l.jsx)("h3",{children:"Add New Class"}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Class Name (e.g., CS3A, EE2B)"}),(0,l.jsx)("input",{type:"text",value:A.name,onChange:e=>D({name:e.target.value.toUpperCase()}),placeholder:"Enter class name",style:{padding:"14px",fontSize:"15px"}})]}),(0,l.jsx)("button",{className:"btn btn-primary",onClick:F,children:"âž• Add Class"})]}),(0,l.jsxs)("div",{className:"card",children:[(0,l.jsxs)("h3",{children:["Existing Classes (",a.length,")"]}),0===a.length?(0,l.jsx)("p",{style:{color:"#64748b",textAlign:"center",padding:"20px"},children:"No classes added yet"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"desktop-table",children:(0,l.jsxs)("table",{children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"#"}),(0,l.jsx)("th",{children:"Class Name"}),(0,l.jsx)("th",{children:"Subjects"}),(0,l.jsx)("th",{children:"Total Hours"}),(0,l.jsx)("th",{children:"Actions"})]})}),(0,l.jsx)("tbody",{children:a.map((e,s)=>{let a=p.filter(s=>s.className===e.name),t=a.reduce((e,s)=>e+s.hoursPerWeek,0);return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:s+1}),(0,l.jsx)("td",{children:(0,l.jsx)("strong",{children:e.name})}),(0,l.jsx)("td",{children:a.length}),(0,l.jsx)("td",{children:(0,l.jsxs)("span",{style:{padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:600,background:30===t?"#10b981":"#ef4444",color:"white"},children:[t,"/30h"]})}),(0,l.jsx)("td",{children:(0,l.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>R(e.id),children:"ðŸ—‘ï¸ Delete"})})]},e.id)})})]})}),(0,l.jsx)("div",{className:"mobile-cards",children:a.map((e,s)=>{let a=p.filter(s=>s.className===e.name),t=a.reduce((e,s)=>e+s.hoursPerWeek,0);return(0,l.jsxs)("div",{className:"mobile-card",children:[(0,l.jsxs)("div",{className:"mobile-card-header",children:[(0,l.jsx)("span",{className:"mobile-card-title",children:e.name}),(0,l.jsxs)("span",{className:"mobile-card-badge",children:["#",s+1]})]}),(0,l.jsxs)("div",{className:"mobile-card-body",children:[(0,l.jsxs)("div",{className:"mobile-card-row",children:[(0,l.jsx)("span",{className:"mobile-card-label",children:"Subjects:"}),(0,l.jsx)("span",{className:"mobile-card-value",children:a.length})]}),(0,l.jsxs)("div",{className:"mobile-card-row",children:[(0,l.jsx)("span",{className:"mobile-card-label",children:"Hours:"}),(0,l.jsxs)("span",{className:"mobile-card-value",children:[t,"/30h"]})]})]}),(0,l.jsx)("div",{className:"mobile-card-actions",children:(0,l.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>R(e.id),children:"Delete"})})]},e.id)})})]})]})]}),(0,l.jsxs)("div",{className:"section",children:[(0,l.jsxs)("div",{className:"section-header",children:[(0,l.jsx)("span",{className:"section-icon",children:"ðŸ‘¥"}),(0,l.jsx)("h2",{className:"section-title",children:"Manage Staff"})]}),(0,l.jsxs)("div",{className:"card",children:[(0,l.jsx)("h3",{children:E.id?"âœï¸ Edit Staff":"âž• Add New Staff"}),(0,l.jsxs)("div",{className:"grid-2",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Full Name *"}),(0,l.jsx)("input",{type:"text",placeholder:"Dr. John Doe",value:E.name,onChange:e=>T({...E,name:e.target.value})})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Username *"}),(0,l.jsx)("input",{type:"text",placeholder:"john",disabled:!!E.id,value:E.username,onChange:e=>T({...E,username:e.target.value}),style:E.id?{background:"#f1f5f9"}:{}})]}),!E.id&&(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Password *"}),(0,l.jsx)("input",{type:"password",placeholder:"Password",value:E.password,onChange:e=>T({...E,password:e.target.value})})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Free Period Mode"}),(0,l.jsxs)("select",{value:E.freePeriodMode,onChange:e=>T({...E,freePeriodMode:e.target.value}),children:[(0,l.jsx)("option",{value:"auto",children:"Auto"}),(0,l.jsx)("option",{value:"manual",children:"Manual"})]})]})]}),"manual"===E.freePeriodMode&&(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Free Periods per Week"}),(0,l.jsx)("input",{type:"number",min:"0",max:"30",value:E.manualFreePeriods,onChange:e=>T({...E,manualFreePeriods:parseInt(e.target.value)||0})})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,l.jsx)("button",{className:"btn btn-primary",onClick:W,children:E.id?"ðŸ’¾ Save Changes":"âž• Add Staff"}),E.id&&(0,l.jsx)("button",{className:"btn btn-danger",onClick:Y,children:"âŒ Cancel"})]})]}),(0,l.jsxs)("div",{className:"card",children:[(0,l.jsxs)("h3",{children:["Existing Staff (",_.length,")"]}),0===_.length?(0,l.jsx)("p",{style:{color:"#64748b",textAlign:"center",padding:"20px"},children:"No staff added yet"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"desktop-table",children:(0,l.jsxs)("table",{children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"S.No"}),(0,l.jsx)("th",{children:"Name"}),(0,l.jsx)("th",{children:"Username"}),(0,l.jsx)("th",{children:"Free Period Mode"}),(0,l.jsx)("th",{children:"Actions"})]})}),(0,l.jsx)("tbody",{children:_.map((e,s)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsxs)("span",{className:"staff-badge",children:["S",s+1]})}),(0,l.jsx)("td",{children:(0,l.jsx)("strong",{children:e.name})}),(0,l.jsx)("td",{children:e.username}),(0,l.jsx)("td",{children:"manual"===e.freePeriodMode?`Manual (${e.manualFreePeriods} free)`:"Auto"}),(0,l.jsxs)("td",{children:[(0,l.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>$(e),style:{marginRight:"5px"},children:"âœï¸ Edit"}),(0,l.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>I(e.id),children:"ðŸ—‘ï¸ Delete"})]})]},e.id))})]})}),(0,l.jsx)("div",{className:"mobile-cards",children:_.map((e,s)=>(0,l.jsxs)("div",{className:"mobile-card",children:[(0,l.jsxs)("div",{className:"mobile-card-header",children:[(0,l.jsx)("span",{className:"mobile-card-title",children:e.name}),(0,l.jsxs)("span",{className:"mobile-card-badge",children:["S",s+1]})]}),(0,l.jsxs)("div",{className:"mobile-card-body",children:[(0,l.jsxs)("div",{className:"mobile-card-row",children:[(0,l.jsx)("span",{className:"mobile-card-label",children:"Username:"}),(0,l.jsx)("span",{className:"mobile-card-value",children:e.username})]}),(0,l.jsxs)("div",{className:"mobile-card-row",children:[(0,l.jsx)("span",{className:"mobile-card-label",children:"Mode:"}),(0,l.jsx)("span",{className:"mobile-card-value",children:"manual"===e.freePeriodMode?`Manual (${e.manualFreePeriods} free)`:"Auto"})]})]}),(0,l.jsxs)("div",{className:"mobile-card-actions",children:[(0,l.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>$(e),children:"âœï¸ Edit"}),(0,l.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>I(e.id),children:"ðŸ—‘ï¸ Delete"})]})]},e.id))})]})]})]}),(0,l.jsxs)("div",{className:"section",id:"subject-section",children:[(0,l.jsxs)("div",{className:"section-header",children:[(0,l.jsx)("span",{className:"section-icon",children:"ðŸ“–"}),(0,l.jsx)("h2",{className:"section-title",children:"Manage Subjects"})]}),k.className&&(0,l.jsx)(n.default,{className:k.className,subjects:p}),(0,l.jsxs)("div",{className:"card",children:[(0,l.jsx)("h3",{children:k.id?"âœï¸ Edit Subject":"âž• Add New Subject"}),(0,l.jsxs)("div",{className:"grid-2",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Select Class *"}),(0,l.jsxs)("select",{value:k.className,onChange:e=>w({...k,className:e.target.value}),children:[(0,l.jsx)("option",{value:"",children:"-- Select Class --"}),a.map(e=>(0,l.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Subject Name *"}),(0,l.jsx)("input",{type:"text",value:k.name,onChange:e=>w({...k,name:e.target.value}),placeholder:"DBMS, AI Lab, etc."})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Subject Type *"}),(0,l.jsxs)("select",{value:k.subjectType,onChange:e=>w({...k,subjectType:e.target.value}),children:[(0,l.jsx)("option",{value:"Core",children:"Core"}),(0,l.jsx)("option",{value:"Elective",children:"Elective"}),(0,l.jsx)("option",{value:"Lab",children:"Lab"}),(0,l.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Hours per Week *"}),(0,l.jsx)("input",{type:"number",min:"1",max:"30",value:k.hoursPerWeek,onChange:e=>w({...k,hoursPerWeek:parseInt(e.target.value)||6})})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Teacher *"}),(0,l.jsxs)("select",{value:k.teacher,onChange:e=>w({...k,teacher:e.target.value}),children:[(0,l.jsx)("option",{value:"",children:"-- Select Teacher --"}),_.map(e=>(0,l.jsx)("option",{value:e.name,children:e.name},e.id))]})]})]}),(0,l.jsxs)("div",{className:"checkbox-group",children:[(0,l.jsx)("input",{type:"checkbox",id:"continuous",checked:k.isContinuous,onChange:e=>w({...k,isContinuous:e.target.checked})}),(0,l.jsx)("label",{htmlFor:"continuous",style:{marginBottom:0},children:"Continuous Lab Block"})]}),k.isContinuous&&(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Block Size"}),(0,l.jsxs)("select",{value:k.blockSize,onChange:e=>w({...k,blockSize:parseInt(e.target.value)}),children:[(0,l.jsx)("option",{value:2,children:"2 Periods"}),(0,l.jsx)("option",{value:3,children:"3 Periods"})]})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,l.jsx)("button",{className:"btn btn-primary",onClick:z,children:k.id?"ðŸ’¾ Save Changes":"âž• Add Subject"}),k.id&&(0,l.jsx)("button",{className:"btn btn-danger",onClick:O,children:"âŒ Cancel"})]})]}),(0,l.jsxs)("div",{className:"card",children:[(0,l.jsxs)("h3",{children:["Existing Subjects (",p.length,")"]}),0===p.length?(0,l.jsx)("p",{style:{color:"#64748b",textAlign:"center",padding:"20px"},children:"No subjects added yet"}):(0,l.jsx)(l.Fragment,{children:a.map(e=>{let s=p.filter(s=>s.className===e.name);if(0===s.length)return null;let a=s.reduce((e,s)=>e+s.hoursPerWeek,0);return(0,l.jsxs)("div",{style:{marginBottom:"30px"},children:[(0,l.jsxs)("h4",{style:{marginBottom:"15px",display:"flex",alignItems:"center",gap:"10px",color:"#1e293b"},children:["Class: ",e.name,(0,l.jsxs)("span",{style:{padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:600,background:30===a?"#10b981":"#ef4444",color:"white"},children:[a,"/30 hours"]})]}),(0,l.jsx)("div",{className:"desktop-table",children:(0,l.jsxs)("table",{children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Subject"}),(0,l.jsx)("th",{children:"Type"}),(0,l.jsx)("th",{children:"Hours"}),(0,l.jsx)("th",{children:"Teacher"}),(0,l.jsx)("th",{children:"Lab"}),(0,l.jsx)("th",{children:"Actions"})]})}),(0,l.jsx)("tbody",{children:s.map(e=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsx)("strong",{children:e.name})}),(0,l.jsx)("td",{children:e.subjectType}),(0,l.jsxs)("td",{children:[e.hoursPerWeek,"h"]}),(0,l.jsx)("td",{children:e.teacher}),(0,l.jsx)("td",{children:e.isContinuous?`Yes (${e.blockSize}p)`:"No"}),(0,l.jsxs)("td",{children:[(0,l.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>B(e),style:{marginRight:"5px"},children:"âœï¸ Edit"}),(0,l.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>H(e.id),children:"ðŸ—‘ï¸ Delete"})]})]},e.id))})]})}),(0,l.jsx)("div",{className:"mobile-cards",children:s.map(e=>(0,l.jsxs)("div",{className:"mobile-card",children:[(0,l.jsxs)("div",{className:"mobile-card-header",children:[(0,l.jsx)("span",{className:"mobile-card-title",children:e.name}),(0,l.jsx)("span",{className:"mobile-card-badge",children:e.subjectType})]}),(0,l.jsxs)("div",{className:"mobile-card-body",children:[(0,l.jsxs)("div",{className:"mobile-card-row",children:[(0,l.jsx)("span",{className:"mobile-card-label",children:"Hours:"}),(0,l.jsxs)("span",{className:"mobile-card-value",children:[e.hoursPerWeek,"h"]})]}),(0,l.jsxs)("div",{className:"mobile-card-row",children:[(0,l.jsx)("span",{className:"mobile-card-label",children:"Teacher:"}),(0,l.jsx)("span",{className:"mobile-card-value",children:e.teacher})]}),(0,l.jsxs)("div",{className:"mobile-card-row",children:[(0,l.jsx)("span",{className:"mobile-card-label",children:"Lab:"}),(0,l.jsx)("span",{className:"mobile-card-value",children:e.isContinuous?`Yes (${e.blockSize}p)`:"No"})]})]}),(0,l.jsxs)("div",{className:"mobile-card-actions",children:[(0,l.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>B(e),children:"âœï¸ Edit"}),(0,l.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>H(e.id),children:"ðŸ—‘ï¸ Delete"})]})]},e.id))})]},e.id)})})]})]}),(0,l.jsxs)("div",{className:"section",children:[(0,l.jsxs)("div",{className:"section-header",children:[(0,l.jsx)("span",{className:"section-icon",children:"âš¡"}),(0,l.jsx)("h2",{className:"section-title",children:"Generate Timetable"})]}),(0,l.jsxs)("div",{className:"card",children:[(0,l.jsx)("h3",{children:"Ready to Generate"}),(0,l.jsxs)("div",{style:{marginBottom:"25px",padding:"20px",background:"#f8fafc",borderRadius:"12px",color:"#475569"},children:[(0,l.jsx)("p",{style:{marginBottom:"15px",fontSize:"15px",lineHeight:"1.6"},children:"The smart algorithm will create an optimized timetable ensuring:"}),(0,l.jsxs)("ul",{style:{marginLeft:"25px",lineHeight:"1.8"},children:[(0,l.jsx)("li",{children:"âœ… No free periods (all 30 filled)"}),(0,l.jsx)("li",{children:"âœ… High-hour subjects (â‰¥5h) appear daily"}),(0,l.jsx)("li",{children:"âœ… Labs in continuous blocks"}),(0,l.jsx)("li",{children:"âœ… No teacher conflicts"}),(0,l.jsx)("li",{children:"âœ… Balanced teacher workload"})]})]}),(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"15px",marginBottom:"25px"},children:[(0,l.jsxs)("div",{style:{padding:"15px",background:"linear-gradient(135deg, #667eea, #764ba2)",borderRadius:"12px",color:"white",textAlign:"center"},children:[(0,l.jsx)("div",{style:{fontSize:"13px",opacity:.9},children:"Classes"}),(0,l.jsx)("div",{style:{fontSize:"2em",fontWeight:"bold"},children:a.length})]}),(0,l.jsxs)("div",{style:{padding:"15px",background:"linear-gradient(135deg, #10b981, #059669)",borderRadius:"12px",color:"white",textAlign:"center"},children:[(0,l.jsx)("div",{style:{fontSize:"13px",opacity:.9},children:"Teachers"}),(0,l.jsx)("div",{style:{fontSize:"2em",fontWeight:"bold"},children:_.length})]}),(0,l.jsxs)("div",{style:{padding:"15px",background:"linear-gradient(135deg, #f59e0b, #d97706)",borderRadius:"12px",color:"white",textAlign:"center"},children:[(0,l.jsx)("div",{style:{fontSize:"13px",opacity:.9},children:"Subjects"}),(0,l.jsx)("div",{style:{fontSize:"2em",fontWeight:"bold"},children:p.length})]})]}),(0,l.jsx)("button",{className:"btn btn-success",onClick:L,disabled:C,style:{width:"100%",fontSize:"18px",padding:"18px 40px"},children:C?"â³ Generating...":"âš¡ Generate Timetable"})]})]}),v&&(0,l.jsxs)("div",{className:"section",id:"view-timetables",children:[(0,l.jsxs)("div",{className:"section-header",children:[(0,l.jsx)("span",{className:"section-icon",children:"ðŸ“Š"}),(0,l.jsx)("h2",{className:"section-title",children:"Generated Timetables"})]}),(0,l.jsxs)("div",{className:"card",children:[(0,l.jsx)("h3",{children:"Class-wise Timetables"}),a.map(e=>(0,l.jsxs)("div",{style:{marginBottom:"40px"},children:[(0,l.jsxs)("h4",{style:{marginBottom:"15px",fontSize:"1.2em",color:"#1e293b"},children:["Class: ",e.name]}),(0,l.jsx)(d.default,{timetable:v.classTimetables,className:e.name}),(0,l.jsx)("div",{style:{marginTop:"15px",display:"flex",gap:"10px"},className:"no-print",children:(0,l.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>(0,h.exportToPDF)("timetable-export",`${e.name}_Timetable.pdf`),children:"ðŸ“„ Download PDF"})})]},e.id))]}),(0,l.jsxs)("div",{className:"card",children:[(0,l.jsx)("h3",{children:"Staff-wise Timetables"}),_.map(e=>(0,l.jsxs)("div",{style:{marginBottom:"40px"},children:[(0,l.jsxs)("h4",{style:{marginBottom:"15px",fontSize:"1.2em",color:"#1e293b"},children:["Teacher: ",e.name]}),(0,l.jsx)(o.default,{timetable:v.staffTimetables,staffName:e.name}),(0,l.jsx)("div",{style:{marginTop:"15px",display:"flex",gap:"10px"},className:"no-print",children:(0,l.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>(0,h.exportToPDF)("staff-timetable-export",`${e.name}_Timetable.pdf`),children:"ðŸ“„ Download PDF"})})]},e.id))]})]})]}),(0,l.jsx)(c.ToastContainer,{toasts:N,removeToast:e=>{S(s=>s.filter((s,a)=>a!==e))}})]})}}),t("2A5UH",function(s,t){e(s.exports,"ToastContainer",()=>c);var l=a("ayMG0"),i=a("acw62");function r({message:e,type:s,onClose:a}){return(0,i.useEffect)(()=>{let e=setTimeout(a,5e3);return()=>clearTimeout(e)},[a]),(0,l.jsxs)("div",{className:`toast toast-${s}`,children:[(0,l.jsx)("div",{className:"toast-icon",children:"success"===s?"âœ…":"âŒ"}),(0,l.jsx)("div",{className:"toast-text",children:e})]})}function c({toasts:e,removeToast:s}){return(0,l.jsx)("div",{className:"toast-container",children:e.map((e,a)=>(0,l.jsx)(r,{message:e.message,type:e.type,onClose:()=>s(a)},a))})}}),t("4XiCD",function(s,t){e(s.exports,"default",()=>i);var l=a("ayMG0");function i({className:e,subjects:s}){let a=s.filter(s=>s.className===e).reduce((e,s)=>e+s.hoursPerWeek,0),t=30-a,i=a/30*100;return(0,l.jsxs)("div",{className:"hours-tracker",children:[(0,l.jsxs)("div",{className:"hours-grid",children:[(0,l.jsxs)("div",{className:"hours-item",children:[(0,l.jsx)("div",{className:"hours-label",children:"Allocated"}),(0,l.jsx)("div",{className:"hours-value",children:a})]}),(0,l.jsxs)("div",{className:"hours-item",children:[(0,l.jsx)("div",{className:"hours-label",children:"Remaining"}),(0,l.jsx)("div",{className:"hours-value",children:t})]}),(0,l.jsxs)("div",{className:"hours-item",children:[(0,l.jsx)("div",{className:"hours-label",children:"Total"}),(0,l.jsx)("div",{className:"hours-value",children:"30"})]})]}),(0,l.jsx)("div",{className:"progress-bar",children:(0,l.jsx)("div",{className:"progress-fill",style:{width:`${Math.min(i,100)}%`}})}),0===t&&(0,l.jsx)("div",{style:{marginTop:"12px",textAlign:"center",fontWeight:"bold"},children:"âœ“ Perfect! No free periods."}),t<0&&(0,l.jsxs)("div",{style:{marginTop:"12px",textAlign:"center",fontWeight:"bold",color:"#ef4444"},children:["âš  Over by ",Math.abs(t)," hours!"]})]})}a("acw62")}),t("v5TqP",function(t,l){e(t.exports,"default",()=>n);var i=a("ayMG0"),r=a("acw62");let c=["Monday","Tuesday","Wednesday","Thursday","Friday"];function n({timetable:e,className:a}){if(!e||!e[a])return(0,i.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#64748b"},children:"No timetable generated yet"});let t=e[a];return(0,i.jsxs)("div",{id:"timetable-export",className:"timetable-grid",children:[(0,i.jsx)("div",{className:"timetable-header",children:"Day/Period"}),[...Array(6)].map((e,s)=>(0,i.jsxs)("div",{className:"timetable-header",children:["P",s+1]},s)),c.map((e,a)=>(0,i.jsxs)(s(r).Fragment,{children:[(0,i.jsx)("div",{className:"timetable-day",children:e}),t[a].map((e,s)=>(0,i.jsx)("div",{className:`timetable-cell subject-${e?e.type.toLowerCase():"other"}`,children:e?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"subject-name",children:e.subject}),(0,i.jsx)("div",{className:"teacher-name",children:e.teacher})]}):(0,i.jsx)("div",{children:"-"})},s))]},e))]})}}),t("hyYFF",function(t,l){e(t.exports,"default",()=>n);var i=a("ayMG0"),r=a("acw62");let c=["Monday","Tuesday","Wednesday","Thursday","Friday"];function n({timetable:e,staffName:a}){if(!e||!e[a])return(0,i.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#64748b"},children:"No timetable generated yet"});let t=e[a];return(0,i.jsxs)("div",{id:"staff-timetable-export",className:"timetable-grid",children:[(0,i.jsx)("div",{className:"timetable-header",children:"Day/Period"}),[...Array(6)].map((e,s)=>(0,i.jsxs)("div",{className:"timetable-header",children:["P",s+1]},s)),c.map((e,a)=>(0,i.jsxs)(s(r).Fragment,{children:[(0,i.jsx)("div",{className:"timetable-day",children:e}),t[a].map((e,s)=>(0,i.jsx)("div",{className:`timetable-cell subject-${e.type.toLowerCase()}`,children:"FREE"!==e.subject?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"subject-name",children:e.subject}),(0,i.jsx)("div",{className:"teacher-name",children:e.class})]}):(0,i.jsx)("div",{style:{color:"#94a3b8"},children:"FREE"})},s))]},e))]})}}),t("izP1S",function(s,a){e(s.exports,"TimetableGenerator",()=>t);class t{constructor(e,s,a){this.classes=e,this.staff=s,this.subjects=a,this.classTimetables={},this.staffTimetables={},this.teacherBusySlots={},this.teacherWeeklyCount={},this.teacherDailyCount={},this.teacherConsecutiveCount={},this.DAYS=["Monday","Tuesday","Wednesday","Thursday","Friday"],this.PERIODS=6,this.MAX_PERIODS_PER_DAY=30,this.MAX_SAME_SUBJECT_PER_DAY=2,this.MAX_CONSECUTIVE_PERIODS=6}validate(){let e=[];if(0===this.classes.length&&e.push("No classes added"),0===this.staff.filter(e=>"staff"===e.role).length&&e.push("No staff added"),0===this.subjects.length&&e.push("No subjects added"),e.length>0)return{valid:!1,errors:e};let s={};return this.subjects.forEach(e=>{s[e.className]=(s[e.className]||0)+e.hoursPerWeek}),this.classes.forEach(a=>{let t=s[a.name]||0;t!==this.MAX_PERIODS_PER_DAY&&e.push(`Class ${a.name}: Has ${t} hours, needs exactly ${this.MAX_PERIODS_PER_DAY} (Rule A.1: Total hours must match capacity)`)}),this.subjects.forEach(s=>{s.isContinuous&&s.hoursPerWeek%s.blockSize!=0&&e.push(`Subject ${s.name}: ${s.hoursPerWeek} hours cannot be evenly divided into ${s.blockSize}-period blocks`)}),{valid:0===e.length,errors:e}}generate(){for(let e of(this._initialize(),this.classes))if(!this._generateClassTimetable(e.name))return{success:!1,error:`Failed to generate timetable for ${e.name}`};this._generateStaffTimetables();let e=this._validateGenerated();return e.valid||console.warn("Generated timetable has warnings:",e.warnings),{success:!0,classTimetables:this.classTimetables,staffTimetables:this.staffTimetables,warnings:e.warnings||[]}}_initialize(){this.classes.forEach(e=>{this.classTimetables[e.name]=this.DAYS.map(()=>Array(this.PERIODS).fill(null))}),this.staff.filter(e=>"staff"===e.role).forEach(e=>{this.teacherBusySlots[e.name]={},this.teacherWeeklyCount[e.name]=0,this.teacherDailyCount[e.name]=this.DAYS.reduce((e,s)=>(e[s]=0,e),{}),this.teacherConsecutiveCount[e.name]={}})}_generateClassTimetable(e){let s=this.subjects.filter(s=>s.className===e);s.forEach(e=>e.placedHours=0);let a=s.filter(e=>e.isContinuous);for(let s of(a.sort((e,s)=>s.hoursPerWeek-e.hoursPerWeek),a))if(!this._placeLab(e,s))return console.error(`Step 1 failed: Cannot place lab ${s.name}`),!1;let t=s.filter(e=>!e.isContinuous&&e.hoursPerWeek>=5);for(let s of(t.sort((e,s)=>s.hoursPerWeek-e.hoursPerWeek),t))if(!this._placeHighHourSubject(e,s))return console.error(`Step 2 failed: Cannot place high-hour subject ${s.name}`),!1;let l=s.filter(e=>!e.isContinuous&&e.hoursPerWeek<5);for(let s of(l.sort((e,s)=>s.hoursPerWeek-e.hoursPerWeek),l))if(!this._placeLowHourSubject(e,s))return console.error(`Step 3 failed: Cannot place low-hour subject ${s.name}`),!1;return!0}_placeLab(e,s){let a=s.hoursPerWeek/s.blockSize,t=0,l=[];for(let{day:i,start:r}of(this.DAYS.forEach(e=>{for(let a=0;a<=this.PERIODS-s.blockSize;a++)0===a&&.7>Math.random()||l.push({day:e,start:a})}),this._shuffle(l),l)){if(t>=a)break;let l=!0;for(let a=0;a<s.blockSize;a++){let t=r+a,c=this.DAYS.indexOf(i);if(this.classTimetables[e][c][t]){l=!1;break}let n=`${i}-P${t+1}`;if(this.teacherBusySlots[s.teacher]?.[n]||!this._checkTeacherLimit(s.teacher)||this.teacherDailyCount[s.teacher][i]>=this.MAX_CONSECUTIVE_PERIODS){l=!1;break}}if(l){for(let a=0;a<s.blockSize;a++){let t=r+a,l=this.DAYS.indexOf(i);this._placeAt(e,l,t,s)}s.placedHours+=s.blockSize,t++}}return t===a}_placeHighHourSubject(e,s){let a=s.hoursPerWeek,t=0,l={};this.DAYS.forEach(e=>l[e]=0);for(let i=0;i<this.DAYS.length&&!(t>=a);i++){let a=this.DAYS[i],r=this._getAvailablePeriods(e,i,s);if(r.length>0){let c=r[Math.floor(Math.random()*r.length)];this._placeAt(e,i,c,s),l[a]++,s.placedHours++,t++}}for(;t<a;){let i=[];for(let a=0;a<this.DAYS.length;a++){let t=this.DAYS[a];l[t]>=this.MAX_SAME_SUBJECT_PER_DAY||this._getAvailablePeriods(e,a,s).forEach(e=>{i.push({dayIdx:a,period:e,day:t})})}if(0===i.length)for(let a=0;a<this.DAYS.length;a++){let t=this.DAYS[a];l[t]>=3||this._getAvailablePeriods(e,a,s).forEach(e=>{i.push({dayIdx:a,period:e,day:t})})}if(0===i.length){let i=[];for(let a=0;a<this.DAYS.length;a++)for(let t=0;t<this.PERIODS;t++)this._canPlaceAt(e,a,t,s)&&i.push({dayIdx:a,period:t,day:this.DAYS[a]});if(0===i.length)return console.warn(`Cannot fully place ${s.name}: ${t}/${a} placed. Proceeding with partial allocation.`),!0;let r=i[Math.floor(Math.random()*i.length)];this._placeAt(e,r.dayIdx,r.period,s),l[r.day]++,s.placedHours++,t++;continue}let r=i[Math.floor(Math.random()*i.length)];this._placeAt(e,r.dayIdx,r.period,s),l[r.day]++,s.placedHours++,t++}return!0}_placeLowHourSubject(e,s){let a=s.hoursPerWeek,t=0,l={};this.DAYS.forEach(e=>l[e]=0);let i=[];for(let{day:r,dayIdx:c,period:n}of(this.DAYS.forEach((e,s)=>{for(let a=0;a<this.PERIODS;a++)i.push({day:e,dayIdx:s,period:a})}),this._shuffle(i),i)){if(t>=a)break;if(!(l[r]>=this.MAX_SAME_SUBJECT_PER_DAY)&&this._canPlaceAt(e,c,n,s)){if(n>0){let a=this.classTimetables[e][c][n-1];if(a?.subject===s.name&&.8>Math.random())continue}this._placeAt(e,c,n,s),l[r]++,s.placedHours++,t++}}return t===a}_getAvailablePeriods(e,s,a){let t=[];for(let l=0;l<this.PERIODS;l++)if(this._canPlaceAt(e,s,l,a)){if(l>0){let t=this.classTimetables[e][s][l-1];if(t?.subject===a.name)continue}t.push(l)}return t}_canPlaceAt(e,s,a,t){let l=this.DAYS[s],i=`${l}-P${a+1}`;return!(this.classTimetables[e][s][a]||this.teacherBusySlots[t.teacher]?.[i])&&!!this._checkTeacherLimit(t.teacher)&&!(this.teacherDailyCount[t.teacher][l]>=this.MAX_CONSECUTIVE_PERIODS)}_placeAt(e,s,a,t){let l=this.DAYS[s],i=`${l}-P${a+1}`;this.classTimetables[e][s][a]={subject:t.name,teacher:t.teacher,type:t.subjectType},this.teacherBusySlots[t.teacher]||(this.teacherBusySlots[t.teacher]={}),this.teacherBusySlots[t.teacher][i]=!0,this.teacherWeeklyCount[t.teacher]++,this.teacherDailyCount[t.teacher][l]++}_checkTeacherLimit(e){let s=this.staff.find(s=>s.name===e);if(!s)return!1;let a="manual"===s.freePeriodMode?this.MAX_PERIODS_PER_DAY-s.manualFreePeriods:this.MAX_PERIODS_PER_DAY;return this.teacherWeeklyCount[e]<a}_generateStaffTimetables(){this.staff.filter(e=>"staff"===e.role).forEach(e=>{this.staffTimetables[e.name]=this.DAYS.map(()=>Array(this.PERIODS).fill({subject:"FREE",class:"-",type:"free"}))}),this.classes.forEach(e=>{this.DAYS.forEach((s,a)=>{this.classTimetables[e.name][a].forEach((s,t)=>{s&&(this.staffTimetables[s.teacher][a][t]={subject:s.subject,class:e.name,type:s.type})})})})}_validateGenerated(){let e=[];this.classes.forEach(s=>{let a=0,t=0;this.DAYS.forEach((e,l)=>{this.classTimetables[s.name][l].forEach(e=>{a++,!e&&t++})}),t>0&&e.push(`Class ${s.name}: Has ${t} empty slots (Rule A.2 violated)`)}),this.staff.filter(e=>"staff"===e.role).forEach(s=>{let a={};this.DAYS.forEach(e=>{for(let s=0;s<this.PERIODS;s++)a[`${e}-P${s+1}`]=[]}),this.classes.forEach(e=>{this.DAYS.forEach((t,l)=>{this.classTimetables[e.name][l].forEach((l,i)=>{l&&l.teacher===s.name&&a[`${t}-P${i+1}`].push(e.name)})})}),Object.keys(a).forEach(t=>{a[t].length>1&&e.push(`Teacher ${s.name} has clash at ${t}: ${a[t].join(", ")} (Rule B.1 violated)`)})});let s={};return this.subjects.forEach(e=>{s[e.className]||(s[e.className]=[]),s[e.className].push(e)}),Object.keys(s).forEach(a=>{s[a].forEach(s=>{if(!s.isContinuous&&s.hoursPerWeek>=5){let t=new Set;if(this.DAYS.forEach((e,l)=>{this.classTimetables[a][l].forEach(a=>{a&&a.subject===s.name&&t.add(e)})}),t.size<this.DAYS.length){let l=this.DAYS.filter(e=>!t.has(e));e.push(`Subject ${s.name} (${a}): Missing on ${l.join(", ")} (Rule C.1: High-hour subjects should appear daily)`)}}})}),{valid:0===e.length,warnings:e}}_shuffle(e){for(let s=e.length-1;s>0;s--){let a=Math.floor(Math.random()*(s+1));[e[s],e[a]]=[e[a],e[s]]}}}});
//# sourceMappingURL=AdminDashboard.11af448d.js.map

function e(e,s,a,l){Object.defineProperty(e,s,{get:a,set:l,enumerable:!0,configurable:!0})}function s(e){return e&&e.__esModule?e.default:e}var a=globalThis.parcelRequire3f2f,l=a.register;l("dXtBz",function(s,l){Object.defineProperty(s.exports,"__esModule",{value:!0,configurable:!0}),e(s.exports,"default",()=>x);var t=a("ayMG0"),i=a("acw62"),r=a("aOD4d"),c=a("2A5UH"),n=a("4XiCD"),d=a("e3nvF"),o=a("hyYFF"),h=a("gqAsg"),m=a("bU9CP"),u=a("fAZ67"),b=a("6AR8M"),j=a("ilpIi");function x({user:e,onLogout:s}){let[a,l]=(0,i.useState)([]),[x,f]=(0,i.useState)([]),[p,N]=(0,i.useState)([]),[g,v]=(0,i.useState)(null),[y,E]=(0,i.useState)([]),[C,S]=(0,i.useState)(!0),T=(0,i.useRef)(null),P=(0,i.useRef)(null),[k,w]=(0,i.useState)({name:"",hallNumber:""}),[A,D]=(0,i.useState)({id:null,name:"",username:"",password:"",freePeriodMode:"auto",manualFreePeriods:0}),[_,$]=(0,i.useState)({id:null,className:"",name:"",subjectType:"Core",hoursPerWeek:6,isContinuous:!1,blockSize:2,teacher:""}),F=x.filter(e=>"staff"===e.role),M=(e,s)=>{let a={message:e,type:s,id:Date.now()};E(e=>[...e,a]),setTimeout(()=>R(a.id),3e3)},R=e=>{E(s=>s.filter(s=>s.id!==e))},I=e=>{if(!e)return null;let s={};return Object.keys(e).forEach(a=>{let l=e[a];if(Array.isArray(l)&&l.length>0&&Array.isArray(l[0]))s[a]=l;else if(Array.isArray(l)){let e=[[],[],[],[],[]];l.forEach(s=>{s&&"number"==typeof s.day&&"number"==typeof s.period&&(e[s.day]||(e[s.day]=[]),e[s.day][s.period]={subject:s.subject,teacher:s.teacher,class:s.class,type:s.type})}),e.forEach((s,a)=>{e[a]||(e[a]=[]);for(let s=0;s<6;s++)e[a][s]||(e[a][s]=l[0]?.class!==void 0?{subject:"FREE",class:"-",type:"free"}:null)}),s[a]=e}}),s};(0,i.useEffect)(()=>{(async()=>{try{let[e,s,a,t]=await Promise.all([(0,j.getDocs)((0,j.collection)(u.db,"classes")),(0,j.getDocs)((0,j.collection)(u.db,"staff")),(0,j.getDocs)((0,j.collection)(u.db,"subjects")),(0,j.getDocs)((0,j.collection)(u.db,"timetable"))]);if(l(e.docs.map(e=>({id:e.id,...e.data()}))),f(s.docs.map(e=>({id:e.id,...e.data()}))),N(a.docs.map(e=>({id:e.id,...e.data()}))),!t.empty){let e=t.docs[0].data(),s={classTimetables:I(e.classTimetables),staffTimetables:I(e.staffTimetables)};v(s)}}catch(e){M("âŒ Error: "+e.message,"error")}finally{S(!1)}})()},[]);let W=async()=>{if(!k.name)return M("Enter class name","error");if(a.find(e=>e.name===k.name&&!k.id))return M("Class already exists","error");try{if(k.id)await (0,j.updateDoc)((0,j.doc)(u.db,"classes",k.id),{name:k.name,hallNumber:k.hallNumber}),l(a.map(e=>e.id===k.id?{...k}:e)),M("âœ… Class updated!","success");else{let e=await (0,j.addDoc)((0,j.collection)(u.db,"classes"),{name:k.name,hallNumber:k.hallNumber||""});l([...a,{id:e.id,name:k.name,hallNumber:k.hallNumber||""}]),M("âœ… Class added!","success")}w({name:"",hallNumber:""})}catch(e){M("âŒ Operation failed","error")}},O=e=>{w({id:e.id,name:e.name,hallNumber:e.hallNumber||""})},H=async e=>{if(window.confirm("Delete this class?"))try{await (0,j.deleteDoc)((0,j.doc)(u.db,"classes",e)),l(a.filter(s=>s.id!==e)),M("âœ… Class deleted","success")}catch(e){M("âŒ Failed to delete","error")}},G=async()=>{if(!A.name||!A.username)return M("Fill all required fields","error");try{if(A.id){let{password:e,...s}=A;return await (0,j.updateDoc)((0,j.doc)(u.db,"staff",A.id),s),f(x.map(e=>e.id===A.id?{...e,...s}:e)),B(),M("âœ… Staff updated!","success")}if(!A.password)return M("Password required","error");let e=`${A.username}@timetable.com`,s=(await (0,b.createUserWithEmailAndPassword)(u.auth,e,A.password)).user.uid,a={name:A.name,username:A.username,freePeriodMode:A.freePeriodMode,manualFreePeriods:A.manualFreePeriods,role:"staff",firebaseUid:s},l=await (0,j.addDoc)((0,j.collection)(u.db,"staff"),a);await (0,j.setDoc)((0,j.doc)(u.db,"users",s),{fullName:A.name,username:A.username,role:"staff"}),f([...x,{id:l.id,...a}]),B(),M("âœ… Staff added!","success")}catch(e){M("âŒ Operation failed: "+e.message,"error")}},z=e=>{D({...e,password:""}),setTimeout(()=>{T.current?.scrollIntoView({behavior:"smooth",block:"center"})},100)},B=()=>{D({id:null,name:"",username:"",password:"",freePeriodMode:"auto",manualFreePeriods:0})},U=async e=>{if(window.confirm("Delete this staff member?"))try{await (0,j.deleteDoc)((0,j.doc)(u.db,"staff",e)),f(x.filter(s=>s.id!==e)),M("âœ… Staff deleted","success")}catch(e){M("âŒ Failed to delete","error")}},Y=async()=>{if(!_.className||!_.name||!_.teacher)return M("Fill all required fields","error");try{let e={className:_.className,name:_.name,subjectType:_.subjectType,hoursPerWeek:_.hoursPerWeek,isContinuous:_.isContinuous,blockSize:_.blockSize,teacher:_.teacher};if(_.id)await (0,j.updateDoc)((0,j.doc)(u.db,"subjects",_.id),e),N(p.map(s=>s.id===_.id?{id:_.id,...e}:s)),M("âœ… Subject updated!","success");else{let s=await (0,j.addDoc)((0,j.collection)(u.db,"subjects"),e);N([...p,{id:s.id,...e}]),M("âœ… Subject added!","success")}X()}catch(e){M("âŒ Operation failed","error"),console.error(e)}},L=e=>{$({id:e.id,className:e.className,name:e.name,subjectType:e.subjectType,hoursPerWeek:e.hoursPerWeek,isContinuous:e.isContinuous||!1,blockSize:e.blockSize||2,teacher:e.teacher}),setTimeout(()=>{P.current?.scrollIntoView({behavior:"smooth",block:"center"})},100)},X=()=>{$({id:null,className:"",name:"",subjectType:"Core",hoursPerWeek:6,isContinuous:!1,blockSize:2,teacher:""})},K=async e=>{if(window.confirm("Delete this subject?"))try{await (0,j.deleteDoc)((0,j.doc)(u.db,"subjects",e)),N(p.filter(s=>s.id!==e)),M("âœ… Subject deleted","success")}catch(e){M("âŒ Failed to delete","error")}},V=async()=>{S(!0);try{let e=new(0,m.TimetableGenerator)(a,x.filter(e=>"staff"===e.role),p),s=e.validate();if(!s.valid){M("âŒ Validation: "+s.errors[0],"error"),S(!1);return}let l=e.generate();if(l.success){let e={},s={};Object.keys(l.classTimetables).forEach(s=>{e[s]=l.classTimetables[s].map((e,s)=>e.map((e,a)=>({day:s,period:a,subject:e?.subject||null,teacher:e?.teacher||null,type:e?.type||null}))).flat()}),Object.keys(l.staffTimetables).forEach(e=>{s[e]=l.staffTimetables[e].map((e,s)=>e.map((e,a)=>({day:s,period:a,subject:e?.subject||null,class:e?.class||null,type:e?.type||null}))).flat()});let a={classTimetables:e,staffTimetables:s,generatedAt:new Date().toISOString()},t=(0,j.collection)(u.db,"timetable"),i=await (0,j.getDocs)(t);for(let e of(i.empty?await (0,j.addDoc)(t,a):await (0,j.updateDoc)((0,j.doc)(u.db,"timetable",i.docs[0].id),a),x.filter(e=>"staff"===e.role))){let a=s[e.name];a&&await (0,j.setDoc)((0,j.doc)(u.db,"staffTimetables",e.id),{staffName:e.name,timetable:a,generatedAt:new Date().toISOString()})}let r={};Object.keys(e).forEach(s=>{let a=[[],[],[],[],[]];e[s].forEach(e=>{a[e.day]||(a[e.day]=[]),a[e.day][e.period]={subject:e.subject,teacher:e.teacher,type:e.type}}),a.forEach((e,s)=>{a[s]||(a[s]=[]);for(let e=0;e<6;e++)a[s][e]||(a[s][e]=null)}),r[s]=a});let c={};Object.keys(s).forEach(e=>{let a=[[],[],[],[],[]];s[e].forEach(e=>{a[e.day]||(a[e.day]=[]),a[e.day][e.period]={subject:e.subject,class:e.class,type:e.type}}),a.forEach((e,s)=>{a[s]||(a[s]=[]);for(let e=0;e<6;e++)a[s][e]||(a[s][e]={subject:"FREE",class:"-",type:"free"})}),c[e]=a}),v({classTimetables:r,staffTimetables:c}),M("âœ… Timetable generated & saved!","success"),setTimeout(()=>{document.getElementById("view-timetables")?.scrollIntoView({behavior:"smooth"})},1e3)}else M("âŒ Failed: "+l.error,"error")}catch(e){M("âŒ Error: "+e.message,"error"),console.error(e)}S(!1)};return C?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.default,{}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",color:"white",fontSize:"24px",gap:"20px"},children:[(0,t.jsx)("div",{className:"spinner"}),(0,t.jsx)("div",{children:"Loading..."})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.default,{}),(0,t.jsx)("div",{className:"header",children:(0,t.jsxs)("div",{className:"header-content",children:[(0,t.jsx)("h1",{children:"ðŸ« Admin Dashboard"}),(0,t.jsxs)("div",{className:"header-actions",children:[(0,t.jsx)("button",{className:"theme-toggle",children:"ðŸŒ™"}),(0,t.jsx)("button",{className:"btn btn-danger btn-sm",onClick:s,children:"Logout"})]})]})}),(0,t.jsxs)("div",{className:"content",children:[(0,t.jsxs)("div",{className:"section",children:[(0,t.jsxs)("div",{className:"section-header",children:[(0,t.jsx)("span",{className:"section-icon",children:"ðŸ“š"}),(0,t.jsx)("h2",{className:"section-title",children:"Manage Classes"})]}),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("h3",{children:k.id?"âœï¸ Edit Class":"âž• Add New Class"}),(0,t.jsxs)("div",{className:"grid-2",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Class Name *"}),(0,t.jsx)("input",{type:"text",value:k.name,onChange:e=>w({...k,name:e.target.value.toUpperCase()}),placeholder:"CS3A, EE2B"})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Hall Number (Optional)"}),(0,t.jsx)("input",{type:"text",value:k.hallNumber,onChange:e=>w({...k,hallNumber:e.target.value}),placeholder:"Hall 101"})]})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,t.jsx)("button",{className:"btn btn-primary",onClick:W,children:k.id?"ðŸ’¾ Update Class":"âž• Add Class"}),k.id&&(0,t.jsx)("button",{className:"btn btn-secondary",onClick:()=>w({name:"",hallNumber:""}),children:"âŒ Cancel"})]})]}),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsxs)("h3",{children:["Existing Classes (",a.length,")"]}),0===a.length?(0,t.jsx)("p",{style:{color:"#64748b",textAlign:"center",padding:"20px"},children:"No classes added yet"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"desktop-table",children:(0,t.jsxs)("table",{children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"#"}),(0,t.jsx)("th",{children:"Class Name"}),(0,t.jsx)("th",{children:"Hall Number"}),(0,t.jsx)("th",{children:"Subjects"}),(0,t.jsx)("th",{children:"Hours"}),(0,t.jsx)("th",{children:"Actions"})]})}),(0,t.jsx)("tbody",{children:a.map((e,s)=>{let a=p.filter(s=>s.className===e.name),l=a.reduce((e,s)=>e+s.hoursPerWeek,0);return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:s+1}),(0,t.jsx)("td",{children:(0,t.jsx)("strong",{children:e.name})}),(0,t.jsx)("td",{children:e.hallNumber||"-"}),(0,t.jsx)("td",{children:a.length}),(0,t.jsx)("td",{children:(0,t.jsxs)("span",{className:`badge ${30===l?"badge-success":"badge-danger"}`,children:[l,"/30h"]})}),(0,t.jsx)("td",{children:(0,t.jsxs)("div",{className:"action-buttons",children:[(0,t.jsx)("button",{className:"btn-icon btn-icon-primary",onClick:()=>O(e),title:"Edit",children:"âœï¸"}),(0,t.jsx)("button",{className:"btn-icon btn-icon-danger",onClick:()=>H(e.id),title:"Delete",children:"ðŸ—‘ï¸"})]})})]},e.id)})})]})}),(0,t.jsx)("div",{className:"mobile-cards",children:a.map((e,s)=>{let a=p.filter(s=>s.className===e.name),l=a.reduce((e,s)=>e+s.hoursPerWeek,0);return(0,t.jsxs)("div",{className:"mobile-card",children:[(0,t.jsxs)("div",{className:"mobile-card-header",children:[(0,t.jsx)("span",{className:"mobile-card-title",children:e.name}),(0,t.jsxs)("span",{className:"mobile-card-badge",children:["#",s+1]})]}),(0,t.jsxs)("div",{className:"mobile-card-body",children:[(0,t.jsxs)("div",{className:"mobile-card-row",children:[(0,t.jsx)("span",{className:"mobile-card-label",children:"Hall:"}),(0,t.jsx)("span",{className:"mobile-card-value",children:e.hallNumber||"-"})]}),(0,t.jsxs)("div",{className:"mobile-card-row",children:[(0,t.jsx)("span",{className:"mobile-card-label",children:"Subjects:"}),(0,t.jsx)("span",{className:"mobile-card-value",children:a.length})]}),(0,t.jsxs)("div",{className:"mobile-card-row",children:[(0,t.jsx)("span",{className:"mobile-card-label",children:"Hours:"}),(0,t.jsxs)("span",{className:"mobile-card-value",children:[l,"/30h"]})]})]}),(0,t.jsxs)("div",{className:"mobile-card-actions",children:[(0,t.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>O(e),children:"âœï¸ Edit"}),(0,t.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>H(e.id),children:"ðŸ—‘ï¸ Delete"})]})]},e.id)})})]})]})]}),(0,t.jsxs)("div",{className:"section",children:[(0,t.jsxs)("div",{className:"section-header",children:[(0,t.jsx)("span",{className:"section-icon",children:"ðŸ‘¥"}),(0,t.jsx)("h2",{className:"section-title",children:"Manage Staff"})]}),(0,t.jsxs)("div",{className:"card",ref:T,children:[(0,t.jsx)("h3",{children:A.id?"âœï¸ Edit Staff":"âž• Add New Staff"}),(0,t.jsxs)("div",{className:"grid-2",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Full Name *"}),(0,t.jsx)("input",{type:"text",placeholder:"Dr. John Doe",value:A.name,onChange:e=>D({...A,name:e.target.value})})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Username *"}),(0,t.jsx)("input",{type:"text",placeholder:"john",disabled:!!A.id,value:A.username,onChange:e=>D({...A,username:e.target.value}),style:A.id?{background:"#f1f5f9",cursor:"not-allowed"}:{}})]}),!A.id&&(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Password *"}),(0,t.jsx)("input",{type:"password",placeholder:"Password",value:A.password,onChange:e=>D({...A,password:e.target.value})})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Free Period Mode"}),(0,t.jsxs)("select",{value:A.freePeriodMode,onChange:e=>D({...A,freePeriodMode:e.target.value}),children:[(0,t.jsx)("option",{value:"auto",children:"Auto"}),(0,t.jsx)("option",{value:"manual",children:"Manual"})]})]})]}),"manual"===A.freePeriodMode&&(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Free Periods per Week"}),(0,t.jsx)("input",{type:"number",min:"0",max:"30",value:A.manualFreePeriods,onChange:e=>D({...A,manualFreePeriods:parseInt(e.target.value)||0})})]}),(0,t.jsxs)("div",{className:"button-group",children:[(0,t.jsx)("button",{className:"btn btn-primary",onClick:G,children:A.id?"ðŸ’¾ Save Changes":"âž• Add Staff"}),A.id&&(0,t.jsx)("button",{className:"btn btn-secondary",onClick:B,children:"âŒ Cancel"})]})]}),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsxs)("h3",{children:["Existing Staff (",F.length,")"]}),0===F.length?(0,t.jsx)("p",{style:{color:"#64748b",textAlign:"center",padding:"20px"},children:"No staff added yet"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"desktop-table",children:(0,t.jsxs)("table",{children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"S.No"}),(0,t.jsx)("th",{children:"Name"}),(0,t.jsx)("th",{children:"Username"}),(0,t.jsx)("th",{children:"Mode"}),(0,t.jsx)("th",{children:"Actions"})]})}),(0,t.jsx)("tbody",{children:F.map((e,s)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsxs)("span",{className:"staff-badge",children:["S",s+1]})}),(0,t.jsx)("td",{children:(0,t.jsx)("strong",{children:e.name})}),(0,t.jsx)("td",{children:e.username}),(0,t.jsx)("td",{children:"manual"===e.freePeriodMode?`Manual (${e.manualFreePeriods})`:"Auto"}),(0,t.jsx)("td",{children:(0,t.jsxs)("div",{className:"action-buttons",children:[(0,t.jsx)("button",{className:"btn-icon btn-icon-primary",onClick:()=>z(e),title:"Edit",children:"âœï¸"}),(0,t.jsx)("button",{className:"btn-icon btn-icon-danger",onClick:()=>U(e.id),title:"Delete",children:"ðŸ—‘ï¸"})]})})]},e.id))})]})}),(0,t.jsx)("div",{className:"mobile-cards",children:F.map((e,s)=>(0,t.jsxs)("div",{className:"mobile-card",children:[(0,t.jsxs)("div",{className:"mobile-card-header",children:[(0,t.jsx)("span",{className:"mobile-card-title",children:e.name}),(0,t.jsxs)("span",{className:"mobile-card-badge",children:["S",s+1]})]}),(0,t.jsxs)("div",{className:"mobile-card-body",children:[(0,t.jsxs)("div",{className:"mobile-card-row",children:[(0,t.jsx)("span",{className:"mobile-card-label",children:"Username:"}),(0,t.jsx)("span",{className:"mobile-card-value",children:e.username})]}),(0,t.jsxs)("div",{className:"mobile-card-row",children:[(0,t.jsx)("span",{className:"mobile-card-label",children:"Mode:"}),(0,t.jsx)("span",{className:"mobile-card-value",children:"manual"===e.freePeriodMode?`Manual (${e.manualFreePeriods})`:"Auto"})]})]}),(0,t.jsxs)("div",{className:"mobile-card-actions",children:[(0,t.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>z(e),children:"âœï¸ Edit"}),(0,t.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>U(e.id),children:"ðŸ—‘ï¸ Delete"})]})]},e.id))})]})]})]}),(0,t.jsxs)("div",{className:"section",id:"subject-section",children:[(0,t.jsxs)("div",{className:"section-header",children:[(0,t.jsx)("span",{className:"section-icon",children:"ðŸ“–"}),(0,t.jsx)("h2",{className:"section-title",children:"Manage Subjects"})]}),_.className&&(0,t.jsx)(n.default,{className:_.className,subjects:p}),(0,t.jsxs)("div",{className:"card",ref:P,children:[(0,t.jsx)("h3",{children:_.id?"âœï¸ Edit Subject":"âž• Add New Subject"}),(0,t.jsxs)("div",{className:"grid-2",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Select Class *"}),(0,t.jsxs)("select",{value:_.className,onChange:e=>$({..._,className:e.target.value}),children:[(0,t.jsx)("option",{value:"",children:"-- Select Class --"}),a.map(e=>(0,t.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Subject Name *"}),(0,t.jsx)("input",{type:"text",value:_.name,onChange:e=>$({..._,name:e.target.value}),placeholder:"DBMS, AI Lab, etc."})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Subject Type *"}),(0,t.jsxs)("select",{value:_.subjectType,onChange:e=>$({..._,subjectType:e.target.value}),children:[(0,t.jsx)("option",{value:"Core",children:"Core"}),(0,t.jsx)("option",{value:"Elective",children:"Elective"}),(0,t.jsx)("option",{value:"Lab",children:"Lab"}),(0,t.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Hours per Week *"}),(0,t.jsx)("input",{type:"number",min:"1",max:"30",value:_.hoursPerWeek,onChange:e=>$({..._,hoursPerWeek:parseInt(e.target.value)||6})})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Teacher *"}),(0,t.jsxs)("select",{value:_.teacher,onChange:e=>$({..._,teacher:e.target.value}),children:[(0,t.jsx)("option",{value:"",children:"-- Select Teacher --"}),F.map(e=>(0,t.jsx)("option",{value:e.name,children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{className:"checkbox-group",children:[(0,t.jsx)("input",{type:"checkbox",id:"continuous",checked:_.isContinuous,onChange:e=>$({..._,isContinuous:e.target.checked})}),(0,t.jsx)("label",{htmlFor:"continuous",style:{marginBottom:0},children:"Continuous Period (Lab)"})]}),_.isContinuous&&(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Block Size"}),(0,t.jsxs)("select",{value:_.blockSize,onChange:e=>$({..._,blockSize:parseInt(e.target.value)}),children:[(0,t.jsx)("option",{value:2,children:"2 Periods"}),(0,t.jsx)("option",{value:3,children:"3 Periods"})]})]}),(0,t.jsxs)("div",{className:"button-group",children:[(0,t.jsx)("button",{className:"btn btn-primary",onClick:Y,children:_.id?"ðŸ’¾ Save Changes":"âž• Add Subject"}),_.id&&(0,t.jsx)("button",{className:"btn btn-secondary",onClick:X,children:"âŒ Cancel"})]})]}),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsxs)("h3",{children:["Existing Subjects (",p.length,")"]}),0===p.length?(0,t.jsx)("p",{style:{color:"#64748b",textAlign:"center",padding:"20px"},children:"No subjects added yet"}):(0,t.jsx)(t.Fragment,{children:a.map(e=>{let s=p.filter(s=>s.className===e.name);if(0===s.length)return null;let a=s.reduce((e,s)=>e+s.hoursPerWeek,0);return(0,t.jsxs)("div",{style:{marginBottom:"30px"},children:[(0,t.jsxs)("h4",{style:{marginBottom:"15px",display:"flex",alignItems:"center",gap:"10px",color:"#1e293b",flexWrap:"wrap"},children:["Class: ",e.name,(0,t.jsxs)("span",{className:`badge ${30===a?"badge-success":"badge-danger"}`,children:[a,"/30 hours"]})]}),(0,t.jsx)("div",{className:"desktop-table",children:(0,t.jsxs)("table",{children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Subject"}),(0,t.jsx)("th",{children:"Type"}),(0,t.jsx)("th",{children:"Hours"}),(0,t.jsx)("th",{children:"Teacher"}),(0,t.jsx)("th",{children:"Continuous"}),(0,t.jsx)("th",{children:"Actions"})]})}),(0,t.jsx)("tbody",{children:s.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)("strong",{children:e.name})}),(0,t.jsx)("td",{children:e.subjectType}),(0,t.jsxs)("td",{children:[e.hoursPerWeek,"h"]}),(0,t.jsx)("td",{children:e.teacher}),(0,t.jsx)("td",{children:e.isContinuous?`Yes (${e.blockSize}p)`:"No"}),(0,t.jsx)("td",{children:(0,t.jsxs)("div",{className:"action-buttons",children:[(0,t.jsx)("button",{className:"btn-icon btn-icon-primary",onClick:()=>L(e),title:"Edit",children:"âœï¸"}),(0,t.jsx)("button",{className:"btn-icon btn-icon-danger",onClick:()=>K(e.id),title:"Delete",children:"ðŸ—‘ï¸"})]})})]},e.id))})]})}),(0,t.jsx)("div",{className:"mobile-cards",children:s.map(e=>(0,t.jsxs)("div",{className:"mobile-card",children:[(0,t.jsxs)("div",{className:"mobile-card-header",children:[(0,t.jsx)("span",{className:"mobile-card-title",children:e.name}),(0,t.jsx)("span",{className:"mobile-card-badge",children:e.subjectType})]}),(0,t.jsxs)("div",{className:"mobile-card-body",children:[(0,t.jsxs)("div",{className:"mobile-card-row",children:[(0,t.jsx)("span",{className:"mobile-card-label",children:"Hours:"}),(0,t.jsxs)("span",{className:"mobile-card-value",children:[e.hoursPerWeek,"h"]})]}),(0,t.jsxs)("div",{className:"mobile-card-row",children:[(0,t.jsx)("span",{className:"mobile-card-label",children:"Teacher:"}),(0,t.jsx)("span",{className:"mobile-card-value",children:e.teacher})]}),(0,t.jsxs)("div",{className:"mobile-card-row",children:[(0,t.jsx)("span",{className:"mobile-card-label",children:"Continuous:"}),(0,t.jsx)("span",{className:"mobile-card-value",children:e.isContinuous?`Yes (${e.blockSize}p)`:"No"})]})]}),(0,t.jsxs)("div",{className:"mobile-card-actions",children:[(0,t.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>L(e),children:"âœï¸ Edit"}),(0,t.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>K(e.id),children:"ðŸ—‘ï¸ Delete"})]})]},e.id))})]},e.id)})})]})]}),(0,t.jsxs)("div",{className:"section",children:[(0,t.jsxs)("div",{className:"section-header",children:[(0,t.jsx)("span",{className:"section-icon",children:"âš¡"}),(0,t.jsx)("h2",{className:"section-title",children:"Generate Timetable"})]}),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("h3",{children:"Ready to Generate"}),(0,t.jsxs)("div",{className:"info-box",children:[(0,t.jsx)("p",{style:{marginBottom:"15px",fontSize:"15px",lineHeight:"1.6"},children:"The smart algorithm will create an optimized timetable:"}),(0,t.jsxs)("ul",{style:{marginLeft:"25px",lineHeight:"1.8"},children:[(0,t.jsx)("li",{children:"âœ… No free periods (all 30 filled)"}),(0,t.jsx)("li",{children:"âœ… High-hour subjects (â‰¥5h) appear daily"}),(0,t.jsx)("li",{children:"âœ… Labs in continuous blocks"}),(0,t.jsx)("li",{children:"âœ… No teacher conflicts"}),(0,t.jsx)("li",{children:"âœ… Balanced workload"})]})]}),(0,t.jsxs)("div",{className:"stats-grid",children:[(0,t.jsxs)("div",{className:"stat-card stat-primary",children:[(0,t.jsx)("div",{className:"stat-label",children:"Classes"}),(0,t.jsx)("div",{className:"stat-value",children:a.length})]}),(0,t.jsxs)("div",{className:"stat-card stat-success",children:[(0,t.jsx)("div",{className:"stat-label",children:"Teachers"}),(0,t.jsx)("div",{className:"stat-value",children:F.length})]}),(0,t.jsxs)("div",{className:"stat-card stat-warning",children:[(0,t.jsx)("div",{className:"stat-label",children:"Subjects"}),(0,t.jsx)("div",{className:"stat-value",children:p.length})]})]}),(0,t.jsx)("button",{className:"btn btn-success btn-lg",onClick:V,disabled:C,children:C?"â³ Generating...":"âš¡ Generate Timetable"})]})]}),g&&(0,t.jsxs)("div",{className:"section",id:"view-timetables",children:[(0,t.jsxs)("div",{className:"section-header",children:[(0,t.jsx)("span",{className:"section-icon",children:"ðŸ“Š"}),(0,t.jsx)("h2",{className:"section-title",children:"Generated Timetables"})]}),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("h3",{children:"Class-wise Timetables"}),a.map(e=>(0,t.jsxs)("div",{className:"timetable-container",children:[(0,t.jsxs)("h4",{className:"timetable-title",children:["Class: ",e.name," ",e.hallNumber&&`(${e.hallNumber})`]}),(0,t.jsx)("div",{className:"timetable-scroll",children:(0,t.jsx)(d.default,{timetable:g.classTimetables,className:e.name})}),(0,t.jsx)("div",{className:"timetable-actions no-print",children:(0,t.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>(0,h.exportToPDF)("timetable-export",`${e.name}_Timetable.pdf`),children:"ðŸ“„ Download PDF"})})]},e.id))]}),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("h3",{children:"Staff-wise Timetables"}),F.map(e=>(0,t.jsxs)("div",{className:"timetable-container",children:[(0,t.jsxs)("h4",{className:"timetable-title",children:["Teacher: ",e.name]}),(0,t.jsx)("div",{className:"timetable-scroll",children:(0,t.jsx)(o.default,{timetable:g.staffTimetables,staffName:e.name})}),(0,t.jsx)("div",{className:"timetable-actions no-print",children:(0,t.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>(0,h.exportToPDF)("staff-timetable-export",`${e.name}_Timetable.pdf`),children:"ðŸ“„ Download PDF"})})]},e.id))]})]})]}),(0,t.jsx)(c.ToastContainer,{toasts:y,removeToast:R})]})}}),l("2A5UH",function(s,l){e(s.exports,"ToastContainer",()=>c);var t=a("ayMG0"),i=a("acw62");function r({message:e,type:s,onClose:a}){return(0,i.useEffect)(()=>{let e=setTimeout(a,5e3);return()=>clearTimeout(e)},[a]),(0,t.jsxs)("div",{className:`toast toast-${s}`,children:[(0,t.jsx)("div",{className:"toast-icon",children:"success"===s?"âœ…":"âŒ"}),(0,t.jsx)("div",{className:"toast-text",children:e})]})}function c({toasts:e,removeToast:s}){return(0,t.jsx)("div",{className:"toast-container",children:e.map((e,a)=>(0,t.jsx)(r,{message:e.message,type:e.type,onClose:()=>s(a)},a))})}}),l("4XiCD",function(s,l){e(s.exports,"default",()=>i);var t=a("ayMG0");function i({className:e,subjects:s}){let a=s.filter(s=>s.className===e).reduce((e,s)=>e+s.hoursPerWeek,0),l=30-a,i=a/30*100;return(0,t.jsxs)("div",{className:"hours-tracker",children:[(0,t.jsxs)("div",{className:"hours-grid",children:[(0,t.jsxs)("div",{className:"hours-item",children:[(0,t.jsx)("div",{className:"hours-label",children:"Allocated"}),(0,t.jsx)("div",{className:"hours-value",children:a})]}),(0,t.jsxs)("div",{className:"hours-item",children:[(0,t.jsx)("div",{className:"hours-label",children:"Remaining"}),(0,t.jsx)("div",{className:"hours-value",children:l})]}),(0,t.jsxs)("div",{className:"hours-item",children:[(0,t.jsx)("div",{className:"hours-label",children:"Total"}),(0,t.jsx)("div",{className:"hours-value",children:"30"})]})]}),(0,t.jsx)("div",{className:"progress-bar",children:(0,t.jsx)("div",{className:"progress-fill",style:{width:`${Math.min(i,100)}%`}})}),0===l&&(0,t.jsx)("div",{style:{marginTop:"12px",textAlign:"center",fontWeight:"bold"},children:"âœ“ Perfect! No free periods."}),l<0&&(0,t.jsxs)("div",{style:{marginTop:"12px",textAlign:"center",fontWeight:"bold",color:"#ef4444"},children:["âš  Over by ",Math.abs(l)," hours!"]})]})}a("acw62")}),l("e3nvF",function(l,t){e(l.exports,"default",()=>n);var i=a("ayMG0"),r=a("acw62");let c=["Monday","Tuesday","Wednesday","Thursday","Friday"];function n({timetable:e,className:a}){if(!e||!e[a])return(0,i.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#64748b"},children:"No timetable available"});let l=e[a];return(console.log("TimetableGrid - className:",a),console.log("TimetableGrid - grid:",l),console.log("TimetableGrid - grid is array?",Array.isArray(l)),Array.isArray(l)&&0!==l.length)?(0,i.jsxs)("div",{id:"class-timetable-export",className:"timetable-grid",children:[(0,i.jsx)("div",{className:"timetable-header",children:"Day/Period"}),[...Array(6)].map((e,s)=>(0,i.jsxs)("div",{className:"timetable-header",children:["P",s+1]},s)),c.map((e,a)=>l[a]&&Array.isArray(l[a])?(0,i.jsxs)(s(r).Fragment,{children:[(0,i.jsx)("div",{className:"timetable-day",children:e}),l[a].map((e,s)=>(0,i.jsx)("div",{className:`timetable-cell subject-${e&&e.type?e.type.toLowerCase():"free"}`,children:e&&"FREE"!==e.subject?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"subject-name",children:e.subject}),(0,i.jsx)("div",{className:"teacher-name",children:e.teacher})]}):(0,i.jsx)("div",{style:{color:"#94a3b8"},children:"FREE"})},s))]},e):null)]}):(0,i.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#64748b"},children:"Invalid timetable format"})}}),l("hyYFF",function(l,t){e(l.exports,"default",()=>n);var i=a("ayMG0"),r=a("acw62");let c=["Monday","Tuesday","Wednesday","Thursday","Friday"];function n({timetable:e,staffName:a}){if(!e||!e[a])return(0,i.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#64748b"},children:"No timetable generated yet"});let l=e[a];return console.log("StaffTimetableGrid - staffName:",a),console.log("StaffTimetableGrid - grid:",l),console.log("StaffTimetableGrid - grid is array?",Array.isArray(l)),Array.isArray(l)&&(console.log("Grid length:",l.length),console.log("First element:",l[0])),(0,i.jsxs)("div",{id:"staff-timetable-export",className:"timetable-grid",children:[(0,i.jsx)("div",{className:"timetable-header",children:"Day/Period"}),[...Array(6)].map((e,s)=>(0,i.jsxs)("div",{className:"timetable-header",children:["P",s+1]},s)),c.map((e,a)=>(0,i.jsxs)(s(r).Fragment,{children:[(0,i.jsx)("div",{className:"timetable-day",children:e}),l[a].map((e,s)=>(0,i.jsx)("div",{className:`timetable-cell subject-${e.type.toLowerCase()}`,children:"FREE"!==e.subject?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"subject-name",children:e.subject}),(0,i.jsx)("div",{className:"teacher-name",children:e.class})]}):(0,i.jsx)("div",{style:{color:"#94a3b8"},children:"FREE"})},s))]},e))]})}}),l("bU9CP",function(s,a){e(s.exports,"TimetableGenerator",()=>l);class l{constructor(e,s,a){this.classes=e||[],this.staff=s||[],this.subjects=a||[],this.classTimetables={},this.staffTimetables={},this.teacherBusySlots={},this.teacherWeeklyCount={},this.teacherDailyCount={},this.DAYS=["Monday","Tuesday","Wednesday","Thursday","Friday"],this.PERIODS=6,this.MAX_PERIODS_PER_WEEK=30,this.MIN_PERIODS_PER_WEEK=24,this.MAX_SAME_SUBJECT_PER_DAY=2,this.MAX_TEACHER_HOURS_PER_DAY=6,this.MAX_TEACHER_HOURS_PER_WEEK=30}validate(){let e=[];if(this.classes&&0!==this.classes.length||e.push("No classes added"),this.staff&&0!==this.staff.filter(e=>"staff"===e.role).length||e.push("No staff added"),this.subjects&&0!==this.subjects.length||e.push("No subjects added"),e.length>0)return{valid:!1,errors:e};let s={};return this.subjects.forEach(e=>{e&&e.className&&e.hoursPerWeek&&(s[e.className]=(s[e.className]||0)+e.hoursPerWeek)}),this.classes.forEach(a=>{if(a&&a.name){let l=s[a.name]||0;(l<this.MIN_PERIODS_PER_WEEK||l>this.MAX_PERIODS_PER_WEEK)&&e.push(`Class ${a.name}: Has ${l} hours, needs ${this.MIN_PERIODS_PER_WEEK}-${this.MAX_PERIODS_PER_WEEK}`)}}),this.subjects.forEach(s=>{s&&s.isContinuous&&(!s.blockSize||s.blockSize>this.PERIODS)&&e.push(`Lab ${s.name}: Invalid block size`)}),{valid:0===e.length,errors:e}}generate(){try{for(let e of(console.log("Starting timetable generation..."),this._initialize(),this.classes))e&&e.name&&(console.log(`Generating timetable for ${e.name}`),this._generateClassTimetable(e.name)||console.warn(`Partial timetable generated for ${e.name}`));this._generateStaffTimetables();let e=this._validateGenerated();return console.log("Timetable generation completed successfully"),{success:!0,classTimetables:this.classTimetables,staffTimetables:this.staffTimetables,warnings:e.warnings||[]}}catch(e){return console.error("Error generating timetable:",e),{success:!1,error:`Error: ${e.message||"Unknown error"}. Please check your input data.`}}}_initialize(){console.log("Initializing timetables..."),this.classes.forEach(e=>{e&&e.name&&(this.classTimetables[e.name]=this.DAYS.map(()=>Array(this.PERIODS).fill(null)))});let e=this.staff.filter(e=>e&&"staff"===e.role);e.forEach(e=>{e&&e.name&&(this.teacherBusySlots[e.name]={},this.teacherWeeklyCount[e.name]=0,this.teacherDailyCount[e.name]={},this.DAYS.forEach(s=>{this.teacherDailyCount[e.name][s]=0}))}),console.log(`Initialized ${this.classes.length} classes and ${e.length} teachers`)}_generateClassTimetable(e){try{let s=this.subjects.filter(s=>s&&s.className===e);if(0===s.length)return console.warn(`No subjects found for class ${e}`),!0;s.forEach(e=>{e&&(e.placedHours=0)});let a=s.filter(e=>e&&e.isContinuous);for(let s of(console.log(`Placing ${a.length} labs for ${e}`),a))s&&this._placeLabFlexible(e,s);let l=s.filter(e=>e&&!e.isContinuous);for(let s of(console.log(`Placing ${l.length} regular subjects for ${e}`),l))s&&this._placeSubjectFlexible(e,s);return!0}catch(s){return console.error(`Error generating timetable for ${e}:`,s),!1}}_placeLabFlexible(e,s){if(!s||!s.name||!s.teacher)return console.warn("Invalid lab subject:",s),!1;let a=s.blockSize||2,l=Math.floor((s.hoursPerWeek||0)/a),t=0;console.log(`Placing lab ${s.name}: ${l} blocks of ${a} periods`);let i=[];for(let{day:r,dayIdx:c,start:n}of(this.DAYS.forEach((e,s)=>{for(let l=0;l<=this.PERIODS-a;l++)i.push({day:e,dayIdx:s,start:l})}),i)){if(t>=l)break;let i=!0;for(let l=0;l<a;l++){let a=n+l;if(!this.classTimetables[e]||!this.classTimetables[e][c]||this.classTimetables[e][c][a]){i=!1;break}let t=`${r}-P${a+1}`;if(this.teacherBusySlots[s.teacher]&&this.teacherBusySlots[s.teacher][t]){i=!1;break}}if(i){for(let l=0;l<a;l++){let a=n+l;this._placeAt(e,c,a,s)}s.placedHours=(s.placedHours||0)+a,t++,console.log(`Placed lab block ${t}/${l} for ${s.name}`)}}return t<l&&console.warn(`Lab ${s.name}: Placed ${t}/${l} blocks`),t>0}_placeSubjectFlexible(e,s){if(!s||!s.name||!s.teacher)return console.warn("Invalid subject:",s),!1;let a=s.hoursPerWeek||0,l=0,t={};this.DAYS.forEach(e=>{t[e]=0}),console.log(`Placing subject ${s.name}: ${a} hours`);let i=[];for(let{day:r,dayIdx:c,period:n}of(this.DAYS.forEach((e,s)=>{for(let a=0;a<this.PERIODS;a++)i.push({day:e,dayIdx:s,period:a})}),this._shuffle(i),i)){if(l>=a)break;if(t[r]>=this.MAX_SAME_SUBJECT_PER_DAY||!this.classTimetables[e]||!this.classTimetables[e][c]||this.classTimetables[e][c][n])continue;let i=`${r}-P${n+1}`;if(this.teacherBusySlots[s.teacher]&&this.teacherBusySlots[s.teacher][i])continue;let d=this.teacherDailyCount[s.teacher],o=this.teacherWeeklyCount[s.teacher];(!d||!(d[r]>=this.MAX_TEACHER_HOURS_PER_DAY))&&!(o>=this.MAX_TEACHER_HOURS_PER_WEEK)&&(this._placeAt(e,c,n,s),t[r]++,s.placedHours=(s.placedHours||0)+1,l++)}return l<a&&console.warn(`Subject ${s.name}: Placed ${l}/${a} hours`),l>0}_placeAt(e,s,a,l){if(!e||!l||!l.name||!l.teacher)return void console.warn("Invalid placement parameters");let t=this.DAYS[s],i=`${t}-P${a+1}`;this.classTimetables[e]&&this.classTimetables[e][s]?(this.classTimetables[e][s][a]={subject:l.name,teacher:l.teacher,type:l.subjectType||"core"},this.teacherBusySlots[l.teacher]||(this.teacherBusySlots[l.teacher]={}),this.teacherBusySlots[l.teacher][i]=!0,this.teacherWeeklyCount[l.teacher]=(this.teacherWeeklyCount[l.teacher]||0)+1,this.teacherDailyCount[l.teacher]||(this.teacherDailyCount[l.teacher]={}),this.teacherDailyCount[l.teacher][t]||(this.teacherDailyCount[l.teacher][t]=0),this.teacherDailyCount[l.teacher][t]++):console.error(`Invalid timetable structure for ${e}`)}_generateStaffTimetables(){console.log("Generating staff timetables..."),this.staff.filter(e=>e&&"staff"===e.role).forEach(e=>{e&&e.name&&(this.staffTimetables[e.name]=this.DAYS.map(()=>Array(this.PERIODS).fill(null).map(()=>({subject:"FREE",class:"-",type:"free"}))))}),this.classes.forEach(e=>{e&&e.name&&this.classTimetables[e.name]&&this.DAYS.forEach((s,a)=>{let l=this.classTimetables[e.name][a];l&&l.forEach((s,l)=>{s&&s.teacher&&this.staffTimetables[s.teacher]&&(this.staffTimetables[s.teacher][a][l]={subject:s.subject,class:e.name,type:s.type})})})}),console.log(`Generated ${Object.keys(this.staffTimetables).length} staff timetables`)}_validateGenerated(){console.log("Validating generated timetables...");let e=[];return this.classes.forEach(s=>{if(!s||!s.name)return;if(!this.classTimetables[s.name])return void e.push(`Class ${s.name}: No timetable generated`);let a=0;this.DAYS.forEach((e,l)=>{let t=this.classTimetables[s.name][l];t&&t.forEach((e,t)=>{!e&&(this.classTimetables[s.name][l][t]={subject:"FREE",teacher:"-",type:"free"},a++)})}),a>0&&e.push(`Class ${s.name}: ${a} FREE periods`)}),console.log(`Validation complete. ${e.length} warnings.`),{valid:0===e.length,warnings:e}}_shuffle(e){for(let s=e.length-1;s>0;s--){let a=Math.floor(Math.random()*(s+1));[e[s],e[a]]=[e[a],e[s]]}}}});
//# sourceMappingURL=AdminDashboard.b67adc97.js.map

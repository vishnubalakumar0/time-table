{"mappings":"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","sources":["<anon>","src/components/AdminDashboard.jsx","src/components/Toast.jsx","src/components/HoursTracker.jsx","src/components/timetableGrid.jsx","src/components/StaffTimetableGrid.jsx","src/utils/timetableGenerator.jsx"],"sourcesContent":["\nfunction $parcel$defineInteropFlag(a) {\n  Object.defineProperty(a, '__esModule', {value: true, configurable: true});\n}\n\nfunction $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {get: v, set: s, enumerable: true, configurable: true});\n}\n\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\n\n      var $parcel$global = globalThis;\n    var parcelRequire = $parcel$global[\"parcelRequireb79f\"];\nvar parcelRegister = parcelRequire.register;\nparcelRegister(\"dXtBz\", function(module, exports) {\n\n$parcel$defineInteropFlag(module.exports);\n\n$parcel$export(module.exports, \"default\", () => $9b678cdbbac6dec2$export$2e2bcd8739ae039);\n\nvar $ayMG0 = parcelRequire(\"ayMG0\");\n\nvar $acw62 = parcelRequire(\"acw62\");\n\nvar $aOD4d = parcelRequire(\"aOD4d\");\n\nvar $2A5UH = parcelRequire(\"2A5UH\");\n\nvar $4XiCD = parcelRequire(\"4XiCD\");\n\nvar $e3nvF = parcelRequire(\"e3nvF\");\n\nvar $hyYFF = parcelRequire(\"hyYFF\");\n\nvar $gqAsg = parcelRequire(\"gqAsg\");\n\nvar $bU9CP = parcelRequire(\"bU9CP\");\n\nvar $fAZ67 = parcelRequire(\"fAZ67\");\n\nvar $6AR8M = parcelRequire(\"6AR8M\");\n\nvar $ilpIi = parcelRequire(\"ilpIi\");\nfunction $9b678cdbbac6dec2$export$2e2bcd8739ae039({ user: user, onLogout: onLogout }) {\n    const [classes, setClasses] = (0, $acw62.useState)([]);\n    const [departments, setDepartments] = (0, $acw62.useState)([]);\n    const [staff, setStaff] = (0, $acw62.useState)([]);\n    const [subjects, setSubjects] = (0, $acw62.useState)([]);\n    const [timetable, setTimetable] = (0, $acw62.useState)(null);\n    const [toasts, setToasts] = (0, $acw62.useState)([]);\n    const [loading, setLoading] = (0, $acw62.useState)(true);\n    const [showAddStaffForm, setShowAddStaffForm] = (0, $acw62.useState)(false);\n    const [showAddSubjectForm, setShowAddSubjectForm] = (0, $acw62.useState)(false);\n    const [showAddDepartmentForm, setShowAddDepartmentForm] = (0, $acw62.useState)(false);\n    const [showAddClassForm, setShowAddClassForm] = (0, $acw62.useState)(false);\n    // Refs for scrolling\n    const staffFormRef = (0, $acw62.useRef)(null);\n    const subjectFormRef = (0, $acw62.useRef)(null);\n    // Form Models\n    const [newClass, setNewClass] = (0, $acw62.useState)({\n        name: '',\n        hallNumber: '',\n        department: ''\n    });\n    const [newStaff, setNewStaff] = (0, $acw62.useState)({\n        id: null,\n        name: '',\n        username: '',\n        password: '',\n        freePeriodMode: 'auto',\n        manualFreePeriods: 0\n    });\n    const [newSubject, setNewSubject] = (0, $acw62.useState)({\n        id: null,\n        className: '',\n        name: '',\n        subjectType: 'Core',\n        hoursPerWeek: 6,\n        isContinuous: false,\n        blockSize: 2,\n        teacher: ''\n    });\n    const [newDepartment, setNewDepartment] = (0, $acw62.useState)({\n        id: null,\n        name: ''\n    });\n    const teachers = staff.filter((s)=>s.role === \"staff\");\n    const showToast = (message, type, duration = 3000, undoAction = null)=>{\n        const newToast = {\n            message: message,\n            type: type,\n            id: Date.now(),\n            undoAction: undoAction\n        };\n        setToasts((prev)=>[\n                ...prev,\n                newToast\n            ]);\n        setTimeout(()=>removeToast(newToast.id), duration);\n    };\n    const removeToast = (id)=>{\n        setToasts((prev)=>prev.filter((t)=>t.id !== id));\n    };\n    const convertFlatToNested = (flatTimetable)=>{\n        if (!flatTimetable) return null;\n        const nested = {};\n        Object.keys(flatTimetable).forEach((key)=>{\n            const slots = flatTimetable[key];\n            if (Array.isArray(slots) && slots.length > 0 && Array.isArray(slots[0])) nested[key] = slots;\n            else if (Array.isArray(slots)) {\n                const days = [\n                    [],\n                    [],\n                    [],\n                    [],\n                    []\n                ];\n                slots.forEach((slot)=>{\n                    if (slot && typeof slot.day === 'number' && typeof slot.period === 'number') {\n                        if (!days[slot.day]) days[slot.day] = [];\n                        days[slot.day][slot.period] = {\n                            subject: slot.subject,\n                            teacher: slot.teacher,\n                            class: slot.class,\n                            type: slot.type\n                        };\n                    }\n                });\n                days.forEach((day, idx)=>{\n                    if (!days[idx]) days[idx] = [];\n                    for(let p = 0; p < 6; p++)if (!days[idx][p]) days[idx][p] = slots[0]?.class !== undefined ? {\n                        subject: 'FREE',\n                        class: '-',\n                        type: 'free'\n                    } : null;\n                });\n                nested[key] = days;\n            }\n        });\n        return nested;\n    };\n    const fetchData = async ()=>{\n        setLoading(true);\n        try {\n            const [cls, st, sb, tt, dp] = await Promise.all([\n                (0, $ilpIi.getDocs)((0, $ilpIi.collection)((0, $fAZ67.db), 'classes')),\n                (0, $ilpIi.getDocs)((0, $ilpIi.collection)((0, $fAZ67.db), 'staff')),\n                (0, $ilpIi.getDocs)((0, $ilpIi.collection)((0, $fAZ67.db), 'subjects')),\n                (0, $ilpIi.getDocs)((0, $ilpIi.collection)((0, $fAZ67.db), 'timetable')),\n                (0, $ilpIi.getDocs)((0, $ilpIi.collection)((0, $fAZ67.db), 'departments'))\n            ]);\n            setClasses(cls.docs.map((doc)=>({\n                    id: doc.id,\n                    ...doc.data()\n                })));\n            setStaff(st.docs.map((doc)=>({\n                    id: doc.id,\n                    ...doc.data()\n                })));\n            setSubjects(sb.docs.map((doc)=>({\n                    id: doc.id,\n                    ...doc.data()\n                })));\n            setDepartments(dp.docs.map((doc)=>({\n                    id: doc.id,\n                    ...doc.data()\n                })));\n            if (!tt.empty) {\n                const ttData = tt.docs[0].data();\n                const convertedData = {\n                    classTimetables: convertFlatToNested(ttData.classTimetables),\n                    staffTimetables: convertFlatToNested(ttData.staffTimetables)\n                };\n                setTimetable(convertedData);\n            }\n        } catch (error) {\n            showToast(\"\\u274C Error loading data: \" + error.message, 'error');\n            console.error(error);\n        }\n        setLoading(false);\n    };\n    (0, $acw62.useEffect)(()=>{\n        fetchData();\n    }, []);\n    // ==================== UNDO HANDLER ====================\n    // Undo handler: correctly restore by document idno duplicates!\n    // ==================== UNDO HANDLER ====================\n    const restoreFromUndo = async (undoItem)=>{\n        try {\n            if (undoItem.type === 'class') {\n                const { id: id, ...classData } = undoItem.data;\n                await (0, $ilpIi.setDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'classes', id), classData);\n            } else if (undoItem.type === 'staff') {\n                const { id: id, ...staffData } = undoItem.data;\n                await (0, $ilpIi.setDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'staff', id), staffData);\n                if (undoItem.data.firebaseUid) await (0, $ilpIi.setDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'users', undoItem.data.firebaseUid), {\n                    name: undoItem.data.name,\n                    username: undoItem.data.username,\n                    role: 'staff'\n                });\n            } else if (undoItem.type === 'subject') {\n                const { id: id, ...subjectData } = undoItem.data;\n                await (0, $ilpIi.setDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'subjects', id), subjectData);\n            }\n            await fetchData(); // reload UI\n            showToast(\"\\u2705 Data restored!\", 'success');\n        } catch (error) {\n            console.error('Restore error:', error);\n            showToast(\"\\u274C Restore failed: \" + error.message, 'error');\n        }\n    };\n    // ==================== CLASS CRUD ====================\n    const addClass = async ()=>{\n        if (!newClass.name) return showToast(\"Enter class name\", \"error\");\n        if (classes.find((c)=>c.name === newClass.name && !newClass.id)) return showToast(\"Class already exists\", \"error\");\n        try {\n            if (newClass.id) {\n                await (0, $ilpIi.updateDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'classes', newClass.id), {\n                    name: newClass.name,\n                    hallNumber: newClass.hallNumber,\n                    department: newClass.department || ''\n                });\n                setClasses(classes.map((c)=>c.id === newClass.id ? {\n                        id: newClass.id,\n                        ...newClass\n                    } : c));\n                showToast(\"\\u2705 Class updated!\", \"success\");\n            } else {\n                const docRef = await (0, $ilpIi.addDoc)((0, $ilpIi.collection)((0, $fAZ67.db), 'classes'), {\n                    name: newClass.name,\n                    hallNumber: newClass.hallNumber || '',\n                    department: newClass.department || ''\n                });\n                setClasses([\n                    ...classes,\n                    {\n                        id: docRef.id,\n                        name: newClass.name,\n                        hallNumber: newClass.hallNumber || '',\n                        department: newClass.department || ''\n                    }\n                ]);\n                showToast(\"\\u2705 Class added!\", \"success\");\n            }\n            setNewClass({\n                name: '',\n                hallNumber: '',\n                department: ''\n            });\n        } catch (error) {\n            showToast(\"\\u274C Operation failed\", \"error\");\n        }\n    };\n    const editClass = (cls)=>{\n        setNewClass({\n            id: cls.id,\n            name: cls.name,\n            hallNumber: cls.hallNumber || '',\n            department: cls.department || ''\n        });\n        window.scrollTo({\n            top: 0,\n            behavior: 'smooth'\n        });\n    };\n    const addOrUpdateDepartment = async ()=>{\n        if (!newDepartment.name.trim()) return showToast(\"Enter department name\", \"error\");\n        try {\n            if (newDepartment.id) {\n                await (0, $ilpIi.updateDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'departments', newDepartment.id), {\n                    name: newDepartment.name\n                });\n                setDepartments(departments.map((d)=>d.id === newDepartment.id ? {\n                        ...d,\n                        name: newDepartment.name\n                    } : d));\n                showToast(\"\\u2705 Department updated!\", \"success\");\n            } else {\n                const ref = await (0, $ilpIi.addDoc)((0, $ilpIi.collection)((0, $fAZ67.db), 'departments'), {\n                    name: newDepartment.name\n                });\n                setDepartments([\n                    ...departments,\n                    {\n                        id: ref.id,\n                        name: newDepartment.name\n                    }\n                ]);\n                showToast(\"\\u2705 Department added!\", \"success\");\n            }\n            setNewDepartment({\n                id: null,\n                name: ''\n            });\n        } catch (error) {\n            showToast(\"\\u274C Operation failed\", \"error\");\n        }\n    };\n    const editDepartment = (dept)=>{\n        setNewDepartment({\n            id: dept.id,\n            name: dept.name\n        });\n        window.scrollTo({\n            top: 0,\n            behavior: 'smooth'\n        });\n    };\n    const deleteDepartment = async (id)=>{\n        if (!window.confirm(\"Delete this department?\")) return;\n        try {\n            await (0, $ilpIi.deleteDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'departments', id));\n            setDepartments(departments.filter((d)=>d.id !== id));\n            showToast(\"\\u2705 Department deleted\", \"success\");\n        } catch (error) {\n            showToast(\"\\u274C Failed to delete\", \"error\");\n        }\n    };\n    // ==================== CLASS CRUD ====================\n    const deleteClass = async (id)=>{\n        if (!window.confirm(\"Delete this class?\")) return;\n        try {\n            const classToDelete = classes.find((c)=>c.id === id);\n            if (!classToDelete) return;\n            const undoItem = {\n                type: 'class',\n                data: {\n                    ...classToDelete\n                }\n            };\n            await (0, $ilpIi.deleteDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'classes', id));\n            setClasses(classes.filter((c)=>c.id !== id));\n            showToast(`\\u{2705} Class deleted`, 'success', 5000, ()=>restoreFromUndo(undoItem));\n        } catch (error) {\n            console.error('Delete error:', error);\n            showToast(\"\\u274C Failed to delete\", \"error\");\n        }\n    };\n    // ==================== STAFF CRUD ====================\n    const addOrUpdateStaff = async ()=>{\n        if (!newStaff.name || !newStaff.username) return showToast(\"Fill all required fields\", \"error\");\n        try {\n            if (newStaff.id) {\n                // Editing existing staff\n                const staffToUpdate = staff.find((s)=>s.id === newStaff.id);\n                const { password: password, ...updateData } = newStaff;\n                // Update Firestore staff document with name, freePeriodMode, manualFreePeriods\n                const firestoreUpdateData = {\n                    name: updateData.name,\n                    freePeriodMode: updateData.freePeriodMode,\n                    manualFreePeriods: updateData.manualFreePeriods\n                };\n                // Include username if it changed\n                if (staffToUpdate.username !== updateData.username) firestoreUpdateData.username = updateData.username;\n                await (0, $ilpIi.updateDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'staff', newStaff.id), firestoreUpdateData);\n                // Update users collection with new data\n                if (staffToUpdate.firebaseUid) await (0, $ilpIi.updateDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'users', staffToUpdate.firebaseUid), {\n                    name: newStaff.name,\n                    username: newStaff.username,\n                    role: 'staff'\n                });\n                // Handle password change if provided\n                if (password && password.trim()) {\n                    await (0, $ilpIi.updateDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'staff', newStaff.id), {\n                        tempPassword: password,\n                        passwordLastChanged: new Date().toISOString(),\n                        needsPasswordChange: true\n                    });\n                    showToast(\"\\u2705 Temporary password set. Share it with staff.\", \"success\");\n                } else showToast(\"\\u2705 Staff updated!\", \"success\");\n                setStaff(staff.map((s)=>s.id === newStaff.id ? {\n                        ...s,\n                        ...firestoreUpdateData\n                    } : s));\n                resetStaffForm();\n                setShowAddStaffForm(false);\n                return;\n            }\n            // Adding new staff\n            if (!newStaff.password) return showToast(\"Password required\", \"error\");\n            const email = `${newStaff.username}@timetable.com`;\n            const userCredential = await (0, $6AR8M.createUserWithEmailAndPassword)((0, $fAZ67.auth), email, newStaff.password);\n            const uid = userCredential.user.uid;\n            const staffData = {\n                name: newStaff.name,\n                username: newStaff.username,\n                freePeriodMode: newStaff.freePeriodMode,\n                manualFreePeriods: newStaff.manualFreePeriods,\n                role: \"staff\",\n                firebaseUid: uid\n            };\n            const docRef = await (0, $ilpIi.addDoc)((0, $ilpIi.collection)((0, $fAZ67.db), 'staff'), staffData);\n            await (0, $ilpIi.setDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'users', uid), {\n                name: newStaff.name,\n                username: newStaff.username,\n                role: 'staff'\n            });\n            setStaff([\n                ...staff,\n                {\n                    id: docRef.id,\n                    ...staffData\n                }\n            ]);\n            resetStaffForm();\n            setShowAddStaffForm(false);\n            showToast(\"\\u2705 Staff added!\", \"success\");\n        } catch (error) {\n            showToast(\"\\u274C Operation failed: \" + error.message, \"error\");\n            console.error(error);\n        }\n    };\n    const editStaff = (staffMember)=>{\n        setNewStaff({\n            ...staffMember,\n            password: ''\n        });\n        setShowAddStaffForm(true);\n        setTimeout(()=>{\n            staffFormRef.current?.scrollIntoView({\n                behavior: 'smooth',\n                block: 'center'\n            });\n        }, 100);\n    };\n    const resetStaffForm = ()=>{\n        setNewStaff({\n            id: null,\n            name: '',\n            username: '',\n            password: '',\n            freePeriodMode: 'auto',\n            manualFreePeriods: 0\n        });\n    };\n    const deleteStaff = async (id)=>{\n        if (!window.confirm(\"Delete this staff member?\")) return;\n        try {\n            const staffToDelete = staff.find((s)=>s.id === id);\n            if (!staffToDelete) return;\n            const undoItem = {\n                type: 'staff',\n                data: {\n                    ...staffToDelete\n                }\n            };\n            await (0, $ilpIi.deleteDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'staff', id));\n            if (staffToDelete.firebaseUid) await (0, $ilpIi.deleteDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'users', staffToDelete.firebaseUid));\n            setStaff(staff.filter((x)=>x.id !== id));\n            showToast(\"\\u2705 Staff deleted\", 'success', 5000, ()=>restoreFromUndo(undoItem));\n        } catch (error) {\n            console.error('Delete staff error:', error);\n            showToast(\"\\u274C Failed to delete\", 'error');\n        }\n    };\n    // ==================== SUBJECT CRUD ====================\n    const addOrUpdateSubject = async ()=>{\n        if (!newSubject.className || !newSubject.name || !newSubject.teacher) return showToast(\"Fill all required fields\", \"error\");\n        try {\n            const subjectData = {\n                className: newSubject.className,\n                name: newSubject.name,\n                subjectType: newSubject.subjectType,\n                hoursPerWeek: newSubject.hoursPerWeek,\n                isContinuous: newSubject.isContinuous,\n                blockSize: newSubject.blockSize,\n                teacher: newSubject.teacher\n            };\n            if (newSubject.id) {\n                await (0, $ilpIi.updateDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'subjects', newSubject.id), subjectData);\n                setSubjects(subjects.map((s)=>s.id === newSubject.id ? {\n                        id: newSubject.id,\n                        ...subjectData\n                    } : s));\n                showToast(\"\\u2705 Subject updated!\", \"success\");\n            } else {\n                const docRef = await (0, $ilpIi.addDoc)((0, $ilpIi.collection)((0, $fAZ67.db), 'subjects'), subjectData);\n                setSubjects([\n                    ...subjects,\n                    {\n                        id: docRef.id,\n                        ...subjectData\n                    }\n                ]);\n                showToast(\"\\u2705 Subject added!\", \"success\");\n            }\n            resetSubjectForm();\n            setShowAddSubjectForm(false);\n        } catch (error) {\n            showToast(\"\\u274C Operation failed\", \"error\");\n            console.error(error);\n        }\n    };\n    const editSubject = (subject)=>{\n        setNewSubject({\n            id: subject.id,\n            className: subject.className,\n            name: subject.name,\n            subjectType: subject.subjectType,\n            hoursPerWeek: subject.hoursPerWeek,\n            isContinuous: subject.isContinuous || false,\n            blockSize: subject.blockSize || 2,\n            teacher: subject.teacher\n        });\n        setShowAddSubjectForm(true);\n        setTimeout(()=>{\n            subjectFormRef.current?.scrollIntoView({\n                behavior: 'smooth',\n                block: 'center'\n            });\n        }, 100);\n    };\n    const resetSubjectForm = ()=>{\n        setNewSubject({\n            id: null,\n            className: '',\n            name: '',\n            subjectType: 'Core',\n            hoursPerWeek: 6,\n            isContinuous: false,\n            blockSize: 2,\n            teacher: ''\n        });\n    };\n    const deleteSubject = async (id)=>{\n        if (!window.confirm(\"Delete this subject?\")) return;\n        try {\n            const subjectToDelete = subjects.find((s)=>s.id === id);\n            if (!subjectToDelete) return;\n            const undoItem = {\n                type: 'subject',\n                data: {\n                    ...subjectToDelete\n                }\n            };\n            await (0, $ilpIi.deleteDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'subjects', id));\n            setSubjects(subjects.filter((s)=>s.id !== id));\n            showToast(\"\\u2705 Subject deleted\", 'success', 5000, ()=>restoreFromUndo(undoItem));\n        } catch (error) {\n            console.error('Delete subject error:', error);\n            showToast(\"\\u274C Failed to delete\", 'error');\n        }\n    };\n    // ==================== TIMETABLE GENERATION ====================\n    const generateTimetable = async ()=>{\n        setLoading(true);\n        try {\n            const generator = new (0, $bU9CP.TimetableGenerator)(classes, staff.filter((s)=>s.role === 'staff'), subjects);\n            const validation = generator.validate();\n            if (!validation.valid) {\n                showToast(\"\\u274C Validation: \" + validation.errors[0], 'error');\n                setLoading(false);\n                return;\n            }\n            const result = generator.generate();\n            if (result.success) {\n                const serializableClassTimetables = {};\n                const serializableStaffTimetables = {};\n                Object.keys(result.classTimetables).forEach((className)=>{\n                    serializableClassTimetables[className] = result.classTimetables[className].map((day, dayIndex)=>{\n                        return day.map((period, periodIndex)=>({\n                                day: dayIndex,\n                                period: periodIndex,\n                                subject: period?.subject || null,\n                                teacher: period?.teacher || null,\n                                type: period?.type || null\n                            }));\n                    }).flat();\n                });\n                Object.keys(result.staffTimetables).forEach((staffName)=>{\n                    serializableStaffTimetables[staffName] = result.staffTimetables[staffName].map((day, dayIndex)=>{\n                        return day.map((period, periodIndex)=>({\n                                day: dayIndex,\n                                period: periodIndex,\n                                subject: period?.subject || null,\n                                class: period?.class || null,\n                                type: period?.type || null\n                            }));\n                    }).flat();\n                });\n                const timetableData = {\n                    classTimetables: serializableClassTimetables,\n                    staffTimetables: serializableStaffTimetables,\n                    generatedAt: new Date().toISOString()\n                };\n                const ttRef = (0, $ilpIi.collection)((0, $fAZ67.db), 'timetable');\n                const existing = await (0, $ilpIi.getDocs)(ttRef);\n                if (!existing.empty) await (0, $ilpIi.updateDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'timetable', existing.docs[0].id), timetableData);\n                else await (0, $ilpIi.addDoc)(ttRef, timetableData);\n                const teacherList = staff.filter((s)=>s.role === 'staff');\n                for (const teacher of teacherList){\n                    const staffTT = serializableStaffTimetables[teacher.name];\n                    if (staffTT) await (0, $ilpIi.setDoc)((0, $ilpIi.doc)((0, $fAZ67.db), 'staffTimetables', teacher.id), {\n                        staffName: teacher.name,\n                        timetable: staffTT,\n                        generatedAt: new Date().toISOString()\n                    });\n                }\n                const displayClassTimetables = {};\n                Object.keys(serializableClassTimetables).forEach((className)=>{\n                    const days = [\n                        [],\n                        [],\n                        [],\n                        [],\n                        []\n                    ];\n                    serializableClassTimetables[className].forEach((slot)=>{\n                        if (!days[slot.day]) days[slot.day] = [];\n                        days[slot.day][slot.period] = {\n                            subject: slot.subject,\n                            teacher: slot.teacher,\n                            type: slot.type\n                        };\n                    });\n                    days.forEach((day, idx)=>{\n                        if (!days[idx]) days[idx] = [];\n                        for(let p = 0; p < 6; p++)if (!days[idx][p]) days[idx][p] = null;\n                    });\n                    displayClassTimetables[className] = days;\n                });\n                const displayStaffTimetables = {};\n                Object.keys(serializableStaffTimetables).forEach((staffName)=>{\n                    const days = [\n                        [],\n                        [],\n                        [],\n                        [],\n                        []\n                    ];\n                    serializableStaffTimetables[staffName].forEach((slot)=>{\n                        if (!days[slot.day]) days[slot.day] = [];\n                        days[slot.day][slot.period] = {\n                            subject: slot.subject,\n                            class: slot.class,\n                            type: slot.type\n                        };\n                    });\n                    days.forEach((day, idx)=>{\n                        if (!days[idx]) days[idx] = [];\n                        for(let p = 0; p < 6; p++)if (!days[idx][p]) days[idx][p] = {\n                            subject: 'FREE',\n                            class: '-',\n                            type: 'free'\n                        };\n                    });\n                    displayStaffTimetables[staffName] = days;\n                });\n                setTimetable({\n                    classTimetables: displayClassTimetables,\n                    staffTimetables: displayStaffTimetables\n                });\n                showToast(\"\\u2705 Timetable generated & saved!\", 'success');\n                setTimeout(()=>{\n                    document.getElementById('view-timetables')?.scrollIntoView({\n                        behavior: 'smooth'\n                    });\n                }, 1000);\n            } else showToast(\"\\u274C Failed: \" + result.error, 'error');\n        } catch (error) {\n            showToast(\"\\u274C Error: \" + error.message, 'error');\n            console.error(error);\n        }\n        setLoading(false);\n    };\n    if (loading) return /*#__PURE__*/ (0, $ayMG0.jsxs)((0, $ayMG0.Fragment), {\n        children: [\n            /*#__PURE__*/ (0, $ayMG0.jsx)((0, $aOD4d.default), {}),\n            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                style: {\n                    display: 'flex',\n                    flexDirection: 'column',\n                    justifyContent: 'center',\n                    alignItems: 'center',\n                    height: '100vh',\n                    color: 'white',\n                    fontSize: '24px',\n                    gap: '20px'\n                },\n                children: [\n                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                        className: \"spinner\"\n                    }),\n                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                        children: \"Loading...\"\n                    })\n                ]\n            })\n        ]\n    });\n    return /*#__PURE__*/ (0, $ayMG0.jsxs)((0, $ayMG0.Fragment), {\n        children: [\n            /*#__PURE__*/ (0, $ayMG0.jsx)((0, $aOD4d.default), {}),\n            /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                className: \"min-h-screen relative z-10 text-white\",\n                children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                    className: \"header-content\",\n                    children: [\n                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"h1\", {\n                            children: \"\\uD83C\\uDFEB Admin Dashboard\"\n                        }),\n                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                            className: \"header-actions\",\n                            children: /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                className: \"btn btn-danger btn-sm\",\n                                onClick: onLogout,\n                                children: \"Logout\"\n                            })\n                        })\n                    ]\n                })\n            }),\n            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                className: \"content\",\n                children: [\n                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                        className: \"section\",\n                        children: [\n                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"section-header\",\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                        className: \"section-icon\",\n                                        children: \"\\uD83C\\uDFE2\"\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"h2\", {\n                                        className: \"section-title\",\n                                        children: \"Manage Departments\"\n                                    })\n                                ]\n                            }),\n                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"card\",\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"h3\", {\n                                        children: [\n                                            \"Existing Departments (\",\n                                            departments.length,\n                                            \")\"\n                                        ]\n                                    }),\n                                    departments.length === 0 ? /*#__PURE__*/ (0, $ayMG0.jsx)(\"p\", {\n                                        style: {\n                                            color: '#64748b',\n                                            textAlign: 'center',\n                                            padding: '20px'\n                                        },\n                                        children: \"No departments added yet\"\n                                    }) : /*#__PURE__*/ (0, $ayMG0.jsxs)((0, $ayMG0.Fragment), {\n                                        children: [\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                className: \"desktop-table\",\n                                                children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"table\", {\n                                                    children: [\n                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"thead\", {\n                                                            children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"tr\", {\n                                                                children: [\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                        children: \"#\"\n                                                                    }),\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                        children: \"Department\"\n                                                                    }),\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                        children: \"Classes\"\n                                                                    }),\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                        children: \"Actions\"\n                                                                    })\n                                                                ]\n                                                            })\n                                                        }),\n                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"tbody\", {\n                                                            children: departments.map((d, idx)=>{\n                                                                const classCount = classes.filter((c)=>(c.department || '') === d.name).length;\n                                                                return /*#__PURE__*/ (0, $ayMG0.jsxs)(\"tr\", {\n                                                                    children: [\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                            children: idx + 1\n                                                                        }),\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                            children: /*#__PURE__*/ (0, $ayMG0.jsx)(\"strong\", {\n                                                                                children: d.name\n                                                                            })\n                                                                        }),\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                            children: classCount\n                                                                        }),\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                            children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                                className: \"action-buttons\",\n                                                                                children: [\n                                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                                        className: \"btn-icon btn-icon-primary\",\n                                                                                        onClick: ()=>{\n                                                                                            editDepartment(d);\n                                                                                            setShowAddDepartmentForm(true);\n                                                                                        },\n                                                                                        title: \"Edit\",\n                                                                                        children: \"\\u270F\\uFE0F\"\n                                                                                    }),\n                                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                                        className: \"btn-icon btn-icon-danger\",\n                                                                                        onClick: ()=>deleteDepartment(d.id),\n                                                                                        title: \"Delete\",\n                                                                                        children: \"\\uD83D\\uDDD1\\uFE0F\"\n                                                                                    })\n                                                                                ]\n                                                                            })\n                                                                        })\n                                                                    ]\n                                                                }, d.id);\n                                                            })\n                                                        })\n                                                    ]\n                                                })\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                className: \"mobile-cards\",\n                                                children: departments.map((d, idx)=>{\n                                                    const classCount = classes.filter((c)=>(c.department || '') === d.name).length;\n                                                    return /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                        className: \"mobile-card\",\n                                                        children: [\n                                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                className: \"mobile-card-header\",\n                                                                children: [\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                        className: \"mobile-card-title\",\n                                                                        children: d.name\n                                                                    }),\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"span\", {\n                                                                        className: \"mobile-card-badge\",\n                                                                        children: [\n                                                                            \"#\",\n                                                                            idx + 1\n                                                                        ]\n                                                                    })\n                                                                ]\n                                                            }),\n                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                                className: \"mobile-card-body\",\n                                                                children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                    className: \"mobile-card-row\",\n                                                                    children: [\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                            className: \"mobile-card-label\",\n                                                                            children: \"Classes:\"\n                                                                        }),\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                            className: \"mobile-card-value\",\n                                                                            children: classCount\n                                                                        })\n                                                                    ]\n                                                                })\n                                                            }),\n                                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                className: \"mobile-card-actions\",\n                                                                children: [\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                        className: \"btn btn-primary btn-sm\",\n                                                                        onClick: ()=>{\n                                                                            editDepartment(d);\n                                                                            setShowAddDepartmentForm(true);\n                                                                        },\n                                                                        children: \"\\u270F\\uFE0F Edit\"\n                                                                    }),\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                        className: \"btn btn-danger btn-sm\",\n                                                                        onClick: ()=>deleteDepartment(d.id),\n                                                                        children: \"\\uD83D\\uDDD1\\uFE0F Delete\"\n                                                                    })\n                                                                ]\n                                                            })\n                                                        ]\n                                                    }, d.id);\n                                                })\n                                            })\n                                        ]\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                        className: \"btn btn-success btn-sm\",\n                                        onClick: ()=>setShowAddDepartmentForm(true),\n                                        style: {\n                                            marginTop: '15px'\n                                        },\n                                        children: \"\\u2795 Add Department\"\n                                    })\n                                ]\n                            }),\n                            showAddDepartmentForm && /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"card\",\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"h3\", {\n                                        children: newDepartment.id ? \"\\u270F\\uFE0F Edit Department\" : \"\\u2795 Add New Department\"\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                        className: \"grid-2\",\n                                        children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                            className: \"form-group\",\n                                            children: [\n                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"label\", {\n                                                    children: \"Department Name *\"\n                                                }),\n                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"input\", {\n                                                    type: \"text\",\n                                                    value: newDepartment.name,\n                                                    onChange: (e)=>setNewDepartment({\n                                                            ...newDepartment,\n                                                            name: e.target.value\n                                                        }),\n                                                    placeholder: \"Computer Science\"\n                                                })\n                                            ]\n                                        })\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                        style: {\n                                            display: 'flex',\n                                            gap: '10px'\n                                        },\n                                        children: [\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                className: \"btn btn-primary\",\n                                                onClick: addOrUpdateDepartment,\n                                                children: newDepartment.id ? \"\\uD83D\\uDCBE Save Changes\" : \"\\u2795 Add Department\"\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                className: \"btn btn-secondary\",\n                                                onClick: ()=>{\n                                                    setNewDepartment({\n                                                        id: null,\n                                                        name: ''\n                                                    });\n                                                    setShowAddDepartmentForm(false);\n                                                },\n                                                children: \"\\u274C Cancel\"\n                                            })\n                                        ]\n                                    })\n                                ]\n                            })\n                        ]\n                    }),\n                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                        className: \"section\",\n                        children: [\n                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"section-header\",\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                        className: \"section-icon\",\n                                        children: \"\\uD83D\\uDCDA\"\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"h2\", {\n                                        className: \"section-title\",\n                                        children: \"Manage Classes\"\n                                    })\n                                ]\n                            }),\n                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"card\",\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"h3\", {\n                                        children: [\n                                            \"Existing Classes (\",\n                                            classes.length,\n                                            \")\"\n                                        ]\n                                    }),\n                                    classes.length === 0 ? /*#__PURE__*/ (0, $ayMG0.jsx)(\"p\", {\n                                        style: {\n                                            color: '#64748b',\n                                            textAlign: 'center',\n                                            padding: '20px'\n                                        },\n                                        children: \"No classes added yet\"\n                                    }) : /*#__PURE__*/ (0, $ayMG0.jsxs)((0, $ayMG0.Fragment), {\n                                        children: [\n                                            (()=>{\n                                                const sorted = [\n                                                    ...classes\n                                                ].sort((a, b)=>(a.department || 'Unassigned').localeCompare(b.department || 'Unassigned') || a.name.localeCompare(b.name));\n                                                const groups = {};\n                                                sorted.forEach((cls)=>{\n                                                    const dept = cls.department || 'Unassigned';\n                                                    if (!groups[dept]) groups[dept] = [];\n                                                    groups[dept].push(cls);\n                                                });\n                                                return Object.keys(groups).filter((d)=>groups[d].length > 0).map((dept)=>/*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                        className: \"dept-group\",\n                                                        children: [\n                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                                className: \"dept-chip\",\n                                                                children: dept\n                                                            }),\n                                                            groups[dept].map((cls, idx)=>{\n                                                                const classSubjects = subjects.filter((s)=>s.className === cls.name);\n                                                                const totalHours = classSubjects.reduce((sum, s)=>sum + s.hoursPerWeek, 0);\n                                                                const progress = totalHours / 30 * 100;\n                                                                return /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                    className: \"class-box\",\n                                                                    children: [\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                            style: {\n                                                                                marginBottom: '8px',\n                                                                                display: 'flex',\n                                                                                alignItems: 'center',\n                                                                                justifyContent: 'space-between',\n                                                                                gap: '10px',\n                                                                                color: '#1e293b',\n                                                                                flexWrap: 'wrap'\n                                                                            },\n                                                                            children: [\n                                                                                /*#__PURE__*/ (0, $ayMG0.jsxs)(\"h4\", {\n                                                                                    style: {\n                                                                                        margin: 0,\n                                                                                        display: 'flex',\n                                                                                        alignItems: 'center',\n                                                                                        gap: '8px'\n                                                                                    },\n                                                                                    children: [\n                                                                                        \"Class: \",\n                                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"strong\", {\n                                                                                            children: cls.name\n                                                                                        })\n                                                                                    ]\n                                                                                }),\n                                                                                /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                                    style: {\n                                                                                        display: 'flex',\n                                                                                        alignItems: 'center',\n                                                                                        gap: '16px',\n                                                                                        color: '#64748b',\n                                                                                        fontWeight: 600\n                                                                                    },\n                                                                                    children: [\n                                                                                        /*#__PURE__*/ (0, $ayMG0.jsxs)(\"span\", {\n                                                                                            children: [\n                                                                                                totalHours,\n                                                                                                \"/30 hours\"\n                                                                                            ]\n                                                                                        }),\n                                                                                        /*#__PURE__*/ (0, $ayMG0.jsxs)(\"span\", {\n                                                                                            children: [\n                                                                                                Math.max(30 - totalHours, 0),\n                                                                                                \"h remaining\"\n                                                                                            ]\n                                                                                        })\n                                                                                    ]\n                                                                                })\n                                                                            ]\n                                                                        }),\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                                            style: {\n                                                                                width: '100%',\n                                                                                height: '8px',\n                                                                                backgroundColor: '#e2e8f0',\n                                                                                borderRadius: '4px',\n                                                                                overflow: 'hidden',\n                                                                                marginBottom: '15px'\n                                                                            },\n                                                                            children: /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                                                style: {\n                                                                                    height: '100%',\n                                                                                    width: `${Math.min(progress, 100)}%`,\n                                                                                    backgroundColor: totalHours === 30 ? '#10b981' : '#f59e0b',\n                                                                                    transition: 'width 0.3s ease'\n                                                                                }\n                                                                            })\n                                                                        }),\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                                            className: \"desktop-table\",\n                                                                            children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"table\", {\n                                                                                children: [\n                                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"thead\", {\n                                                                                        children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"tr\", {\n                                                                                            children: [\n                                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                                                    children: \"Hall Number\"\n                                                                                                }),\n                                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                                                    children: \"Subjects\"\n                                                                                                }),\n                                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                                                    children: \"Hours\"\n                                                                                                }),\n                                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                                                    children: \"Actions\"\n                                                                                                })\n                                                                                            ]\n                                                                                        })\n                                                                                    }),\n                                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"tbody\", {\n                                                                                        children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"tr\", {\n                                                                                            children: [\n                                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                                                    children: cls.hallNumber || '-'\n                                                                                                }),\n                                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                                                    children: classSubjects.length\n                                                                                                }),\n                                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                                                    children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"span\", {\n                                                                                                        className: `badge ${totalHours === 30 ? 'badge-success' : 'badge-danger'}`,\n                                                                                                        children: [\n                                                                                                            totalHours,\n                                                                                                            \"/30h\"\n                                                                                                        ]\n                                                                                                    })\n                                                                                                }),\n                                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                                                    children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                                                        className: \"action-buttons\",\n                                                                                                        children: [\n                                                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                                                                className: \"btn-icon btn-icon-primary\",\n                                                                                                                onClick: ()=>{\n                                                                                                                    editClass(cls);\n                                                                                                                    setShowAddClassForm(true);\n                                                                                                                },\n                                                                                                                title: \"Edit\",\n                                                                                                                children: \"\\u270F\\uFE0F\"\n                                                                                                            }),\n                                                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                                                                className: \"btn-icon btn-icon-danger\",\n                                                                                                                onClick: ()=>deleteClass(cls.id),\n                                                                                                                title: \"Delete\",\n                                                                                                                children: \"\\uD83D\\uDDD1\\uFE0F\"\n                                                                                                            })\n                                                                                                        ]\n                                                                                                    })\n                                                                                                })\n                                                                                            ]\n                                                                                        })\n                                                                                    })\n                                                                                ]\n                                                                            })\n                                                                        })\n                                                                    ]\n                                                                }, cls.id);\n                                                            })\n                                                        ]\n                                                    }, `dept-classes-${dept}`));\n                                            })(),\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                className: \"mobile-cards\",\n                                                children: (()=>{\n                                                    const sorted = [\n                                                        ...classes\n                                                    ].sort((a, b)=>(a.department || 'Unassigned').localeCompare(b.department || 'Unassigned') || a.name.localeCompare(b.name));\n                                                    let currentDept = null;\n                                                    const cards = [];\n                                                    sorted.forEach((cls, idx)=>{\n                                                        const dept = cls.department || 'Unassigned';\n                                                        const classSubjects = subjects.filter((s)=>s.className === cls.name);\n                                                        const totalHours = classSubjects.reduce((sum, s)=>sum + s.hoursPerWeek, 0);\n                                                        if (dept !== currentDept) {\n                                                            currentDept = dept;\n                                                            cards.push(/*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                                className: \"group-header\",\n                                                                style: {\n                                                                    fontWeight: 700,\n                                                                    margin: '10px 0'\n                                                                },\n                                                                children: dept\n                                                            }, `dept-mobile-${dept}`));\n                                                        }\n                                                        cards.push(/*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                            className: \"mobile-card\",\n                                                            children: [\n                                                                /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                    className: \"mobile-card-header\",\n                                                                    children: [\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                            className: \"mobile-card-title\",\n                                                                            children: cls.name\n                                                                        }),\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsxs)(\"span\", {\n                                                                            className: \"mobile-card-badge\",\n                                                                            children: [\n                                                                                \"#\",\n                                                                                idx + 1\n                                                                            ]\n                                                                        })\n                                                                    ]\n                                                                }),\n                                                                /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                    className: \"mobile-card-body\",\n                                                                    children: [\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                            className: \"mobile-card-row\",\n                                                                            children: [\n                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                    className: \"mobile-card-label\",\n                                                                                    children: \"Hall:\"\n                                                                                }),\n                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                    className: \"mobile-card-value\",\n                                                                                    children: cls.hallNumber || '-'\n                                                                                })\n                                                                            ]\n                                                                        }),\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                            className: \"mobile-card-row\",\n                                                                            children: [\n                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                    className: \"mobile-card-label\",\n                                                                                    children: \"Subjects:\"\n                                                                                }),\n                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                    className: \"mobile-card-value\",\n                                                                                    children: classSubjects.length\n                                                                                })\n                                                                            ]\n                                                                        }),\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                            className: \"mobile-card-row\",\n                                                                            children: [\n                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                    className: \"mobile-card-label\",\n                                                                                    children: \"Hours:\"\n                                                                                }),\n                                                                                /*#__PURE__*/ (0, $ayMG0.jsxs)(\"span\", {\n                                                                                    className: \"mobile-card-value\",\n                                                                                    children: [\n                                                                                        totalHours,\n                                                                                        \"/30h\"\n                                                                                    ]\n                                                                                })\n                                                                            ]\n                                                                        })\n                                                                    ]\n                                                                }),\n                                                                /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                    className: \"mobile-card-actions\",\n                                                                    children: [\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                            className: \"btn btn-primary btn-sm\",\n                                                                            onClick: ()=>{\n                                                                                editClass(cls);\n                                                                                setShowAddClassForm(true);\n                                                                            },\n                                                                            children: \"\\u270F\\uFE0F Edit\"\n                                                                        }),\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                            className: \"btn btn-danger btn-sm\",\n                                                                            onClick: ()=>deleteClass(cls.id),\n                                                                            children: \"\\uD83D\\uDDD1\\uFE0F Delete\"\n                                                                        })\n                                                                    ]\n                                                                })\n                                                            ]\n                                                        }, cls.id));\n                                                    });\n                                                    return cards;\n                                                })()\n                                            })\n                                        ]\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                        className: \"btn btn-success btn-sm\",\n                                        onClick: ()=>{\n                                            setShowAddClassForm(true);\n                                            setNewClass({\n                                                id: null,\n                                                name: '',\n                                                hallNumber: '',\n                                                department: ''\n                                            });\n                                        },\n                                        style: {\n                                            marginTop: '15px'\n                                        },\n                                        children: \"\\u2795 Add Class\"\n                                    })\n                                ]\n                            }),\n                            showAddClassForm && /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"card\",\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"h3\", {\n                                        children: newClass.id ? \"\\u270F\\uFE0F Edit Class\" : \"\\u2795 Add New Class\"\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                        className: \"grid-2\",\n                                        children: [\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"form-group\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"label\", {\n                                                        children: \"Class Name *\"\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"input\", {\n                                                        type: \"text\",\n                                                        value: newClass.name,\n                                                        onChange: (e)=>setNewClass({\n                                                                ...newClass,\n                                                                name: e.target.value.toUpperCase()\n                                                            }),\n                                                        placeholder: \"CS3A, EE2B\"\n                                                    })\n                                                ]\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"form-group\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"label\", {\n                                                        children: \"Hall Number (Optional)\"\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"input\", {\n                                                        type: \"text\",\n                                                        value: newClass.hallNumber,\n                                                        onChange: (e)=>setNewClass({\n                                                                ...newClass,\n                                                                hallNumber: e.target.value\n                                                            }),\n                                                        placeholder: \"Hall 101\"\n                                                    })\n                                                ]\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"form-group\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"label\", {\n                                                        children: \"Department\"\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"select\", {\n                                                        value: newClass.department,\n                                                        onChange: (e)=>setNewClass({\n                                                                ...newClass,\n                                                                department: e.target.value\n                                                            }),\n                                                        children: [\n                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"option\", {\n                                                                value: \"\",\n                                                                children: \"Unassigned\"\n                                                            }),\n                                                            departments.map((d)=>/*#__PURE__*/ (0, $ayMG0.jsx)(\"option\", {\n                                                                    value: d.name,\n                                                                    children: d.name\n                                                                }, d.id))\n                                                        ]\n                                                    })\n                                                ]\n                                            })\n                                        ]\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                        style: {\n                                            display: 'flex',\n                                            gap: '10px'\n                                        },\n                                        children: [\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                className: \"btn btn-primary\",\n                                                onClick: addClass,\n                                                children: newClass.id ? \"\\uD83D\\uDCBE Update Class\" : \"\\u2795 Add Class\"\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                className: \"btn btn-secondary\",\n                                                onClick: ()=>{\n                                                    setNewClass({\n                                                        name: '',\n                                                        hallNumber: '',\n                                                        department: ''\n                                                    });\n                                                    setShowAddClassForm(false);\n                                                },\n                                                children: \"\\u274C Cancel\"\n                                            })\n                                        ]\n                                    })\n                                ]\n                            })\n                        ]\n                    }),\n                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                        className: \"section\",\n                        children: [\n                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"section-header\",\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                        className: \"section-icon\",\n                                        children: \"\\uD83D\\uDC65\"\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"h2\", {\n                                        className: \"section-title\",\n                                        children: \"Manage Staff\"\n                                    })\n                                ]\n                            }),\n                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"card\",\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"h3\", {\n                                        children: [\n                                            \"Existing Staff (\",\n                                            teachers.length,\n                                            \")\"\n                                        ]\n                                    }),\n                                    teachers.length === 0 ? /*#__PURE__*/ (0, $ayMG0.jsx)(\"p\", {\n                                        style: {\n                                            color: '#64748b',\n                                            textAlign: 'center',\n                                            padding: '20px'\n                                        },\n                                        children: \"No staff added yet\"\n                                    }) : /*#__PURE__*/ (0, $ayMG0.jsxs)((0, $ayMG0.Fragment), {\n                                        children: [\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                className: \"desktop-table\",\n                                                children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"table\", {\n                                                    children: [\n                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"thead\", {\n                                                            children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"tr\", {\n                                                                children: [\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                        children: \"S.No\"\n                                                                    }),\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                        children: \"Name\"\n                                                                    }),\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                        children: \"Username\"\n                                                                    }),\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                        children: \"Free Periods\"\n                                                                    }),\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                        children: \"Actions\"\n                                                                    })\n                                                                ]\n                                                            })\n                                                        }),\n                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"tbody\", {\n                                                            children: teachers.map((s, idx)=>/*#__PURE__*/ (0, $ayMG0.jsxs)(\"tr\", {\n                                                                    children: [\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                            children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"span\", {\n                                                                                className: \"staff-badge\",\n                                                                                children: [\n                                                                                    \"S\",\n                                                                                    idx + 1\n                                                                                ]\n                                                                            })\n                                                                        }),\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                            children: /*#__PURE__*/ (0, $ayMG0.jsx)(\"strong\", {\n                                                                                children: s.name\n                                                                            })\n                                                                        }),\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                            children: s.username\n                                                                        }),\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                            children: s.freePeriodMode === 'manual' ? `Manual (${s.manualFreePeriods} free periods)` : 'Auto'\n                                                                        }),\n                                                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                            children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                                className: \"action-buttons\",\n                                                                                children: [\n                                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                                        className: \"btn-icon btn-icon-primary\",\n                                                                                        onClick: ()=>editStaff(s),\n                                                                                        title: \"Edit\",\n                                                                                        children: \"\\u270F\\uFE0F\"\n                                                                                    }),\n                                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                                        className: \"btn-icon btn-icon-danger\",\n                                                                                        onClick: ()=>deleteStaff(s.id),\n                                                                                        title: \"Delete\",\n                                                                                        children: \"\\uD83D\\uDDD1\\uFE0F\"\n                                                                                    })\n                                                                                ]\n                                                                            })\n                                                                        })\n                                                                    ]\n                                                                }, s.id))\n                                                        })\n                                                    ]\n                                                })\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                className: \"mobile-cards\",\n                                                children: teachers.map((s, idx)=>/*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                        className: \"mobile-card\",\n                                                        children: [\n                                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                className: \"mobile-card-header\",\n                                                                children: [\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                        className: \"mobile-card-title\",\n                                                                        children: s.name\n                                                                    }),\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"span\", {\n                                                                        className: \"mobile-card-badge\",\n                                                                        children: [\n                                                                            \"S\",\n                                                                            idx + 1\n                                                                        ]\n                                                                    })\n                                                                ]\n                                                            }),\n                                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                className: \"mobile-card-body\",\n                                                                children: [\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                        className: \"mobile-card-row\",\n                                                                        children: [\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                className: \"mobile-card-label\",\n                                                                                children: \"Username:\"\n                                                                            }),\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                className: \"mobile-card-value\",\n                                                                                children: s.username\n                                                                            })\n                                                                        ]\n                                                                    }),\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                        className: \"mobile-card-row\",\n                                                                        children: [\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                className: \"mobile-card-label\",\n                                                                                children: \"Free Periods:\"\n                                                                            }),\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                className: \"mobile-card-value\",\n                                                                                children: s.freePeriodMode === 'manual' ? `Manual (${s.manualFreePeriods} free periods)` : 'Auto'\n                                                                            })\n                                                                        ]\n                                                                    })\n                                                                ]\n                                                            }),\n                                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                className: \"mobile-card-actions\",\n                                                                children: [\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                        className: \"btn btn-primary btn-sm\",\n                                                                        onClick: ()=>editStaff(s),\n                                                                        children: \"\\u270F\\uFE0F Edit\"\n                                                                    }),\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                        className: \"btn btn-danger btn-sm\",\n                                                                        onClick: ()=>deleteStaff(s.id),\n                                                                        children: \"\\uD83D\\uDDD1\\uFE0F Delete\"\n                                                                    })\n                                                                ]\n                                                            })\n                                                        ]\n                                                    }, s.id))\n                                            })\n                                        ]\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                        className: \"btn btn-success btn-sm\",\n                                        onClick: ()=>{\n                                            setShowAddStaffForm(true);\n                                            resetStaffForm();\n                                        },\n                                        style: {\n                                            marginTop: '15px'\n                                        },\n                                        children: \"\\u2795 Add Staff\"\n                                    })\n                                ]\n                            }),\n                            showAddStaffForm && /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"card\",\n                                ref: staffFormRef,\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"h3\", {\n                                        children: newStaff.id ? \"\\u270F\\uFE0F Edit Staff\" : \"\\u2795 Add New Staff\"\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                        className: \"grid-2\",\n                                        children: [\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"form-group\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"label\", {\n                                                        children: \"Full Name *\"\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"input\", {\n                                                        type: \"text\",\n                                                        placeholder: \"Dr. John Doe\",\n                                                        value: newStaff.name,\n                                                        onChange: (e)=>setNewStaff({\n                                                                ...newStaff,\n                                                                name: e.target.value\n                                                            })\n                                                    })\n                                                ]\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"form-group\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"label\", {\n                                                        children: \"Username *\"\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"input\", {\n                                                        type: \"text\",\n                                                        placeholder: \"john\",\n                                                        value: newStaff.username,\n                                                        onChange: (e)=>setNewStaff({\n                                                                ...newStaff,\n                                                                username: e.target.value\n                                                            })\n                                                    })\n                                                ]\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"form-group\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"label\", {\n                                                        children: [\n                                                            newStaff.id ? 'New Password (Optional)' : 'Password',\n                                                            \" *\"\n                                                        ]\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"input\", {\n                                                        type: \"password\",\n                                                        placeholder: newStaff.id ? \"Leave blank to keep current\" : \"Enter password\",\n                                                        value: newStaff.password,\n                                                        onChange: (e)=>setNewStaff({\n                                                                ...newStaff,\n                                                                password: e.target.value\n                                                            })\n                                                    }),\n                                                    newStaff.id && /*#__PURE__*/ (0, $ayMG0.jsx)(\"small\", {\n                                                        style: {\n                                                            color: '#64748b',\n                                                            display: 'block',\n                                                            marginTop: '4px'\n                                                        },\n                                                        children: \"\\u2713 Staff can use new password immediately on next login\"\n                                                    })\n                                                ]\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"form-group\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"label\", {\n                                                        children: \"Free Period Mode\"\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"select\", {\n                                                        value: newStaff.freePeriodMode,\n                                                        onChange: (e)=>setNewStaff({\n                                                                ...newStaff,\n                                                                freePeriodMode: e.target.value\n                                                            }),\n                                                        children: [\n                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"option\", {\n                                                                value: \"auto\",\n                                                                children: \"Auto\"\n                                                            }),\n                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"option\", {\n                                                                value: \"manual\",\n                                                                children: \"Manual\"\n                                                            })\n                                                        ]\n                                                    })\n                                                ]\n                                            })\n                                        ]\n                                    }),\n                                    newStaff.freePeriodMode === 'manual' && /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                        className: \"form-group\",\n                                        children: [\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"label\", {\n                                                children: \"Free Periods per Week\"\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"input\", {\n                                                type: \"number\",\n                                                min: \"0\",\n                                                max: \"30\",\n                                                value: newStaff.manualFreePeriods,\n                                                onChange: (e)=>setNewStaff({\n                                                        ...newStaff,\n                                                        manualFreePeriods: parseInt(e.target.value) || 0\n                                                    })\n                                            })\n                                        ]\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                        className: \"button-group\",\n                                        children: [\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                className: \"btn btn-primary\",\n                                                onClick: addOrUpdateStaff,\n                                                children: newStaff.id ? \"\\uD83D\\uDCBE Save Changes\" : \"\\u2795 Add Staff\"\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                className: \"btn btn-secondary\",\n                                                onClick: ()=>{\n                                                    resetStaffForm();\n                                                    setShowAddStaffForm(false);\n                                                },\n                                                children: \"\\u274C Cancel\"\n                                            })\n                                        ]\n                                    })\n                                ]\n                            })\n                        ]\n                    }),\n                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                        className: \"section\",\n                        id: \"subject-section\",\n                        children: [\n                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"section-header\",\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                        className: \"section-icon\",\n                                        children: \"\\uD83D\\uDCD6\"\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"h2\", {\n                                        className: \"section-title\",\n                                        children: \"Manage Subjects\"\n                                    })\n                                ]\n                            }),\n                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"card\",\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"h3\", {\n                                        children: [\n                                            \"Existing Subjects (\",\n                                            subjects.length,\n                                            \")\"\n                                        ]\n                                    }),\n                                    subjects.length === 0 ? /*#__PURE__*/ (0, $ayMG0.jsx)(\"p\", {\n                                        style: {\n                                            color: '#64748b',\n                                            textAlign: 'center',\n                                            padding: '20px'\n                                        },\n                                        children: \"No subjects added yet\"\n                                    }) : /*#__PURE__*/ (0, $ayMG0.jsx)((0, $ayMG0.Fragment), {\n                                        children: classes.map((cls)=>{\n                                            const classSubjects = subjects.filter((s)=>s.className === cls.name);\n                                            if (classSubjects.length === 0) return null;\n                                            const totalHours = classSubjects.reduce((sum, s)=>sum + s.hoursPerWeek, 0);\n                                            const progress = totalHours / 30 * 100;\n                                            return /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                style: {\n                                                    marginBottom: '30px'\n                                                },\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                        style: {\n                                                            marginBottom: '8px',\n                                                            display: 'flex',\n                                                            alignItems: 'center',\n                                                            justifyContent: 'space-between',\n                                                            gap: '10px',\n                                                            color: '#1e293b',\n                                                            flexWrap: 'wrap'\n                                                        },\n                                                        children: [\n                                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"h4\", {\n                                                                style: {\n                                                                    margin: 0,\n                                                                    display: 'flex',\n                                                                    alignItems: 'center',\n                                                                    gap: '8px'\n                                                                },\n                                                                children: [\n                                                                    \"Class: \",\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"strong\", {\n                                                                        children: cls.name\n                                                                    })\n                                                                ]\n                                                            }),\n                                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                style: {\n                                                                    display: 'flex',\n                                                                    alignItems: 'center',\n                                                                    gap: '16px',\n                                                                    color: '#64748b',\n                                                                    fontWeight: 600\n                                                                },\n                                                                children: [\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"span\", {\n                                                                        children: [\n                                                                            totalHours,\n                                                                            \"/30 hours\"\n                                                                        ]\n                                                                    }),\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"span\", {\n                                                                        children: [\n                                                                            Math.max(30 - totalHours, 0),\n                                                                            \"h remaining\"\n                                                                        ]\n                                                                    })\n                                                                ]\n                                                            })\n                                                        ]\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                        style: {\n                                                            width: '100%',\n                                                            height: '8px',\n                                                            backgroundColor: '#e2e8f0',\n                                                            borderRadius: '4px',\n                                                            overflow: 'hidden',\n                                                            marginBottom: '15px'\n                                                        },\n                                                        children: /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                            style: {\n                                                                height: '100%',\n                                                                width: `${Math.min(progress, 100)}%`,\n                                                                backgroundColor: totalHours === 30 ? '#10b981' : '#f59e0b',\n                                                                transition: 'width 0.3s ease'\n                                                            }\n                                                        })\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                        className: \"desktop-table\",\n                                                        children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"table\", {\n                                                            children: [\n                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"thead\", {\n                                                                    children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"tr\", {\n                                                                        children: [\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                                children: \"Subject\"\n                                                                            }),\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                                children: \"Type\"\n                                                                            }),\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                                children: \"Hours\"\n                                                                            }),\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                                children: \"Teacher\"\n                                                                            }),\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                                children: \"Continuous\"\n                                                                            }),\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                                                                children: \"Actions\"\n                                                                            })\n                                                                        ]\n                                                                    })\n                                                                }),\n                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"tbody\", {\n                                                                    children: classSubjects.map((sub)=>/*#__PURE__*/ (0, $ayMG0.jsxs)(\"tr\", {\n                                                                            children: [\n                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                                    children: /*#__PURE__*/ (0, $ayMG0.jsx)(\"strong\", {\n                                                                                        children: sub.name\n                                                                                    })\n                                                                                }),\n                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                                    children: sub.subjectType\n                                                                                }),\n                                                                                /*#__PURE__*/ (0, $ayMG0.jsxs)(\"td\", {\n                                                                                    children: [\n                                                                                        sub.hoursPerWeek,\n                                                                                        \"h\"\n                                                                                    ]\n                                                                                }),\n                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                                    children: sub.teacher\n                                                                                }),\n                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                                    children: sub.isContinuous ? `Yes (${sub.blockSize}p)` : 'No'\n                                                                                }),\n                                                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                                                                    children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                                        className: \"action-buttons\",\n                                                                                        children: [\n                                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                                                className: \"btn-icon btn-icon-primary\",\n                                                                                                onClick: ()=>editSubject(sub),\n                                                                                                title: \"Edit\",\n                                                                                                children: \"\\u270F\\uFE0F\"\n                                                                                            }),\n                                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                                                className: \"btn-icon btn-icon-danger\",\n                                                                                                onClick: ()=>deleteSubject(sub.id),\n                                                                                                title: \"Delete\",\n                                                                                                children: \"\\uD83D\\uDDD1\\uFE0F\"\n                                                                                            })\n                                                                                        ]\n                                                                                    })\n                                                                                })\n                                                                            ]\n                                                                        }, sub.id))\n                                                                })\n                                                            ]\n                                                        })\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                        className: \"mobile-cards\",\n                                                        children: classSubjects.map((sub)=>/*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                className: \"mobile-card\",\n                                                                children: [\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                        className: \"mobile-card-header\",\n                                                                        children: [\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                className: \"mobile-card-title\",\n                                                                                children: sub.name\n                                                                            }),\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                className: \"mobile-card-badge\",\n                                                                                children: sub.subjectType\n                                                                            })\n                                                                        ]\n                                                                    }),\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                        className: \"mobile-card-body\",\n                                                                        children: [\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                                className: \"mobile-card-row\",\n                                                                                children: [\n                                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                        className: \"mobile-card-label\",\n                                                                                        children: \"Hours:\"\n                                                                                    }),\n                                                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"span\", {\n                                                                                        className: \"mobile-card-value\",\n                                                                                        children: [\n                                                                                            sub.hoursPerWeek,\n                                                                                            \"h\"\n                                                                                        ]\n                                                                                    })\n                                                                                ]\n                                                                            }),\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                                className: \"mobile-card-row\",\n                                                                                children: [\n                                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                        className: \"mobile-card-label\",\n                                                                                        children: \"Teacher:\"\n                                                                                    }),\n                                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                        className: \"mobile-card-value\",\n                                                                                        children: sub.teacher\n                                                                                    })\n                                                                                ]\n                                                                            }),\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                                className: \"mobile-card-row\",\n                                                                                children: [\n                                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                        className: \"mobile-card-label\",\n                                                                                        children: \"Continuous:\"\n                                                                                    }),\n                                                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                                                        className: \"mobile-card-value\",\n                                                                                        children: sub.isContinuous ? `Yes (${sub.blockSize}p)` : 'No'\n                                                                                    })\n                                                                                ]\n                                                                            })\n                                                                        ]\n                                                                    }),\n                                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                                        className: \"mobile-card-actions\",\n                                                                        children: [\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                                className: \"btn btn-primary btn-sm\",\n                                                                                onClick: ()=>editSubject(sub),\n                                                                                children: \"\\u270F\\uFE0F Edit\"\n                                                                            }),\n                                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                                                className: \"btn btn-danger btn-sm\",\n                                                                                onClick: ()=>deleteSubject(sub.id),\n                                                                                children: \"\\uD83D\\uDDD1\\uFE0F Delete\"\n                                                                            })\n                                                                        ]\n                                                                    })\n                                                                ]\n                                                            }, sub.id))\n                                                    })\n                                                ]\n                                            }, cls.id);\n                                        })\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                        className: \"btn btn-success btn-sm\",\n                                        onClick: ()=>{\n                                            setShowAddSubjectForm(true);\n                                            resetSubjectForm();\n                                        },\n                                        style: {\n                                            marginTop: '15px'\n                                        },\n                                        children: \"\\u2795 Add Subject\"\n                                    })\n                                ]\n                            }),\n                            showAddSubjectForm && /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"card\",\n                                ref: subjectFormRef,\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"h3\", {\n                                        children: newSubject.id ? \"\\u270F\\uFE0F Edit Subject\" : \"\\u2795 Add New Subject\"\n                                    }),\n                                    newSubject.className && /*#__PURE__*/ (0, $ayMG0.jsx)((0, $4XiCD.default), {\n                                        className: newSubject.className,\n                                        subjects: subjects\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                        className: \"grid-2\",\n                                        children: [\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"form-group\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"label\", {\n                                                        children: \"Select Class *\"\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"select\", {\n                                                        value: newSubject.className,\n                                                        onChange: (e)=>setNewSubject({\n                                                                ...newSubject,\n                                                                className: e.target.value\n                                                            }),\n                                                        children: [\n                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"option\", {\n                                                                value: \"\",\n                                                                children: \"-- Select Class --\"\n                                                            }),\n                                                            classes.map((cls)=>/*#__PURE__*/ (0, $ayMG0.jsx)(\"option\", {\n                                                                    value: cls.name,\n                                                                    children: cls.name\n                                                                }, cls.id))\n                                                        ]\n                                                    })\n                                                ]\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"form-group\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"label\", {\n                                                        children: \"Subject Name *\"\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"input\", {\n                                                        type: \"text\",\n                                                        value: newSubject.name,\n                                                        onChange: (e)=>setNewSubject({\n                                                                ...newSubject,\n                                                                name: e.target.value\n                                                            }),\n                                                        placeholder: \"DBMS, AI Lab, etc.\"\n                                                    })\n                                                ]\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"form-group\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"label\", {\n                                                        children: \"Subject Type *\"\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"select\", {\n                                                        value: newSubject.subjectType,\n                                                        onChange: (e)=>setNewSubject({\n                                                                ...newSubject,\n                                                                subjectType: e.target.value\n                                                            }),\n                                                        children: [\n                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"option\", {\n                                                                value: \"Core\",\n                                                                children: \"Core\"\n                                                            }),\n                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"option\", {\n                                                                value: \"Elective\",\n                                                                children: \"Elective\"\n                                                            }),\n                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"option\", {\n                                                                value: \"Lab\",\n                                                                children: \"Lab\"\n                                                            }),\n                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"option\", {\n                                                                value: \"Other\",\n                                                                children: \"Other\"\n                                                            })\n                                                        ]\n                                                    })\n                                                ]\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"form-group\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"label\", {\n                                                        children: \"Hours per Week *\"\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"input\", {\n                                                        type: \"number\",\n                                                        min: \"1\",\n                                                        max: \"30\",\n                                                        value: newSubject.hoursPerWeek,\n                                                        onChange: (e)=>setNewSubject({\n                                                                ...newSubject,\n                                                                hoursPerWeek: parseInt(e.target.value) || 6\n                                                            })\n                                                    })\n                                                ]\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"form-group\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"label\", {\n                                                        children: \"Teacher *\"\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"select\", {\n                                                        value: newSubject.teacher,\n                                                        onChange: (e)=>setNewSubject({\n                                                                ...newSubject,\n                                                                teacher: e.target.value\n                                                            }),\n                                                        children: [\n                                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"option\", {\n                                                                value: \"\",\n                                                                children: \"-- Select Teacher --\"\n                                                            }),\n                                                            teachers.map((t)=>/*#__PURE__*/ (0, $ayMG0.jsx)(\"option\", {\n                                                                    value: t.name,\n                                                                    children: t.name\n                                                                }, t.id))\n                                                        ]\n                                                    })\n                                                ]\n                                            })\n                                        ]\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                        className: \"checkbox-group\",\n                                        children: [\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"input\", {\n                                                type: \"checkbox\",\n                                                id: \"continuous\",\n                                                checked: newSubject.isContinuous,\n                                                onChange: (e)=>setNewSubject({\n                                                        ...newSubject,\n                                                        isContinuous: e.target.checked\n                                                    })\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"label\", {\n                                                htmlFor: \"continuous\",\n                                                style: {\n                                                    marginBottom: 0\n                                                },\n                                                children: \"Continuous Period (Lab)\"\n                                            })\n                                        ]\n                                    }),\n                                    newSubject.isContinuous && /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                        className: \"form-group\",\n                                        children: [\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"label\", {\n                                                children: \"Block Size\"\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"select\", {\n                                                value: newSubject.blockSize,\n                                                onChange: (e)=>setNewSubject({\n                                                        ...newSubject,\n                                                        blockSize: parseInt(e.target.value)\n                                                    }),\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"option\", {\n                                                        value: 2,\n                                                        children: \"2 Periods\"\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"option\", {\n                                                        value: 3,\n                                                        children: \"3 Periods\"\n                                                    })\n                                                ]\n                                            })\n                                        ]\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                        className: \"button-group\",\n                                        children: [\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                className: \"btn btn-primary\",\n                                                onClick: addOrUpdateSubject,\n                                                children: newSubject.id ? \"\\uD83D\\uDCBE Save Changes\" : \"\\u2795 Add Subject\"\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                className: \"btn btn-secondary\",\n                                                onClick: ()=>{\n                                                    resetSubjectForm();\n                                                    setShowAddSubjectForm(false);\n                                                },\n                                                children: \"\\u274C Cancel\"\n                                            })\n                                        ]\n                                    })\n                                ]\n                            })\n                        ]\n                    }),\n                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                        className: \"section\",\n                        children: [\n                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"section-header\",\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                        className: \"section-icon\",\n                                        children: \"\\u26A1\"\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"h2\", {\n                                        className: \"section-title\",\n                                        children: \"Generate Timetable\"\n                                    })\n                                ]\n                            }),\n                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"card\",\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"h3\", {\n                                        children: \"Ready to Generate\"\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                        className: \"stats-grid\",\n                                        children: [\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"stat-card stat-primary\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                        className: \"stat-label\",\n                                                        children: \"Classes\"\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                        className: \"stat-value\",\n                                                        children: classes.length\n                                                    })\n                                                ]\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"stat-card stat-success\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                        className: \"stat-label\",\n                                                        children: \"Teachers\"\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                        className: \"stat-value\",\n                                                        children: teachers.length\n                                                    })\n                                                ]\n                                            }),\n                                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"stat-card stat-warning\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                        className: \"stat-label\",\n                                                        children: \"Subjects\"\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                        className: \"stat-value\",\n                                                        children: subjects.length\n                                                    })\n                                                ]\n                                            })\n                                        ]\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                        className: \"btn btn-success btn-lg\",\n                                        onClick: generateTimetable,\n                                        disabled: loading,\n                                        children: loading ? \"\\u23F3 Generating...\" : \"\\u26A1 Generate Timetable\"\n                                    })\n                                ]\n                            })\n                        ]\n                    }),\n                    timetable && /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                        className: \"section\",\n                        id: \"view-timetables\",\n                        children: [\n                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"section-header\",\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                        className: \"section-icon\",\n                                        children: \"\\uD83D\\uDCCA\"\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"h2\", {\n                                        className: \"section-title\",\n                                        children: \"Generated Timetables\"\n                                    })\n                                ]\n                            }),\n                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"card\",\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"h3\", {\n                                        children: \"Time Tables\"\n                                    }),\n                                    (()=>{\n                                        const sorted = [\n                                            ...classes\n                                        ].sort((a, b)=>(a.department || 'Unassigned').localeCompare(b.department || 'Unassigned') || a.name.localeCompare(b.name));\n                                        const groups = {};\n                                        sorted.forEach((cls)=>{\n                                            const dept = cls.department || 'Unassigned';\n                                            if (!groups[dept]) groups[dept] = [];\n                                            groups[dept].push(/*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"timetable-container\",\n                                                id: `timetable-export-${cls.id}`,\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"h4\", {\n                                                        className: \"timetable-title\",\n                                                        children: cls.name\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                        className: \"timetable-scroll\",\n                                                        children: /*#__PURE__*/ (0, $ayMG0.jsx)((0, $e3nvF.default), {\n                                                            timetable: timetable.classTimetables,\n                                                            className: cls.name\n                                                        })\n                                                    }),\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                        className: \"timetable-actions no-print no-export\",\n                                                        children: /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                            className: \"btn btn-primary btn-sm\",\n                                                            onClick: ()=>(0, $gqAsg.exportToPDF)(`timetable-export-${cls.id}`, `${cls.name}_Timetable.pdf`, {\n                                                                    title: cls.name\n                                                                }),\n                                                            children: \"\\uD83D\\uDCC4 Download PDF\"\n                                                        })\n                                                    })\n                                                ]\n                                            }, cls.id));\n                                        });\n                                        return Object.keys(groups).filter((dept)=>groups[dept].length > 0).map((dept)=>/*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                                className: \"dept-group\",\n                                                children: [\n                                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                        className: \"dept-chip\",\n                                                        children: dept\n                                                    }),\n                                                    groups[dept].map((node)=>/*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                            className: \"class-box\",\n                                                            children: node\n                                                        }, node.key))\n                                                ]\n                                            }, `dept-block-${dept}`));\n                                    })()\n                                ]\n                            }),\n                            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                className: \"card\",\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"h3\", {\n                                        children: \"Staff-wise Timetables\"\n                                    }),\n                                    [\n                                        ...teachers\n                                    ].sort((a, b)=>a.name.localeCompare(b.name)).map((teacher)=>/*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                            className: \"timetable-container\",\n                                            id: `staff-timetable-export-${teacher.id}`,\n                                            children: [\n                                                /*#__PURE__*/ (0, $ayMG0.jsxs)(\"h4\", {\n                                                    className: \"timetable-title\",\n                                                    children: [\n                                                        \"Teacher: \",\n                                                        teacher.name\n                                                    ]\n                                                }),\n                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                    className: \"timetable-scroll\",\n                                                    children: /*#__PURE__*/ (0, $ayMG0.jsx)((0, $hyYFF.default), {\n                                                        timetable: timetable.staffTimetables,\n                                                        staffName: teacher.name\n                                                    })\n                                                }),\n                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                                    className: \"timetable-actions no-print no-export\",\n                                                    children: /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                                                        className: \"btn btn-primary btn-sm\",\n                                                        onClick: ()=>(0, $gqAsg.exportToPDF)(`staff-timetable-export-${teacher.id}`, `${teacher.name}_Timetable.pdf`, {\n                                                                title: `Staff Timetable \\u{2014} ${teacher.name}`\n                                                            }),\n                                                        children: \"\\uD83D\\uDCC4 Download PDF\"\n                                                    })\n                                                })\n                                            ]\n                                        }, teacher.id))\n                                ]\n                            })\n                        ]\n                    })\n                ]\n            }),\n            /*#__PURE__*/ (0, $ayMG0.jsx)((0, $2A5UH.ToastContainer), {\n                toasts: toasts,\n                onRemove: removeToast\n            })\n        ]\n    });\n}\n\n});\nparcelRegister(\"2A5UH\", function(module, exports) {\n\n$parcel$export(module.exports, \"ToastContainer\", () => $e0e81a01ed643521$export$f2815235e76a62b9);\n\nvar $ayMG0 = parcelRequire(\"ayMG0\");\nparcelRequire(\"acw62\");\nconst $e0e81a01ed643521$export$8d8dc7d5f743331b = ({ id: id, message: message, type: type, onRemove: onRemove, undoAction: undoAction })=>{\n    return /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n        style: {\n            padding: '12px 16px',\n            borderRadius: '8px',\n            marginBottom: '10px',\n            background: type === 'error' ? '#ff4444' : type === 'success' ? '#00C851' : '#ffbb33',\n            color: 'white',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'space-between',\n            boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\n            animation: 'slideIn 0.3s ease-out'\n        },\n        children: [\n            /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                children: message\n            }),\n            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                style: {\n                    display: 'flex',\n                    gap: '8px',\n                    marginLeft: '16px'\n                },\n                children: [\n                    undoAction && /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                        onClick: ()=>{\n                            if (typeof undoAction === 'function') undoAction();\n                            if (typeof onRemove === 'function') onRemove(id);\n                        },\n                        style: {\n                            background: 'white',\n                            color: type === 'success' ? '#00C851' : '#333',\n                            border: 'none',\n                            padding: '4px 12px',\n                            borderRadius: '4px',\n                            cursor: 'pointer',\n                            fontSize: '13px',\n                            fontWeight: '600'\n                        },\n                        children: \"UNDO\"\n                    }),\n                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"button\", {\n                        onClick: ()=>{\n                            if (typeof onRemove === 'function') onRemove(id);\n                        },\n                        style: {\n                            background: 'transparent',\n                            border: 'none',\n                            color: 'white',\n                            cursor: 'pointer',\n                            fontSize: '18px',\n                            padding: '0 4px',\n                            lineHeight: '1'\n                        },\n                        title: \"Close\",\n                        children: \"\\xd7\"\n                    })\n                ]\n            })\n        ]\n    });\n};\nconst $e0e81a01ed643521$export$f2815235e76a62b9 = ({ toasts: toasts, onRemove: onRemove })=>{\n    return /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n        style: {\n            position: 'fixed',\n            top: '20px',\n            right: '20px',\n            zIndex: 9999,\n            minWidth: '300px',\n            maxWidth: '500px'\n        },\n        children: toasts.map((toast)=>/*#__PURE__*/ (0, $ayMG0.jsx)($e0e81a01ed643521$export$8d8dc7d5f743331b, {\n                id: toast.id,\n                message: toast.message,\n                type: toast.type,\n                onRemove: onRemove,\n                undoAction: toast.undoAction\n            }, toast.id))\n    });\n};\n\n});\n\nparcelRegister(\"4XiCD\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", () => $511984d6a1a2608c$export$2e2bcd8739ae039);\n\nvar $ayMG0 = parcelRequire(\"ayMG0\");\nparcelRequire(\"acw62\");\nfunction $511984d6a1a2608c$export$2e2bcd8739ae039({ timetable: timetable, staff: staff }) {\n    if (!timetable || !timetable.staffTimetables) return null;\n    const teachers = staff.filter((s)=>s.role === 'staff');\n    return /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n        style: {\n            marginBottom: '30px'\n        },\n        children: [\n            /*#__PURE__*/ (0, $ayMG0.jsx)(\"h3\", {\n                style: {\n                    marginBottom: '15px'\n                },\n                children: \"\\uD83D\\uDCCA Staff Hours Summary\"\n            }),\n            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"table\", {\n                className: \"data-table\",\n                children: [\n                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"thead\", {\n                        children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"tr\", {\n                            children: [\n                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                    children: \"Staff Name\"\n                                }),\n                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                    children: \"Teaching Hours\"\n                                }),\n                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                    children: \"Free Periods\"\n                                }),\n                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                    children: \"Status\"\n                                })\n                            ]\n                        })\n                    }),\n                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"tbody\", {\n                        children: teachers.map((teacher)=>{\n                            const staffTT = timetable.staffTimetables[teacher.name];\n                            if (!staffTT) return /*#__PURE__*/ (0, $ayMG0.jsxs)(\"tr\", {\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                        children: teacher.name\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                        children: \"0\"\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                        children: \"30\"\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                        children: \"\\u26A0\\uFE0F Not Assigned\"\n                                    })\n                                ]\n                            }, teacher.id);\n                            // Count teaching hours\n                            let teachingHours = 0;\n                            let freePeriods = 0;\n                            staffTT.forEach((day)=>{\n                                day.forEach((period)=>{\n                                    if (period && period.type !== 'free') teachingHours++;\n                                    else freePeriods++;\n                                });\n                            });\n                            const status = teachingHours >= 24 ? \"\\u2705 Full Load\" : teachingHours >= 18 ? \"\\u26A1 Good\" : teachingHours > 0 ? \"\\u26A0\\uFE0F Low Load\" : \"\\u274C No Classes\";\n                            return /*#__PURE__*/ (0, $ayMG0.jsxs)(\"tr\", {\n                                children: [\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                        children: teacher.name\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"td\", {\n                                        children: [\n                                            teachingHours,\n                                            \"/30\"\n                                        ]\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsxs)(\"td\", {\n                                        children: [\n                                            freePeriods,\n                                            \"/30\"\n                                        ]\n                                    }),\n                                    /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                        children: status\n                                    })\n                                ]\n                            }, teacher.id);\n                        })\n                    })\n                ]\n            })\n        ]\n    });\n}\n\n});\n\nparcelRegister(\"e3nvF\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", () => $0e552b1b7a884617$export$2e2bcd8739ae039);\n\nvar $ayMG0 = parcelRequire(\"ayMG0\");\n\nvar $acw62 = parcelRequire(\"acw62\");\nconst $0e552b1b7a884617$var$DAYS = [\n    'Monday',\n    'Tuesday',\n    'Wednesday',\n    'Thursday',\n    'Friday'\n];\nfunction $0e552b1b7a884617$export$2e2bcd8739ae039({ timetable: timetable, className: className }) {\n    if (!timetable || !timetable[className]) return /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n        style: {\n            padding: '40px',\n            textAlign: 'center',\n            color: '#64748b'\n        },\n        children: \"No timetable available\"\n    });\n    const grid = timetable[className];\n    // Debug code\n    console.log('TimetableGrid - className:', className);\n    console.log('TimetableGrid - grid:', grid);\n    console.log('TimetableGrid - grid is array?', Array.isArray(grid));\n    // Safety check: if grid is not an array or not nested properly\n    if (!Array.isArray(grid) || grid.length === 0) return /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n        style: {\n            padding: '40px',\n            textAlign: 'center',\n            color: '#64748b'\n        },\n        children: \"Invalid timetable format\"\n    });\n    return /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n        id: \"timetable-export\",\n        className: \"timetable-grid\",\n        children: [\n            /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                className: \"timetable-header\",\n                children: \"Day/Period\"\n            }),\n            [\n                ...Array(6)\n            ].map((_, i)=>/*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                    className: \"timetable-header\",\n                    children: [\n                        \"P\",\n                        i + 1\n                    ]\n                }, i)),\n            $0e552b1b7a884617$var$DAYS.map((day, dayIndex)=>{\n                // Safety check for each day\n                if (!grid[dayIndex] || !Array.isArray(grid[dayIndex])) return null;\n                return /*#__PURE__*/ (0, $ayMG0.jsxs)((0, (/*@__PURE__*/$parcel$interopDefault($acw62))).Fragment, {\n                    children: [\n                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                            className: \"timetable-day\",\n                            children: day\n                        }),\n                        grid[dayIndex].map((slot, periodIndex)=>/*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                className: `timetable-cell subject-${slot && slot.type ? slot.type.toLowerCase() : 'free'}`,\n                                children: slot && slot.subject !== 'FREE' ? /*#__PURE__*/ (0, $ayMG0.jsxs)((0, $ayMG0.Fragment), {\n                                    children: [\n                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                            className: \"subject-name\",\n                                            children: slot.subject\n                                        }),\n                                        /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                            className: \"teacher-name\",\n                                            children: slot.teacher\n                                        })\n                                    ]\n                                }) : /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                    style: {\n                                        color: '#94a3b8'\n                                    },\n                                    children: \"FREE\"\n                                })\n                            }, periodIndex))\n                    ]\n                }, day);\n            })\n        ]\n    });\n}\n\n});\n\nparcelRegister(\"hyYFF\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", () => $81aa4954b90786d4$export$2e2bcd8739ae039);\n\nvar $ayMG0 = parcelRequire(\"ayMG0\");\nparcelRequire(\"acw62\");\nfunction $81aa4954b90786d4$export$2e2bcd8739ae039({ timetable: timetable, staffName: staffName }) {\n    const days = [\n        'Monday',\n        'Tuesday',\n        'Wednesday',\n        'Thursday',\n        'Friday'\n    ];\n    const periods = [\n        'P1',\n        'P2',\n        'P3',\n        'P4',\n        'P5',\n        'P6'\n    ];\n    const staffSchedule = timetable[staffName];\n    console.log('StaffTimetableGrid - Staff:', staffName);\n    console.log('StaffTimetableGrid - Available:', Object.keys(timetable));\n    if (!staffSchedule) return /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n        style: {\n            padding: '40px',\n            textAlign: 'center'\n        },\n        children: [\n            /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                style: {\n                    fontSize: '48px',\n                    marginBottom: '20px'\n                },\n                children: \"\\u26A0\\uFE0F\"\n            }),\n            /*#__PURE__*/ (0, $ayMG0.jsx)(\"h3\", {\n                children: \"No Timetable Found\"\n            }),\n            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"p\", {\n                style: {\n                    color: '#64748b'\n                },\n                children: [\n                    'No timetable for \"',\n                    staffName,\n                    '\"'\n                ]\n            }),\n            /*#__PURE__*/ (0, $ayMG0.jsxs)(\"p\", {\n                style: {\n                    color: '#64748b',\n                    fontSize: '14px'\n                },\n                children: [\n                    \"Available: \",\n                    Object.keys(timetable).join(', ')\n                ]\n            })\n        ]\n    });\n    return /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n        className: \"timetable-container\",\n        id: \"staff-timetable-export\",\n        children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"table\", {\n            className: \"timetable\",\n            children: [\n                /*#__PURE__*/ (0, $ayMG0.jsx)(\"thead\", {\n                    children: /*#__PURE__*/ (0, $ayMG0.jsxs)(\"tr\", {\n                        children: [\n                            /*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                className: \"day-header\",\n                                children: \"DAY/PERIOD\"\n                            }),\n                            periods.map((p)=>/*#__PURE__*/ (0, $ayMG0.jsx)(\"th\", {\n                                    className: \"period-header\",\n                                    children: p\n                                }, p))\n                        ]\n                    })\n                }),\n                /*#__PURE__*/ (0, $ayMG0.jsx)(\"tbody\", {\n                    children: days.map((day, dayIdx)=>/*#__PURE__*/ (0, $ayMG0.jsxs)(\"tr\", {\n                            children: [\n                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                    className: \"day-cell\",\n                                    children: day\n                                }),\n                                periods.map((period, periodIdx)=>{\n                                    const slot = staffSchedule[dayIdx]?.[periodIdx];\n                                    const isFree = !slot || slot.type === 'free' || slot.subject === 'FREE';\n                                    return /*#__PURE__*/ (0, $ayMG0.jsx)(\"td\", {\n                                        className: `period-cell ${isFree ? 'free-period' : 'class-period'}`,\n                                        children: isFree ? /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n                                            className: \"period-content free\",\n                                            children: /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                className: \"subject-name\",\n                                                children: \"FREE\"\n                                            })\n                                        }) : /*#__PURE__*/ (0, $ayMG0.jsxs)(\"div\", {\n                                            className: \"period-content\",\n                                            children: [\n                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                    className: \"subject-name\",\n                                                    children: slot.subject\n                                                }),\n                                                /*#__PURE__*/ (0, $ayMG0.jsx)(\"span\", {\n                                                    className: \"class-name\",\n                                                    children: slot.class\n                                                })\n                                            ]\n                                        })\n                                    }, period);\n                                })\n                            ]\n                        }, day))\n                })\n            ]\n        })\n    });\n}\n\n});\n\nparcelRegister(\"bU9CP\", function(module, exports) {\n\n$parcel$export(module.exports, \"TimetableGenerator\", () => $a77c14b5958cefc4$export$21295ca23168aa6a);\n/**\r\n * Timetable Generator - CLEAN VERSION 2025-12-04\r\n * NO TYPOS - PRODUCTION READY\r\n * Generates intelligent timetables based on defined rules\r\n */ class $a77c14b5958cefc4$export$21295ca23168aa6a {\n    constructor(classes, staff, subjects, options = {}){\n        this.classes = classes || [];\n        this.staff = staff || [];\n        this.subjects = subjects || [];\n        this.options = options || {};\n        // Output structures\n        this.classTimetables = {};\n        this.staffTimetables = {};\n        // Tracking structures\n        this.teacherBusySlots = {};\n        this.teacherWeeklyHours = {};\n        this.teacherDailyHours = {};\n        this.teacherExpectedWeeklyHours = {};\n        this.subjectPlacementTracker = {};\n        this.placements = [];\n        this.subjectPeriodUsage = {};\n        this.labStartPositions = {};\n        this.DAYS = [\n            'Monday',\n            'Tuesday',\n            'Wednesday',\n            'Thursday',\n            'Friday'\n        ];\n        this.PERIODS = 6;\n        this.TOTAL_WEEKLY_HOURS = 30;\n        this.dailyMaxPerSubject = typeof this.options.dailyMaxPerSubject === 'number' ? this.options.dailyMaxPerSubject : 2;\n        const seed = typeof this.options.seed === 'number' ? this.options.seed : 123456789;\n        this._rng = (()=>{\n            let a = seed >>> 0;\n            return ()=>{\n                a += 0x6D2B79F5;\n                let t = a;\n                t = Math.imul(t ^ t >>> 15, t | 1);\n                t ^= t + Math.imul(t ^ t >>> 7, t | 61);\n                return ((t ^ t >>> 14) >>> 0) / 4294967296;\n            };\n        })();\n    }\n    /**\r\n     * Validate input data before generation\r\n     */ validate() {\n        const errors = [];\n        if (!this.classes || this.classes.length === 0) errors.push('No classes added');\n        if (!this.staff || this.staff.filter((s)=>s.role === 'staff').length === 0) errors.push('No staff added');\n        if (!this.subjects || this.subjects.length === 0) errors.push('No subjects added');\n        if (errors.length > 0) return {\n            valid: false,\n            errors: errors\n        };\n        // Check if each class has exactly 30 hours per week\n        const classHours = {};\n        this.subjects.forEach((subject)=>{\n            if (subject && subject.className && subject.hoursPerWeek) classHours[subject.className] = (classHours[subject.className] || 0) + subject.hoursPerWeek;\n        });\n        this.classes.forEach((cls)=>{\n            if (cls && cls.name) {\n                const hours = classHours[cls.name] || 0;\n                if (hours !== this.TOTAL_WEEKLY_HOURS) errors.push(`Class ${cls.name} must have exactly ${this.TOTAL_WEEKLY_HOURS} hours (current: ${hours}).`);\n            }\n        });\n        if (errors.length > 0) return {\n            valid: false,\n            errors: errors\n        };\n        return {\n            valid: true,\n            warnings: []\n        };\n    }\n    /**\r\n     * Main generation method\r\n     */ generate() {\n        try {\n            console.log(\"\\uD83D\\uDE80 Starting intelligent timetable generation...\");\n            this._initialize();\n            // Generate timetable for each class\n            for (const cls of this.classes){\n                if (!cls || !cls.name) continue;\n                console.log(`\n\\u{1F4CB} Generating timetable for ${cls.name}`);\n                const success = this._generateClassTimetable(cls.name);\n                if (!success) return {\n                    success: false,\n                    error: `Failed to generate complete timetable for ${cls.name}`\n                };\n            }\n            // Generate staff timetables\n            this._generateStaffTimetables();\n            const warnings = [];\n            // Post-validate teacher weekly totals\n            Object.keys(this.teacherExpectedWeeklyHours).forEach((t)=>{\n                const expected = this.teacherExpectedWeeklyHours[t] || 0;\n                const actual = this.teacherWeeklyHours[t] || 0;\n                if (actual !== expected) warnings.push(`Teacher ${t} scheduled ${actual}/${expected} hours.`);\n            });\n            // Post-validate class filled hours\n            this.classes.forEach((cls)=>{\n                if (!cls || !cls.name) return;\n                let filled = 0;\n                this.DAYS.forEach((_, d)=>{\n                    const row = this.classTimetables[cls.name]?.[d] || [];\n                    row.forEach((s)=>{\n                        if (s) filled++;\n                    });\n                });\n                if (filled !== this.TOTAL_WEEKLY_HOURS) warnings.push(`Class ${cls.name} filled ${filled}/${this.TOTAL_WEEKLY_HOURS} periods.`);\n            });\n            console.log(\"\\n\\u2705 Timetable generation completed successfully\");\n            const diag = this._computeDiagnosticsAndScore();\n            return {\n                success: true,\n                classTimetables: this.classTimetables,\n                staffTimetables: this.staffTimetables,\n                placements: this.placements,\n                score: diag.score,\n                diagnostics: diag.diagnostics,\n                warnings: warnings\n            };\n        } catch (error) {\n            console.error(\"\\u274C Error generating timetable:\", error);\n            return {\n                success: false,\n                error: `Error: ${error.message || 'Unknown error'}`\n            };\n        }\n    }\n    _computeDiagnosticsAndScore() {\n        let violations = [];\n        let notes = [];\n        // Subject weekly hours\n        Object.keys(this.subjectPlacementTracker).forEach((k)=>{\n            const t = this.subjectPlacementTracker[k];\n            if (!t) return;\n            if (t.remaining !== 0) violations.push(`Subject ${k} remaining ${t.remaining}`);\n        });\n        // Daily max per subject\n        let sameSubjectExcesses = 0;\n        Object.keys(this.subjectPlacementTracker).forEach((k)=>{\n            const t = this.subjectPlacementTracker[k];\n            if (!t) return;\n            this.DAYS.forEach((d)=>{\n                const c = t.dailyCount[d] || 0;\n                if (c > this.dailyMaxPerSubject) sameSubjectExcesses += c - this.dailyMaxPerSubject;\n            });\n        });\n        // Labs at edges\n        let labsAtEdges = 0;\n        for (const p of this.placements){\n            if (p.type === 'lab') {\n                if (p.period === 1 || p.period === this.PERIODS) labsAtEdges++;\n            }\n        }\n        // Preferred spread\n        let insufficientSpread = 0;\n        const bySubject = {};\n        for (const p of this.placements){\n            const key = `${p.className}-${p.subject}`;\n            bySubject[key] = bySubject[key] || new Set();\n            bySubject[key].add(p.day);\n        }\n        this.subjects.forEach((s)=>{\n            if (!s || !s.name) return;\n            if ((s.hoursPerWeek || 0) >= 4) {\n                const key = `${s.className}-${s.name}`;\n                const usedDays = bySubject[key]?.size || 0;\n                if (usedDays < 3) insufficientSpread++;\n            }\n        });\n        // Teacher continuous periods over 3\n        let teacherOver3 = 0;\n        const teachers = Object.keys(this.staffTimetables);\n        teachers.forEach((t)=>{\n            const tt = this.staffTimetables[t];\n            if (!tt) return;\n            for(let d = 0; d < this.DAYS.length; d++){\n                let run = 0;\n                for(let p = 0; p < this.PERIODS; p++){\n                    const slot = tt[d][p];\n                    if (slot && slot.subject !== 'FREE') run++;\n                    else {\n                        if (run > 3) teacherOver3 += run - 3;\n                        run = 0;\n                    }\n                }\n                if (run > 3) teacherOver3 += run - 3;\n            }\n        });\n        let score = 1000;\n        score -= 500 * violations.length;\n        score -= 10 * sameSubjectExcesses;\n        score -= 5 * labsAtEdges;\n        score -= 2 * insufficientSpread;\n        score -= 1 * teacherOver3;\n        const diagnostics = {\n            violations: violations,\n            notes: notes\n        };\n        return {\n            score: score,\n            diagnostics: diagnostics\n        };\n    }\n    /**\r\n     * Initialize all data structures\r\n     */ _initialize() {\n        console.log(\"\\u2699\\uFE0F Initializing timetables...\");\n        // Initialize class timetables\n        this.classes.forEach((cls)=>{\n            if (cls && cls.name) this.classTimetables[cls.name] = this.DAYS.map(()=>Array(this.PERIODS).fill(null));\n        });\n        // Initialize teacher tracking\n        const staffMembers = this.staff.filter((s)=>s && s.role === 'staff');\n        staffMembers.forEach((teacher)=>{\n            if (teacher && teacher.name) {\n                this.teacherBusySlots[teacher.name] = {};\n                this.teacherWeeklyHours[teacher.name] = 0;\n                this.teacherDailyHours[teacher.name] = {};\n                this.DAYS.forEach((day)=>{\n                    this.teacherDailyHours[teacher.name][day] = 0;\n                });\n            }\n        });\n        // Compute expected weekly hours per teacher\n        this.teacherExpectedWeeklyHours = {};\n        this.subjects.forEach((subject)=>{\n            if (subject && subject.teacher && subject.hoursPerWeek) this.teacherExpectedWeeklyHours[subject.teacher] = (this.teacherExpectedWeeklyHours[subject.teacher] || 0) + subject.hoursPerWeek;\n        });\n    }\n    /**\r\n     * Generate timetable for a specific class\r\n     */ _generateClassTimetable(className) {\n        try {\n            const classSubjects = this.subjects.filter((s)=>s && s.className === className);\n            if (classSubjects.length === 0) {\n                console.warn(`No subjects found for ${className}`);\n                return true;\n            }\n            // Initialize subject tracking\n            classSubjects.forEach((subject)=>{\n                if (subject) {\n                    const key = `${className}-${subject.name}`;\n                    this.subjectPlacementTracker[key] = {\n                        placed: 0,\n                        remaining: subject.hoursPerWeek || 0,\n                        dailyCount: {},\n                        lastPlacedSlot: -1\n                    };\n                    this.DAYS.forEach((day)=>{\n                        this.subjectPlacementTracker[key].dailyCount[day] = 0;\n                    });\n                }\n            });\n            // Initialize usage trackers for anti-pattern rules\n            if (!this.subjectPeriodUsage[className]) this.subjectPeriodUsage[className] = {};\n            if (!this.labStartPositions[className]) this.labStartPositions[className] = {};\n            // Pre-place labs before theories\n            this._prePlaceLabs(className, classSubjects);\n            // Fill timetable slot by slot\n            for(let dayIdx = 0; dayIdx < this.DAYS.length; dayIdx++){\n                const day = this.DAYS[dayIdx];\n                console.log(`  \\u{1F4C5} ${day}:`);\n                for(let period = 0; period < this.PERIODS; period++){\n                    // Check if we're in the middle of a lab block\n                    if (period > 0) {\n                        const prevSlot = this.classTimetables[className][dayIdx][period - 1];\n                        if (prevSlot && prevSlot.isLabContinuation && prevSlot.blockRemaining > 0) {\n                            // Continue the lab block\n                            const subject = classSubjects.find((s)=>s.name === prevSlot.subject);\n                            if (subject) {\n                                this._placeSubject(className, dayIdx, period, subject, true, prevSlot.blockRemaining - 1);\n                                console.log(`    P${period + 1}: ${subject.name} (Lab continuation)`);\n                                continue;\n                            }\n                        }\n                    }\n                    // Find best subject for this slot\n                    const bestSubject = this._findBestSubject(className, dayIdx, period, classSubjects);\n                    if (bestSubject) {\n                        // Check if it's a lab and needs multiple periods\n                        if (bestSubject.isContinuous) {\n                            const blockSize = bestSubject.blockSize || 2;\n                            // Check if we have enough consecutive periods\n                            if (period + blockSize <= this.PERIODS) {\n                                // Check if all periods are free and teacher is available\n                                let canPlaceLab = true;\n                                for(let i = 0; i < blockSize; i++){\n                                    if (this.classTimetables[className][dayIdx][period + i] !== null) {\n                                        canPlaceLab = false;\n                                        break;\n                                    }\n                                    const slotKey = `${day}-P${period + 1 + i}`;\n                                    if (this.teacherBusySlots[bestSubject.teacher]?.[slotKey]) {\n                                        canPlaceLab = false;\n                                        break;\n                                    }\n                                    if (!this._isTeacherAvailable(bestSubject.teacher, dayIdx, period + i)) {\n                                        canPlaceLab = false;\n                                        break;\n                                    }\n                                }\n                                if (canPlaceLab) {\n                                    // Place the entire lab block\n                                    for(let i = 0; i < blockSize; i++)this._placeSubject(className, dayIdx, period + i, bestSubject, true, blockSize - i - 1);\n                                    console.log(`    P${period + 1}-P${period + blockSize}: ${bestSubject.name} (Lab block)`);\n                                    period += blockSize - 1; // Skip the periods we just filled\n                                    continue;\n                                } else console.log(`    P${period + 1}: Cannot place ${bestSubject.name} lab (not enough space or teacher busy)`);\n                            }\n                        } else {\n                            // Place theory subject\n                            this._placeSubject(className, dayIdx, period, bestSubject, false, 0);\n                            console.log(`    P${period + 1}: ${bestSubject.name}`);\n                        }\n                    } else console.log(`    P${period + 1}: No suitable subject found (will remain empty)`);\n                }\n            }\n            return true;\n        } catch (error) {\n            console.error(`\\u{274C} Error generating timetable for ${className}:`, error);\n            return false;\n        }\n    }\n    _prePlaceLabs(className, classSubjects) {\n        const labs = classSubjects.filter((s)=>s && s.isContinuous);\n        if (labs.length === 0) return;\n        const dayLabCount = {};\n        this.DAYS.forEach((d)=>{\n            dayLabCount[d] = 0;\n        });\n        const lastLabDay = {};\n        for (const subject of labs){\n            const blockSize = subject.blockSize || 2;\n            let remaining = subject.hoursPerWeek || 0;\n            const staffMember = this.staff.find((s)=>s.name === subject.teacher);\n            while(remaining >= blockSize){\n                let placed = false;\n                const choices = [];\n                for(let dayIdx = 0; dayIdx < this.DAYS.length; dayIdx++){\n                    const day = this.DAYS[dayIdx];\n                    for(let period = 0; period <= this.PERIODS - blockSize; period++){\n                        let canPlace = true;\n                        for(let i = 0; i < blockSize; i++){\n                            if (this.classTimetables[className][dayIdx][period + i] !== null) {\n                                canPlace = false;\n                                break;\n                            }\n                            const slotKey = `${day}-P${period + 1 + i}`;\n                            if (this.teacherBusySlots[subject.teacher]?.[slotKey]) {\n                                canPlace = false;\n                                break;\n                            }\n                            if (!this._isTeacherAvailable(subject.teacher, dayIdx, period + i)) {\n                                canPlace = false;\n                                break;\n                            }\n                        }\n                        if (canPlace) {\n                            let w = 100;\n                            if (period === 0 || period + blockSize - 1 === this.PERIODS - 1) w -= 25;\n                            if (dayLabCount[day] >= 1) w -= 30;\n                            if (lastLabDay[subject.name] !== undefined && Math.abs(dayIdx - lastLabDay[subject.name]) < 1) w -= 20;\n                            const teacherDaily = this.teacherDailyHours[subject.teacher]?.[this.DAYS[dayIdx]] || 0;\n                            if (teacherDaily >= 3) w -= 15;\n                            const startsUsed = this.labStartPositions[className][subject.name] || new Set();\n                            if (startsUsed.has(period)) continue; // avoid repeating same start block across days\n                            choices.push({\n                                dayIdx: dayIdx,\n                                period: period,\n                                weight: Math.max(1, w)\n                            });\n                        }\n                    }\n                }\n                if (choices.length > 0) {\n                    const pick = this._weightedPick(choices);\n                    for(let i = 0; i < blockSize; i++)this._placeSubject(className, pick.dayIdx, pick.period + i, subject, true, blockSize - i - 1);\n                    const day = this.DAYS[pick.dayIdx];\n                    dayLabCount[day] += 1;\n                    lastLabDay[subject.name] = pick.dayIdx;\n                    remaining -= blockSize;\n                    placed = true;\n                    const s = this.labStartPositions[className][subject.name] || new Set();\n                    s.add(pick.period);\n                    this.labStartPositions[className][subject.name] = s;\n                }\n                if (!placed) for(let dayIdx = 0; dayIdx < this.DAYS.length && !placed; dayIdx++){\n                    const day = this.DAYS[dayIdx];\n                    for(let period = 0; period <= this.PERIODS - blockSize; period++){\n                        let canPlace = true;\n                        for(let i = 0; i < blockSize; i++){\n                            if (this.classTimetables[className][dayIdx][period + i] !== null) {\n                                canPlace = false;\n                                break;\n                            }\n                            const slotKey = `${day}-P${period + 1 + i}`;\n                            if (this.teacherBusySlots[subject.teacher]?.[slotKey]) {\n                                canPlace = false;\n                                break;\n                            }\n                            if (!this._isTeacherAvailable(subject.teacher, dayIdx, period + i)) {\n                                canPlace = false;\n                                break;\n                            }\n                        }\n                        if (canPlace) {\n                            for(let i = 0; i < blockSize; i++)this._placeSubject(className, dayIdx, period + i, subject, true, blockSize - i - 1);\n                            dayLabCount[day] += 1;\n                            lastLabDay[subject.name] = dayIdx;\n                            remaining -= blockSize;\n                            placed = true;\n                            const s2 = this.labStartPositions[className][subject.name] || new Set();\n                            s2.add(period);\n                            this.labStartPositions[className][subject.name] = s2;\n                            break;\n                        }\n                    }\n                }\n                if (!placed) break;\n            }\n        }\n    }\n    /**\r\n     * Find the best subject to place in a given slot\r\n     */ _findBestSubject(className, dayIdx, period, classSubjects) {\n        const day = this.DAYS[dayIdx];\n        const slotKey = `${day}-P${period + 1}`;\n        const candidates = [];\n        for (const subject of classSubjects){\n            if (!subject || !subject.name) continue;\n            const trackingKey = `${className}-${subject.name}`;\n            const tracker = this.subjectPlacementTracker[trackingKey];\n            // Skip if no hours remaining\n            if (!tracker || tracker.remaining <= 0) continue;\n            // Check teacher availability (Rule: teacher not in two classes at once)\n            if (this.teacherBusySlots[subject.teacher]?.[slotKey]) continue;\n            if (!this._isTeacherAvailable(subject.teacher, dayIdx, period)) continue;\n            // Hard cap: do not exceed teacher's expected weekly hours\n            const expectedWeekly = this.teacherExpectedWeeklyHours[subject.teacher] || 0;\n            const currentWeekly = this.teacherWeeklyHours[subject.teacher] || 0;\n            if (expectedWeekly > 0 && currentWeekly >= expectedWeekly) continue;\n            let score = 100;\n            const reasons = [];\n            const dailyCount = tracker.dailyCount[day] || 0;\n            if (!subject.isContinuous) {\n                if (dailyCount >= this.dailyMaxPerSubject) continue;\n                else if (dailyCount === 1) {\n                    score -= 25;\n                    reasons.push('Second usage same day -25');\n                }\n            }\n            // Vertical pattern avoidance: limit same subject in the same period across days to 2\n            const usageMap = this.subjectPeriodUsage[className][subject.name] || {};\n            const usedCountSamePeriod = usageMap[period] || 0;\n            if (!subject.isContinuous) {\n                if (usedCountSamePeriod >= 2) continue;\n                else if (usedCountSamePeriod === 1) {\n                    score -= 20;\n                    reasons.push('Repeat same period across days -20');\n                } else {\n                    score += 10;\n                    reasons.push('Prefer unused period slot +10');\n                }\n            }\n            // Daily variety anti-pattern: avoid same 2/3 subject order across days\n            if (!subject.isContinuous) {\n                // Check pair\n                if (period >= 1) {\n                    const prevSubj = this.classTimetables[className][dayIdx][period - 1]?.subject || null;\n                    if (prevSubj) for(let d = 0; d < this.DAYS.length; d++){\n                        if (d === dayIdx) continue;\n                        const s1 = this.classTimetables[className][d]?.[period - 1]?.subject || null;\n                        const s2 = this.classTimetables[className][d]?.[period]?.subject || null;\n                        if (s1 === prevSubj && s2 === subject.name) {\n                            score -= 25;\n                            reasons.push('Avoid repeating pair order across days -25');\n                            break;\n                        }\n                    }\n                }\n                // Check triple\n                if (period >= 2) {\n                    const ps2 = this.classTimetables[className][dayIdx][period - 2]?.subject || null;\n                    const ps1 = this.classTimetables[className][dayIdx][period - 1]?.subject || null;\n                    if (ps2 && ps1) for(let d = 0; d < this.DAYS.length; d++){\n                        if (d === dayIdx) continue;\n                        const t0 = this.classTimetables[className][d]?.[period - 2]?.subject || null;\n                        const t1 = this.classTimetables[className][d]?.[period - 1]?.subject || null;\n                        const t2 = this.classTimetables[className][d]?.[period]?.subject || null;\n                        if (t0 === ps2 && t1 === ps1 && t2 === subject.name) {\n                            score -= 40;\n                            reasons.push('Avoid repeating triple order across days -40');\n                            break;\n                        }\n                    }\n                }\n            }\n            if (!subject.isContinuous && period >= 2) {\n                let continuousCount = 0;\n                for(let i = 1; i <= 2; i++){\n                    const prevSlot = this.classTimetables[className][dayIdx][period - i];\n                    if (prevSlot && prevSlot.subject === subject.name && !prevSlot.isLabContinuation) continuousCount++;\n                    else break;\n                }\n                if (continuousCount >= 2) continue;\n                else if (continuousCount === 1) {\n                    score -= 25;\n                    reasons.push('Avoid back-to-back theory -25');\n                }\n            }\n            if (!subject.isContinuous) {\n                if (period >= 1 && period <= 4) {\n                    score += 20;\n                    reasons.push('Middle period theory +20');\n                } else {\n                    score -= 25;\n                    reasons.push('Edge period theory -25');\n                }\n            }\n            // RULE: Labs prefer afternoon (period 3-5)\n            if (subject.isContinuous) {\n                const blockSize = subject.blockSize || 2;\n                // Check if lab can fit\n                if (period + blockSize > this.PERIODS) {\n                    score -= 1000;\n                    reasons.push('Lab cannot fit -1000');\n                } else {\n                    if (period >= 2) {\n                        score += 25;\n                        reasons.push('Lab in afternoon +25');\n                    }\n                    // RULE: Avoid last period for labs\n                    if (period + blockSize === this.PERIODS + 1) {\n                        score -= 20;\n                        reasons.push('Lab at last period -20');\n                    }\n                    // Count labs already placed today\n                    let labsToday = 0;\n                    for(let p = 0; p < period; p++){\n                        const slot = this.classTimetables[className][dayIdx][p];\n                        if (slot && slot.isLabContinuation && slot.blockRemaining === (slot.blockSize || 2) - 1) labsToday++;\n                    }\n                    // Prefer 1 lab per day; second only if necessary\n                    if (labsToday >= 1) {\n                        score -= 50;\n                        reasons.push('Second lab same day -50');\n                    }\n                }\n            }\n            // Weekly distribution preference: prefer unused days for the subject\n            if (!subject.isContinuous) {\n                const uniqueDaysUsed = this.DAYS.reduce((acc, d)=>acc + ((tracker.dailyCount[d] || 0) > 0 ? 1 : 0), 0);\n                if (tracker.dailyCount[day] === 0) {\n                    score += 15;\n                    reasons.push('Prefer spreading to new day +15');\n                }\n            }\n            // Daily diversity: prefer at least 3 different subjects per day\n            if (!subject.isContinuous) {\n                const existingSlots = this.classTimetables[className][dayIdx];\n                const distinctSubjects = new Set();\n                for(let p = 0; p < existingSlots.length; p++){\n                    const sl = existingSlots[p];\n                    if (sl && !sl.isLabContinuation) distinctSubjects.add(sl.subject);\n                }\n                const distinctCount = distinctSubjects.size;\n                if (distinctCount < 3) {\n                    if (distinctSubjects.has(subject.name)) {\n                        score -= 30;\n                        reasons.push('Improve daily mix -30');\n                    } else {\n                        score += 30;\n                        reasons.push('New subject improves mix +30');\n                    }\n                }\n            }\n            // Teacher dominance control per day\n            if (!subject.isContinuous) {\n                const teacherDaily = this.teacherDailyHours[subject.teacher]?.[day] || 0;\n                if (teacherDaily >= 3) {\n                    score -= 25;\n                    reasons.push('Teacher day dominance -25');\n                } else if (teacherDaily >= 2) {\n                    score -= 10;\n                    reasons.push('Teacher appearing often -10');\n                }\n            }\n            // Priority to subjects with more remaining hours\n            const remainingRatio = tracker.remaining / (subject.hoursPerWeek || 1);\n            score += remainingRatio * 20;\n            reasons.push(`Remaining priority +${Math.round(remainingRatio * 20)}`);\n            // Teacher free period rules\n            const staffMember = this.staff.find((s)=>s.name === subject.teacher);\n            if (staffMember) {\n                const dailyHours = this.teacherDailyHours[subject.teacher]?.[day] || 0;\n                if (staffMember.freePeriodMode === 'manual') {\n                    const maxDailyHours = this.PERIODS - (staffMember.manualFreePeriods || 0);\n                    if (dailyHours >= maxDailyHours) continue;\n                } else // Auto mode: try to leave at least 1 free period per day\n                if (dailyHours >= this.PERIODS - 1) {\n                    score -= 50;\n                    reasons.push('Auto: prefer leaving free period -50');\n                }\n            }\n            // Teacher load: avoid creating >3 consecutive teaching periods\n            const dayName = this.DAYS[dayIdx];\n            let prevRun = 0;\n            for(let p = period - 1; p >= 0; p--){\n                const keyPrev = `${dayName}-P${p + 1}`;\n                if (this.teacherBusySlots[subject.teacher]?.[keyPrev]) prevRun++;\n                else break;\n            }\n            let nextRun = 0;\n            for(let p = period + 1; p < this.PERIODS; p++){\n                const keyNext = `${dayName}-P${p + 1}`;\n                if (this.teacherBusySlots[subject.teacher]?.[keyNext]) nextRun++;\n                else break;\n            }\n            if (prevRun + 1 + nextRun > 3) {\n                score -= 40;\n                reasons.push('Avoid >3 consecutive teacher load -40');\n            }\n            candidates.push({\n                subject: subject,\n                score: score,\n                reasons: reasons\n            });\n        }\n        if (candidates.length > 0) {\n            const weighted = candidates.map((c)=>({\n                    item: c.subject,\n                    weight: Math.max(1, Math.round(c.score))\n                }));\n            const pick = this._weightedPick(weighted);\n            if (pick) return pick.item;\n        }\n        // Fallback: return any subject with remaining hours\n        const fallback = classSubjects.find((s)=>{\n            const key = `${className}-${s.name}`;\n            return s && this.subjectPlacementTracker[key]?.remaining > 0;\n        });\n        return fallback || null;\n    }\n    /**\r\n     * Place a subject in a specific slot\r\n     */ _placeSubject(className, dayIdx, period, subject, isLab, blockRemaining) {\n        if (!className || !subject || !subject.name || !subject.teacher) return;\n        const day = this.DAYS[dayIdx];\n        const slotKey = `${day}-P${period + 1}`;\n        const trackingKey = `${className}-${subject.name}`;\n        // Place in timetable\n        this.classTimetables[className][dayIdx][period] = {\n            subject: subject.name,\n            teacher: subject.teacher,\n            type: subject.subjectType || 'Core',\n            isLabContinuation: isLab,\n            blockRemaining: blockRemaining,\n            blockSize: subject.blockSize || 2\n        };\n        // Update tracking only once per lab block\n        if (!isLab || blockRemaining === (subject.blockSize || 2) - 1) {\n            const tracker = this.subjectPlacementTracker[trackingKey];\n            if (tracker) {\n                if (isLab) {\n                    tracker.remaining -= subject.blockSize || 2;\n                    tracker.placed += subject.blockSize || 2;\n                } else {\n                    tracker.remaining -= 1;\n                    tracker.placed += 1;\n                }\n                tracker.dailyCount[day] = (tracker.dailyCount[day] || 0) + 1;\n                tracker.lastPlacedSlot = dayIdx * this.PERIODS + period;\n            }\n        }\n        // Ensure teacher tracking is initialized\n        if (!this.teacherBusySlots[subject.teacher]) this.teacherBusySlots[subject.teacher] = {};\n        if (!this.teacherWeeklyHours[subject.teacher]) this.teacherWeeklyHours[subject.teacher] = 0;\n        if (!this.teacherDailyHours[subject.teacher]) {\n            this.teacherDailyHours[subject.teacher] = {};\n            this.DAYS.forEach((d)=>{\n                if (this.teacherDailyHours[subject.teacher][d] === undefined) this.teacherDailyHours[subject.teacher][d] = 0;\n            });\n        }\n        // Mark teacher as busy\n        this.teacherBusySlots[subject.teacher][slotKey] = true;\n        // Update teacher hours\n        this.teacherWeeklyHours[subject.teacher] = (this.teacherWeeklyHours[subject.teacher] || 0) + 1;\n        this.teacherDailyHours[subject.teacher][day] = (this.teacherDailyHours[subject.teacher][day] || 0) + 1;\n        // Update subject period usage for vertical anti-pattern control\n        const subjUsage = this.subjectPeriodUsage[className][subject.name] || {};\n        subjUsage[period] = (subjUsage[period] || 0) + 1;\n        this.subjectPeriodUsage[className][subject.name] = subjUsage;\n        this.placements.push({\n            day: this.DAYS[dayIdx],\n            period: period + 1,\n            subject: subject.name,\n            teacher: subject.teacher,\n            type: isLab ? 'lab' : 'theory',\n            className: className\n        });\n    }\n    _isTeacherAvailable(teacherName, dayIdx, period) {\n        const day = this.DAYS[dayIdx];\n        const staffMember = this.staff.find((s)=>s.name === teacherName);\n        const availability = staffMember?.availability;\n        if (!availability) return true;\n        const daySlots = availability[day];\n        if (!Array.isArray(daySlots)) return true;\n        const v = daySlots[period];\n        if (v === undefined) return true;\n        return !!v;\n    }\n    _weightedPick(items) {\n        let total = 0;\n        for (const it of items)total += it.weight;\n        if (total <= 0) return null;\n        let r = this._rng() * total;\n        for (const it of items){\n            if (r < it.weight) return it;\n            r -= it.weight;\n        }\n        return items[items.length - 1] || null;\n    }\n    /**\r\n     * Generate staff timetables from class timetables\r\n     */ _generateStaffTimetables() {\n        console.log(\"\\n\\uD83D\\uDC68\\u200D\\uD83C\\uDFEB Generating staff timetables...\");\n        const staffMembers = this.staff.filter((s)=>s && s.role === 'staff');\n        // Initialize staff timetables with FREE periods\n        staffMembers.forEach((teacher)=>{\n            if (teacher && teacher.name) this.staffTimetables[teacher.name] = this.DAYS.map(()=>Array(this.PERIODS).fill(null).map(()=>({\n                        subject: 'FREE',\n                        class: '-',\n                        type: 'free'\n                    })));\n        });\n        // Fill in scheduled periods from class timetables\n        this.classes.forEach((cls)=>{\n            if (!cls || !cls.name || !this.classTimetables[cls.name]) return;\n            this.DAYS.forEach((day, dayIdx)=>{\n                const daySchedule = this.classTimetables[cls.name][dayIdx];\n                if (!daySchedule) return;\n                daySchedule.forEach((slot, period)=>{\n                    if (slot && slot.teacher && this.staffTimetables[slot.teacher]) this.staffTimetables[slot.teacher][dayIdx][period] = {\n                        subject: slot.subject,\n                        class: cls.name,\n                        type: slot.type\n                    };\n                });\n            });\n        });\n        console.log(\"\\u2705 Staff timetables generated\");\n    }\n}\n\n});\n\n\n\n//# sourceMappingURL=AdminDashboard.a14ccb47.js.map\n","import { useState, useEffect, useRef } from 'react';\nimport AnimatedBackground from './AnimatedBackground';\nimport { ToastContainer } from './Toast';\nimport HoursTracker from './HoursTracker';\nimport TimetableGrid from './timetableGrid';\nimport StaffTimetableGrid from './StaffTimetableGrid';\nimport { exportToPDF } from '../utils/pdfUtils';\nimport { TimetableGenerator } from '../utils/timetableGenerator';\n\nimport { auth, db } from '../utils/firebase';\nimport { createUserWithEmailAndPassword, updatePassword, signInWithEmailAndPassword } from 'firebase/auth';\nimport {\n    collection,\n    addDoc,\n    getDocs,\n    deleteDoc,\n    updateDoc,\n    doc,\n    setDoc,\n} from 'firebase/firestore';\n\n\nexport default function AdminDashboard({ user, onLogout }) {\n    const [classes, setClasses] = useState([]);\n    const [departments, setDepartments] = useState([]);\n    const [staff, setStaff] = useState([]);\n    const [subjects, setSubjects] = useState([]);\n    const [timetable, setTimetable] = useState(null);\n    const [toasts, setToasts] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [showAddStaffForm, setShowAddStaffForm] = useState(false);\n    const [showAddSubjectForm, setShowAddSubjectForm] = useState(false);\n    const [showAddDepartmentForm, setShowAddDepartmentForm] = useState(false);\n    const [showAddClassForm, setShowAddClassForm] = useState(false);\n\n    // Refs for scrolling\n    const staffFormRef = useRef(null);\n    const subjectFormRef = useRef(null);\n\n    // Form Models\n    const [newClass, setNewClass] = useState({ name: '', hallNumber: '', department: '' });\n    const [newStaff, setNewStaff] = useState({\n        id: null,\n        name: '',\n        username: '',\n        password: '',\n        freePeriodMode: 'auto',\n        manualFreePeriods: 0\n    });\n    const [newSubject, setNewSubject] = useState({\n        id: null,\n        className: '',\n        name: '',\n        subjectType: 'Core',\n        hoursPerWeek: 6,\n        isContinuous: false,\n        blockSize: 2,\n        teacher: ''\n    });\n\n    const [newDepartment, setNewDepartment] = useState({ id: null, name: '' });\n\n    const teachers = staff.filter(s => s.role === \"staff\");\n\n    const showToast = (message, type, duration = 3000, undoAction = null) => {\n        const newToast = { message, type, id: Date.now(), undoAction };\n        setToasts(prev => [...prev, newToast]);\n        setTimeout(() => removeToast(newToast.id), duration);\n    };\n\n    const removeToast = (id) => {\n        setToasts(prev => prev.filter(t => t.id !== id));\n    };\n\n    const convertFlatToNested = (flatTimetable) => {\n        if (!flatTimetable) return null;\n\n        const nested = {};\n\n        Object.keys(flatTimetable).forEach(key => {\n            const slots = flatTimetable[key];\n\n            if (Array.isArray(slots) && slots.length > 0 && Array.isArray(slots[0])) {\n                nested[key] = slots;\n            } else if (Array.isArray(slots)) {\n                const days = [[], [], [], [], []];\n\n                slots.forEach(slot => {\n                    if (slot && typeof slot.day === 'number' && typeof slot.period === 'number') {\n                        if (!days[slot.day]) days[slot.day] = [];\n                        days[slot.day][slot.period] = {\n                            subject: slot.subject,\n                            teacher: slot.teacher,\n                            class: slot.class,\n                            type: slot.type\n                        };\n                    }\n                });\n\n                days.forEach((day, idx) => {\n                    if (!days[idx]) days[idx] = [];\n                    for (let p = 0; p < 6; p++) {\n                        if (!days[idx][p]) {\n                            days[idx][p] = slots[0]?.class !== undefined \n                                ? { subject: 'FREE', class: '-', type: 'free' }\n                                : null;\n                        }\n                    }\n                });\n\n                nested[key] = days;\n            }\n        });\n\n        return nested;\n    };\n\n    const fetchData = async () => {\n        setLoading(true);\n\n        try {\n            const [cls, st, sb, tt, dp] = await Promise.all([\n                getDocs(collection(db, 'classes')),\n                getDocs(collection(db, 'staff')),\n                getDocs(collection(db, 'subjects')),\n                getDocs(collection(db, 'timetable')),\n                getDocs(collection(db, 'departments'))\n            ]);\n\n            setClasses(cls.docs.map(doc => ({ id: doc.id, ...doc.data() })));\n            setStaff(st.docs.map(doc => ({ id: doc.id, ...doc.data() })));\n            setSubjects(sb.docs.map(doc => ({ id: doc.id, ...doc.data() })));\n            setDepartments(dp.docs.map(doc => ({ id: doc.id, ...doc.data() })));\n\n            if (!tt.empty) {\n                const ttData = tt.docs[0].data();\n                const convertedData = {\n                    classTimetables: convertFlatToNested(ttData.classTimetables),\n                    staffTimetables: convertFlatToNested(ttData.staffTimetables)\n                };\n                setTimetable(convertedData);\n            }\n        } catch (error) {\n            showToast(' Error loading data: ' + error.message, 'error');\n            console.error(error);\n        }\n\n        setLoading(false);\n    };\n\n    useEffect(() => {\n        fetchData();\n    }, []);\n\n    // ==================== UNDO HANDLER ====================\n  \n\n// Undo handler: correctly restore by document idno duplicates!\n// ==================== UNDO HANDLER ====================\n  const restoreFromUndo = async (undoItem) => {\n    try {\n      if (undoItem.type === 'class') {\n        const { id, ...classData } = undoItem.data;\n        await setDoc(doc(db, 'classes', id), classData);\n      } else if (undoItem.type === 'staff') {\n        const { id, ...staffData } = undoItem.data;\n        await setDoc(doc(db, 'staff', id), staffData);\n        if (undoItem.data.firebaseUid) {\n          await setDoc(doc(db, 'users', undoItem.data.firebaseUid), {\n            name: undoItem.data.name,\n            username: undoItem.data.username,\n            role: 'staff'\n          });\n        }\n      } else if (undoItem.type === 'subject') {\n        const { id, ...subjectData } = undoItem.data;\n        await setDoc(doc(db, 'subjects', id), subjectData);\n      }\n      await fetchData(); // reload UI\n      showToast(' Data restored!', 'success');\n    } catch (error) {\n      console.error('Restore error:', error);\n      showToast(' Restore failed: ' + error.message, 'error');\n    }\n    };\n\n\n\n    // ==================== CLASS CRUD ====================\n    const addClass = async () => {\n        if (!newClass.name) return showToast(\"Enter class name\", \"error\");\n        if (classes.find(c => c.name === newClass.name && !newClass.id))\n            return showToast(\"Class already exists\", \"error\");\n\n        try {\n            if (newClass.id) {\n                await updateDoc(doc(db, 'classes', newClass.id), { \n                    name: newClass.name, \n                    hallNumber: newClass.hallNumber,\n                    department: newClass.department || ''\n                });\n                setClasses(classes.map(c => c.id === newClass.id ? { id: newClass.id, ...newClass } : c));\n                showToast(\" Class updated!\", \"success\");\n            } else {\n                const docRef = await addDoc(collection(db, 'classes'), { \n                    name: newClass.name, \n                    hallNumber: newClass.hallNumber || '',\n                    department: newClass.department || ''\n                });\n                setClasses([...classes, { id: docRef.id, name: newClass.name, hallNumber: newClass.hallNumber || '', department: newClass.department || '' }]);\n                showToast(\" Class added!\", \"success\");\n            }\n            setNewClass({ name: '', hallNumber: '', department: '' });\n        } catch (error) {\n            showToast(\" Operation failed\", \"error\");\n        }\n    };\n\n    const editClass = (cls) => {\n        setNewClass({ id: cls.id, name: cls.name, hallNumber: cls.hallNumber || '', department: cls.department || '' });\n        window.scrollTo({ top: 0, behavior: 'smooth' });\n    };\n\n    const addOrUpdateDepartment = async () => {\n        if (!newDepartment.name.trim()) return showToast(\"Enter department name\", \"error\");\n        try {\n            if (newDepartment.id) {\n                await updateDoc(doc(db, 'departments', newDepartment.id), { name: newDepartment.name });\n                setDepartments(departments.map(d => d.id === newDepartment.id ? { ...d, name: newDepartment.name } : d));\n                showToast(\" Department updated!\", \"success\");\n            } else {\n                const ref = await addDoc(collection(db, 'departments'), { name: newDepartment.name });\n                setDepartments([...departments, { id: ref.id, name: newDepartment.name }]);\n                showToast(\" Department added!\", \"success\");\n            }\n            setNewDepartment({ id: null, name: '' });\n        } catch (error) {\n            showToast(\" Operation failed\", \"error\");\n        }\n    };\n\n    const editDepartment = (dept) => {\n        setNewDepartment({ id: dept.id, name: dept.name });\n        window.scrollTo({ top: 0, behavior: 'smooth' });\n    };\n\n    const deleteDepartment = async (id) => {\n        if (!window.confirm(\"Delete this department?\")) return;\n        try {\n            await deleteDoc(doc(db, 'departments', id));\n            setDepartments(departments.filter(d => d.id !== id));\n            showToast(\" Department deleted\", \"success\");\n        } catch (error) {\n            showToast(\" Failed to delete\", \"error\");\n        }\n    };\n\n// ==================== CLASS CRUD ====================\n  const deleteClass = async (id) => {\n    if (!window.confirm(\"Delete this class?\")) return;\n    try {\n      const classToDelete = classes.find(c => c.id === id);\n      if (!classToDelete) return;\n      const undoItem = { type: 'class', data: { ...classToDelete } };\n      await deleteDoc(doc(db, 'classes', id));\n      setClasses(classes.filter(c => c.id !== id));\n      showToast(\n        ` Class deleted`,\n        'success',\n        5000,\n        () => restoreFromUndo(undoItem)\n      );\n    } catch (error) {\n      console.error('Delete error:', error);\n      showToast(\" Failed to delete\", \"error\");\n    }\n  };\n\n    // ==================== STAFF CRUD ====================\n    const addOrUpdateStaff = async () => {\n        if (!newStaff.name || !newStaff.username)\n            return showToast(\"Fill all required fields\", \"error\");\n\n        try {\n            if (newStaff.id) {\n                // Editing existing staff\n                const staffToUpdate = staff.find(s => s.id === newStaff.id);\n                const { password, ...updateData } = newStaff;\n                \n                // Update Firestore staff document with name, freePeriodMode, manualFreePeriods\n                const firestoreUpdateData = {\n                    name: updateData.name,\n                    freePeriodMode: updateData.freePeriodMode,\n                    manualFreePeriods: updateData.manualFreePeriods\n                };\n                \n                // Include username if it changed\n                if (staffToUpdate.username !== updateData.username) {\n                    firestoreUpdateData.username = updateData.username;\n                }\n                \n                await updateDoc(doc(db, 'staff', newStaff.id), firestoreUpdateData);\n                \n                // Update users collection with new data\n                if (staffToUpdate.firebaseUid) {\n                    await updateDoc(doc(db, 'users', staffToUpdate.firebaseUid), {\n                        name: newStaff.name,\n                        username: newStaff.username,\n                        role: 'staff'\n                    });\n                }\n                \n                // Handle password change if provided\n                if (password && password.trim()) {\n                    await updateDoc(doc(db, 'staff', newStaff.id), {\n                        tempPassword: password,\n                        passwordLastChanged: new Date().toISOString(),\n                        needsPasswordChange: true\n                    });\n                    showToast(\" Temporary password set. Share it with staff.\", \"success\");\n                } else {\n                    showToast(\" Staff updated!\", \"success\");\n                }\n                \n                setStaff(staff.map(s => s.id === newStaff.id ? { ...s, ...firestoreUpdateData } : s));\n                resetStaffForm();\n                setShowAddStaffForm(false);\n                return;\n            }\n\n            // Adding new staff\n            if (!newStaff.password) return showToast(\"Password required\", \"error\");\n\n            const email = `${newStaff.username}@timetable.com`;\n            const userCredential = await createUserWithEmailAndPassword(auth, email, newStaff.password);\n            const uid = userCredential.user.uid;\n\n            const staffData = {\n                name: newStaff.name,\n                username: newStaff.username,\n                freePeriodMode: newStaff.freePeriodMode,\n                manualFreePeriods: newStaff.manualFreePeriods,\n                role: \"staff\",\n                firebaseUid: uid,\n            };\n\n            const docRef = await addDoc(collection(db, 'staff'), staffData);\n            await setDoc(doc(db, 'users', uid), {\n                name: newStaff.name,\n                username: newStaff.username,\n                role: 'staff'\n            });\n\n            setStaff([...staff, { id: docRef.id, ...staffData }]);\n            resetStaffForm();\n            setShowAddStaffForm(false);\n            showToast(\" Staff added!\", \"success\");\n\n        } catch (error) {\n            showToast(\" Operation failed: \" + error.message, \"error\");\n            console.error(error);\n        }\n    };\n\n    const editStaff = (staffMember) => {\n        setNewStaff({ ...staffMember, password: '' });\n        setShowAddStaffForm(true);\n        setTimeout(() => {\n            staffFormRef.current?.scrollIntoView({ behavior: 'smooth', block: 'center' });\n        }, 100);\n    };\n\n    const resetStaffForm = () => {\n        setNewStaff({ \n            id: null, \n            name: '', \n            username: '', \n            password: '', \n            freePeriodMode: 'auto', \n            manualFreePeriods: 0 \n        });\n    };\n\nconst deleteStaff = async (id) => {\n    if (!window.confirm(\"Delete this staff member?\")) return;\n    try {\n      const staffToDelete = staff.find(s => s.id === id);\n      if (!staffToDelete) return;\n      const undoItem = { type: 'staff', data: { ...staffToDelete } };\n      await deleteDoc(doc(db, 'staff', id));\n      if (staffToDelete.firebaseUid) {\n        await deleteDoc(doc(db, 'users', staffToDelete.firebaseUid));\n      }\n      setStaff(staff.filter(x => x.id !== id));\n      showToast(\n        ' Staff deleted',\n        'success',\n        5000,\n        () => restoreFromUndo(undoItem)\n      );\n    } catch (error) {\n      console.error('Delete staff error:', error);\n      showToast(' Failed to delete', 'error');\n    }\n  };\n\n\n    // ==================== SUBJECT CRUD ====================\n    const addOrUpdateSubject = async () => {\n        if (!newSubject.className || !newSubject.name || !newSubject.teacher)\n            return showToast(\"Fill all required fields\", \"error\");\n\n        try {\n            const subjectData = {\n                className: newSubject.className,\n                name: newSubject.name,\n                subjectType: newSubject.subjectType,\n                hoursPerWeek: newSubject.hoursPerWeek,\n                isContinuous: newSubject.isContinuous,\n                blockSize: newSubject.blockSize,\n                teacher: newSubject.teacher\n            };\n\n            if (newSubject.id) {\n                await updateDoc(doc(db, 'subjects', newSubject.id), subjectData);\n                setSubjects(subjects.map(s => s.id === newSubject.id ? { id: newSubject.id, ...subjectData } : s));\n                showToast(\" Subject updated!\", \"success\");\n            } else {\n                const docRef = await addDoc(collection(db, 'subjects'), subjectData);\n                setSubjects([...subjects, { id: docRef.id, ...subjectData }]);\n                showToast(\" Subject added!\", \"success\");\n            }\n            resetSubjectForm();\n            setShowAddSubjectForm(false);\n        } catch (error) {\n            showToast(\" Operation failed\", \"error\");\n            console.error(error);\n        }\n    };\n\n    const editSubject = (subject) => {\n        setNewSubject({\n            id: subject.id,\n            className: subject.className,\n            name: subject.name,\n            subjectType: subject.subjectType,\n            hoursPerWeek: subject.hoursPerWeek,\n            isContinuous: subject.isContinuous || false,\n            blockSize: subject.blockSize || 2,\n            teacher: subject.teacher\n        });\n        setShowAddSubjectForm(true);\n        setTimeout(() => {\n            subjectFormRef.current?.scrollIntoView({ behavior: 'smooth', block: 'center' });\n        }, 100);\n    };\n\n    const resetSubjectForm = () => {\n        setNewSubject({ \n            id: null, \n            className: '', \n            name: '', \n            subjectType: 'Core', \n            hoursPerWeek: 6, \n            isContinuous: false, \n            blockSize: 2, \n            teacher: '' \n        });\n    };\n\n  const deleteSubject = async (id) => {\n    if (!window.confirm(\"Delete this subject?\")) return;\n    try {\n      const subjectToDelete = subjects.find(s => s.id === id);\n      if (!subjectToDelete) return;\n      const undoItem = { type: 'subject', data: { ...subjectToDelete } };\n      await deleteDoc(doc(db, 'subjects', id));\n      setSubjects(subjects.filter(s => s.id !== id));\n      showToast(\n        ' Subject deleted',\n        'success',\n        5000,\n        () => restoreFromUndo(undoItem)\n      );\n    } catch (error) {\n      console.error('Delete subject error:', error);\n      showToast(' Failed to delete', 'error');\n    }\n  };\n\n\n\n    // ==================== TIMETABLE GENERATION ====================\n    const generateTimetable = async () => {\n        setLoading(true);\n\n        try {\n            const generator = new TimetableGenerator(classes, staff.filter(s => s.role === 'staff'), subjects);\n            const validation = generator.validate();\n\n            if (!validation.valid) {\n                showToast(' Validation: ' + validation.errors[0], 'error');\n                setLoading(false);\n                return;\n            }\n\n            const result = generator.generate();\n\n            if (result.success) {\n                const serializableClassTimetables = {};\n                const serializableStaffTimetables = {};\n\n                Object.keys(result.classTimetables).forEach(className => {\n                    serializableClassTimetables[className] = result.classTimetables[className].map((day, dayIndex) => {\n                        return day.map((period, periodIndex) => ({\n                            day: dayIndex,\n                            period: periodIndex,\n                            subject: period?.subject || null,\n                            teacher: period?.teacher || null,\n                            type: period?.type || null\n                        }));\n                    }).flat();\n                });\n\n                Object.keys(result.staffTimetables).forEach(staffName => {\n                    serializableStaffTimetables[staffName] = result.staffTimetables[staffName].map((day, dayIndex) => {\n                        return day.map((period, periodIndex) => ({\n                            day: dayIndex,\n                            period: periodIndex,\n                            subject: period?.subject || null,\n                            class: period?.class || null,\n                            type: period?.type || null\n                        }));\n                    }).flat();\n                });\n\n                const timetableData = {\n                    classTimetables: serializableClassTimetables,\n                    staffTimetables: serializableStaffTimetables,\n                    generatedAt: new Date().toISOString()\n                };\n\n                const ttRef = collection(db, 'timetable');\n                const existing = await getDocs(ttRef);\n\n                if (!existing.empty) {\n                    await updateDoc(doc(db, 'timetable', existing.docs[0].id), timetableData);\n                } else {\n                    await addDoc(ttRef, timetableData);\n                }\n\n                const teacherList = staff.filter(s => s.role === 'staff');\n                for (const teacher of teacherList) {\n                    const staffTT = serializableStaffTimetables[teacher.name];\n                    if (staffTT) {\n                        await setDoc(doc(db, 'staffTimetables', teacher.id), {\n                            staffName: teacher.name,\n                            timetable: staffTT,\n                            generatedAt: new Date().toISOString()\n                        });\n                    }\n                }\n\n                const displayClassTimetables = {};\n                Object.keys(serializableClassTimetables).forEach(className => {\n                    const days = [[], [], [], [], []];\n                    serializableClassTimetables[className].forEach(slot => {\n                        if (!days[slot.day]) days[slot.day] = [];\n                        days[slot.day][slot.period] = {\n                            subject: slot.subject,\n                            teacher: slot.teacher,\n                            type: slot.type\n                        };\n                    });\n                    days.forEach((day, idx) => {\n                        if (!days[idx]) days[idx] = [];\n                        for (let p = 0; p < 6; p++) {\n                            if (!days[idx][p]) days[idx][p] = null;\n                        }\n                    });\n                    displayClassTimetables[className] = days;\n                });\n\n                const displayStaffTimetables = {};\n                Object.keys(serializableStaffTimetables).forEach(staffName => {\n                    const days = [[], [], [], [], []];\n                    serializableStaffTimetables[staffName].forEach(slot => {\n                        if (!days[slot.day]) days[slot.day] = [];\n                        days[slot.day][slot.period] = {\n                            subject: slot.subject,\n                            class: slot.class,\n                            type: slot.type\n                        };\n                    });\n                    days.forEach((day, idx) => {\n                        if (!days[idx]) days[idx] = [];\n                        for (let p = 0; p < 6; p++) {\n                            if (!days[idx][p]) {\n                                days[idx][p] = { subject: 'FREE', class: '-', type: 'free' };\n                            }\n                        }\n                    });\n                    displayStaffTimetables[staffName] = days;\n                });\n\n                setTimetable({\n                    classTimetables: displayClassTimetables,\n                    staffTimetables: displayStaffTimetables\n                });\n\n                showToast(' Timetable generated & saved!', 'success');\n\n                setTimeout(() => {\n                    document.getElementById('view-timetables')?.scrollIntoView({ behavior: 'smooth' });\n                }, 1000);\n            } else {\n                showToast(' Failed: ' + result.error, 'error');\n            }\n        } catch (error) {\n            showToast(' Error: ' + error.message, 'error');\n            console.error(error);\n        }\n\n        setLoading(false);\n    };\n\n    if (loading) {\n        return (\n            <>\n                <AnimatedBackground />\n                <div style={{\n                    display: 'flex',\n                    flexDirection: 'column',\n                    justifyContent: 'center',\n                    alignItems: 'center',\n                    height: '100vh',\n                    color: 'white',\n                    fontSize: '24px',\n                    gap: '20px'\n                }}>\n                    <div className=\"spinner\"></div>\n                    <div>Loading...</div>\n                </div>\n            </>\n        );\n    }\n\nreturn (\n  <>\n    <AnimatedBackground />\n\n    {/* Global wrapper - DO NOT close this early */}\n    <div className=\"min-h-screen relative z-10 text-white\">\n\n      {/* HEADER */}\n                <div className=\"header-content\">\n                    <h1> Admin Dashboard</h1>\n                    <div className=\"header-actions\">\n                        <button className=\"btn btn-danger btn-sm\" onClick={onLogout}>\n                            Logout\n                        </button>\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"content\">\n                {/* ==================== DEPARTMENTS SECTION ==================== */}\n                <div className=\"section\">\n                    <div className=\"section-header\">\n                        <span className=\"section-icon\"></span>\n                        <h2 className=\"section-title\">Manage Departments</h2>\n                    </div>\n\n                    <div className=\"card\">\n                        <h3>Existing Departments ({departments.length})</h3>\n                        {departments.length === 0 ? (\n                            <p style={{color: '#64748b', textAlign: 'center', padding: '20px'}}>\n                                No departments added yet\n                            </p>\n                        ) : (\n                            <>\n                                <div className=\"desktop-table\">\n                                    <table>\n                                        <thead>\n                                            <tr>\n                                                <th>#</th>\n                                                <th>Department</th>\n                                                <th>Classes</th>\n                                                <th>Actions</th>\n                                            </tr>\n                                        </thead>\n                                        <tbody>\n                                            {departments.map((d, idx) => {\n                                                const classCount = classes.filter(c => (c.department || '') === d.name).length;\n                                                return (\n                                                    <tr key={d.id}>\n                                                        <td>{idx + 1}</td>\n                                                        <td><strong>{d.name}</strong></td>\n                                                        <td>{classCount}</td>\n                                                        <td>\n                                                            <div className=\"action-buttons\">\n                                                                <button className=\"btn-icon btn-icon-primary\" onClick={() => { editDepartment(d); setShowAddDepartmentForm(true); }} title=\"Edit\"></button>\n                                                                <button className=\"btn-icon btn-icon-danger\" onClick={() => deleteDepartment(d.id)} title=\"Delete\"></button>\n                                                            </div>\n                                                        </td>\n                                                    </tr>\n                                                );\n                                            })}\n                                        </tbody>\n                                    </table>\n                                </div>\n\n                                <div className=\"mobile-cards\">\n                                    {departments.map((d, idx) => {\n                                        const classCount = classes.filter(c => (c.department || '') === d.name).length;\n                                        return (\n                                            <div key={d.id} className=\"mobile-card\">\n                                                <div className=\"mobile-card-header\">\n                                                    <span className=\"mobile-card-title\">{d.name}</span>\n                                                    <span className=\"mobile-card-badge\">#{idx + 1}</span>\n                                                </div>\n                                                <div className=\"mobile-card-body\">\n                                                    <div className=\"mobile-card-row\">\n                                                        <span className=\"mobile-card-label\">Classes:</span>\n                                                        <span className=\"mobile-card-value\">{classCount}</span>\n                                                    </div>\n                                                </div>\n                                                <div className=\"mobile-card-actions\">\n                                                    <button className=\"btn btn-primary btn-sm\" onClick={() => { editDepartment(d); setShowAddDepartmentForm(true); }}> Edit</button>\n                                                    <button className=\"btn btn-danger btn-sm\" onClick={() => deleteDepartment(d.id)}> Delete</button>\n                                                </div>\n                                            </div>\n                                        );\n                                    })}\n                                </div>\n                            </>\n                        )}\n                        <button \n                            className=\"btn btn-success btn-sm\" \n                            onClick={() => setShowAddDepartmentForm(true)}\n                            style={{marginTop: '15px'}}\n                        >\n                             Add Department\n                        </button>\n                    </div>\n\n                    {showAddDepartmentForm && (\n                        <div className=\"card\">\n                            <h3>{newDepartment.id ? ' Edit Department' : ' Add New Department'}</h3>\n                            <div className=\"grid-2\">\n                                <div className=\"form-group\">\n                                    <label>Department Name *</label>\n                                    <input type=\"text\" value={newDepartment.name} onChange={e => setNewDepartment({ ...newDepartment, name: e.target.value })} placeholder=\"Computer Science\" />\n                                </div>\n                            </div>\n                            <div style={{display: 'flex', gap: '10px'}}>\n                                <button className=\"btn btn-primary\" onClick={addOrUpdateDepartment}>{newDepartment.id ? ' Save Changes' : ' Add Department'}</button>\n                                <button className=\"btn btn-secondary\" onClick={() => { setNewDepartment({ id: null, name: '' }); setShowAddDepartmentForm(false); }}> Cancel</button>\n                            </div>\n                        </div>\n                    )}\n                </div>\n\n                {/* ==================== CLASSES SECTION ==================== */}\n                <div className=\"section\">\n                    <div className=\"section-header\">\n                        <span className=\"section-icon\"></span>\n                        <h2 className=\"section-title\">Manage Classes</h2>\n                    </div>\n\n                    {/* EXISTING CLASSES - FIRST */}\n                    <div className=\"card\">\n                        <h3>Existing Classes ({classes.length})</h3>\n                        {classes.length === 0 ? (\n                            <p style={{color: '#64748b', textAlign: 'center', padding: '20px'}}>\n                                No classes added yet\n                            </p>\n                        ) : (\n                            <>\n                                {(() => {\n                                    const sorted = [...classes].sort((a, b) => (a.department || 'Unassigned').localeCompare(b.department || 'Unassigned') || a.name.localeCompare(b.name));\n                                    const groups = {};\n                                    sorted.forEach(cls => {\n                                        const dept = cls.department || 'Unassigned';\n                                        if (!groups[dept]) groups[dept] = [];\n                                        groups[dept].push(cls);\n                                    });\n                                    return Object.keys(groups).filter(d => groups[d].length > 0).map(dept => (\n                                        <div key={`dept-classes-${dept}`} className=\"dept-group\">\n                                            <div className=\"dept-chip\">{dept}</div>\n                                            {groups[dept].map((cls, idx) => {\n                                                const classSubjects = subjects.filter(s => s.className === cls.name);\n                                                const totalHours = classSubjects.reduce((sum, s) => sum + s.hoursPerWeek, 0);\n                                                const progress = (totalHours / 30) * 100;\n                                                return (\n                                                    <div key={cls.id} className=\"class-box\">\n                                                        <div style={{\n                                                            marginBottom: '8px',\n                                                            display: 'flex',\n                                                            alignItems: 'center',\n                                                            justifyContent: 'space-between',\n                                                            gap: '10px',\n                                                            color: '#1e293b',\n                                                            flexWrap: 'wrap'\n                                                        }}>\n                                                            <h4 style={{ margin: 0, display: 'flex', alignItems: 'center', gap: '8px' }}>\n                                                                Class: <strong>{cls.name}</strong>\n                                                            </h4>\n                                                            <div style={{ display: 'flex', alignItems: 'center', gap: '16px', color: '#64748b', fontWeight: 600 }}>\n                                                                <span>{totalHours}/30 hours</span>\n                                                                <span>{Math.max(30 - totalHours, 0)}h remaining</span>\n                                                            </div>\n                                                        </div>\n                                                        <div style={{\n                                                            width: '100%',\n                                                            height: '8px',\n                                                            backgroundColor: '#e2e8f0',\n                                                            borderRadius: '4px',\n                                                            overflow: 'hidden',\n                                                            marginBottom: '15px'\n                                                        }}>\n                                                            <div style={{\n                                                                height: '100%',\n                                                                width: `${Math.min(progress, 100)}%`,\n                                                                backgroundColor: totalHours === 30 ? '#10b981' : '#f59e0b',\n                                                                transition: 'width 0.3s ease'\n                                                            }}></div>\n                                                        </div>\n                                                        <div className=\"desktop-table\">\n                                                            <table>\n                                                                <thead>\n                                                                    <tr>\n                                                                        <th>Hall Number</th>\n                                                                        <th>Subjects</th>\n                                                                        <th>Hours</th>\n                                                                        <th>Actions</th>\n                                                                    </tr>\n                                                                </thead>\n                                                                <tbody>\n                                                                    <tr>\n                                                                        <td>{cls.hallNumber || '-'}</td>\n                                                                        <td>{classSubjects.length}</td>\n                                                                        <td>\n                                                                            <span className={`badge ${totalHours === 30 ? 'badge-success' : 'badge-danger'}`}>{totalHours}/30h</span>\n                                                                        </td>\n                                                                        <td>\n                                                                            <div className=\"action-buttons\">\n                                                                                <button className=\"btn-icon btn-icon-primary\" onClick={() => { editClass(cls); setShowAddClassForm(true); }} title=\"Edit\"></button>\n                                                                                <button className=\"btn-icon btn-icon-danger\" onClick={() => deleteClass(cls.id)} title=\"Delete\"></button>\n                                                                            </div>\n                                                                        </td>\n                                                                    </tr>\n                                                                </tbody>\n                                                            </table>\n                                                        </div>\n                                                    </div>\n                                                );\n                                            })}\n                                        </div>\n                                    ));\n                                })()}\n\n                                <div className=\"mobile-cards\">\n                                    {(() => {\n                                        const sorted = [...classes].sort((a, b) => (a.department || 'Unassigned').localeCompare(b.department || 'Unassigned') || a.name.localeCompare(b.name));\n                                        let currentDept = null;\n                                        const cards = [];\n                                        sorted.forEach((cls, idx) => {\n                                            const dept = cls.department || 'Unassigned';\n                                            const classSubjects = subjects.filter(s => s.className === cls.name);\n                                            const totalHours = classSubjects.reduce((sum, s) => sum + s.hoursPerWeek, 0);\n                                            if (dept !== currentDept) {\n                                                currentDept = dept;\n                                                cards.push(<div key={`dept-mobile-${dept}`} className=\"group-header\" style={{ fontWeight: 700, margin: '10px 0' }}>{dept}</div>);\n                                            }\n                                            cards.push(\n                                                <div key={cls.id} className=\"mobile-card\">\n                                                    <div className=\"mobile-card-header\">\n                                                        <span className=\"mobile-card-title\">{cls.name}</span>\n                                                        <span className=\"mobile-card-badge\">#{idx + 1}</span>\n                                                    </div>\n                                                    <div className=\"mobile-card-body\">\n                                                        \n                                                        <div className=\"mobile-card-row\">\n                                                            <span className=\"mobile-card-label\">Hall:</span>\n                                                            <span className=\"mobile-card-value\">{cls.hallNumber || '-'}</span>\n                                                        </div>\n                                                        <div className=\"mobile-card-row\">\n                                                            <span className=\"mobile-card-label\">Subjects:</span>\n                                                            <span className=\"mobile-card-value\">{classSubjects.length}</span>\n                                                        </div>\n                                                        <div className=\"mobile-card-row\">\n                                                            <span className=\"mobile-card-label\">Hours:</span>\n                                                            <span className=\"mobile-card-value\">{totalHours}/30h</span>\n                                                        </div>\n                                                    </div>\n                                                    <div className=\"mobile-card-actions\">\n                                                        <button className=\"btn btn-primary btn-sm\" onClick={() => { editClass(cls); setShowAddClassForm(true); }}> Edit</button>\n                                                        <button className=\"btn btn-danger btn-sm\" onClick={() => deleteClass(cls.id)}> Delete</button>\n                                                    </div>\n                                                </div>\n                                            );\n                                        });\n                                        return cards;\n                                    })()}\n                                </div>\n                            </>\n                        )}\n                        <button \n                            className=\"btn btn-success btn-sm\" \n                            onClick={() => { setShowAddClassForm(true); setNewClass({ id: null, name: '', hallNumber: '', department: '' }); }}\n                            style={{marginTop: '15px'}}\n                        >\n                             Add Class\n                        </button>\n                    </div>\n\n                    {/* ADD/EDIT CLASS - SECOND (COLLAPSIBLE) */}\n                    {showAddClassForm && (\n                    <div className=\"card\">\n                        <h3>{newClass.id ? ' Edit Class' : ' Add New Class'}</h3>\n                        <div className=\"grid-2\">\n                            <div className=\"form-group\">\n                                <label>Class Name *</label>\n                                <input\n                                    type=\"text\"\n                                    value={newClass.name}\n                                    onChange={e => setNewClass({ ...newClass, name: e.target.value.toUpperCase() })}\n                                    placeholder=\"CS3A, EE2B\"\n                                />\n                            </div>\n                            <div className=\"form-group\">\n                                <label>Hall Number (Optional)</label>\n                                <input\n                                    type=\"text\"\n                                    value={newClass.hallNumber}\n                                    onChange={e => setNewClass({ ...newClass, hallNumber: e.target.value })}\n                                    placeholder=\"Hall 101\"\n                                />\n                            </div>\n                            <div className=\"form-group\">\n                                <label>Department</label>\n                                <select value={newClass.department} onChange={e => setNewClass({ ...newClass, department: e.target.value })}>\n                                    <option value=\"\">Unassigned</option>\n                                    {departments.map(d => (\n                                        <option key={d.id} value={d.name}>{d.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n                        <div style={{display: 'flex', gap: '10px'}}>\n                            <button className=\"btn btn-primary\" onClick={addClass}>\n                                {newClass.id ? ' Update Class' : ' Add Class'}\n                            </button>\n                            <button className=\"btn btn-secondary\" onClick={() => { setNewClass({ name: '', hallNumber: '', department: '' }); setShowAddClassForm(false); }}>\n                                 Cancel\n                            </button>\n                        </div>\n                    </div>\n                    )}\n                </div>\n\n                {/* ==================== STAFF SECTION ==================== */}\n                <div className=\"section\">\n                    <div className=\"section-header\">\n                        <span className=\"section-icon\"></span>\n                        <h2 className=\"section-title\">Manage Staff</h2>\n                    </div>\n\n                    {/* EXISTING STAFF - FIRST */}\n                    <div className=\"card\">\n                        <h3>Existing Staff ({teachers.length})</h3>\n                        {teachers.length === 0 ? (\n                            <p style={{color: '#64748b', textAlign: 'center', padding: '20px'}}>\n                                No staff added yet\n                            </p>\n                        ) : (\n                            <>\n                                <div className=\"desktop-table\">\n                                    <table>\n                                        <thead>\n                                            <tr>\n                                                <th>S.No</th>\n                                                <th>Name</th>\n                                                <th>Username</th>\n                                                <th>Free Periods</th>\n                                                <th>Actions</th>\n                                            </tr>\n                                        </thead>\n                                        <tbody>\n                                            {teachers.map((s, idx) => (\n                                                <tr key={s.id}>\n                                                    <td><span className=\"staff-badge\">S{idx + 1}</span></td>\n                                                    <td><strong>{s.name}</strong></td>\n                                                    <td>{s.username}</td>\n                                                    <td>\n                                                        {s.freePeriodMode === 'manual' \n                                                            ? `Manual (${s.manualFreePeriods} free periods)` \n                                                            : 'Auto'}\n                                                    </td>\n                                                    <td>\n                                                        <div className=\"action-buttons\">\n                                                            <button \n                                                                className=\"btn-icon btn-icon-primary\"\n                                                                onClick={() => editStaff(s)}\n                                                                title=\"Edit\"\n                                                            >\n                                                                \n                                                            </button>\n                                                            <button \n                                                                className=\"btn-icon btn-icon-danger\"\n                                                                onClick={() => deleteStaff(s.id)}\n                                                                title=\"Delete\"\n                                                            >\n                                                                \n                                                            </button>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ))}\n                                        </tbody>\n                                    </table>\n                                </div>\n\n                                <div className=\"mobile-cards\">\n                                    {teachers.map((s, idx) => (\n                                        <div key={s.id} className=\"mobile-card\">\n                                            <div className=\"mobile-card-header\">\n                                                <span className=\"mobile-card-title\">{s.name}</span>\n                                                <span className=\"mobile-card-badge\">S{idx + 1}</span>\n                                            </div>\n                                            <div className=\"mobile-card-body\">\n                                                <div className=\"mobile-card-row\">\n                                                    <span className=\"mobile-card-label\">Username:</span>\n                                                    <span className=\"mobile-card-value\">{s.username}</span>\n                                                </div>\n                                                <div className=\"mobile-card-row\">\n                                                    <span className=\"mobile-card-label\">Free Periods:</span>\n                                                    <span className=\"mobile-card-value\">\n                                                        {s.freePeriodMode === 'manual' \n                                                            ? `Manual (${s.manualFreePeriods} free periods)` \n                                                            : 'Auto'}\n                                                    </span>\n                                                </div>\n                                            </div>\n                                            <div className=\"mobile-card-actions\">\n                                                <button className=\"btn btn-primary btn-sm\" onClick={() => editStaff(s)}>\n                                                     Edit\n                                                </button>\n                                                <button className=\"btn btn-danger btn-sm\" onClick={() => deleteStaff(s.id)}>\n                                                     Delete\n                                                </button>\n                                            </div>\n                                        </div>\n                                    ))}\n                                </div>\n                            </>\n                        )}\n                        <button \n                            className=\"btn btn-success btn-sm\" \n                            onClick={() => {setShowAddStaffForm(true); resetStaffForm()}}\n                            style={{marginTop: '15px'}}\n                        >\n                             Add Staff\n                        </button>\n                    </div>\n\n                    {/* ADD/EDIT STAFF - SECOND (COLLAPSIBLE) */}\n                    {showAddStaffForm && (\n                        <div className=\"card\" ref={staffFormRef}>\n                            <h3>{newStaff.id ? ' Edit Staff' : ' Add New Staff'}</h3>\n                            <div className=\"grid-2\">\n                                <div className=\"form-group\">\n                                    <label>Full Name *</label>\n                                    <input\n                                        type=\"text\"\n                                        placeholder=\"Dr. John Doe\"\n                                        value={newStaff.name}\n                                        onChange={e => setNewStaff({ ...newStaff, name: e.target.value })}\n                                    />\n                                </div>\n                                <div className=\"form-group\">\n                                    <label>Username *</label>\n                                    <input\n                                        type=\"text\"\n                                        placeholder=\"john\"\n                                        value={newStaff.username}\n                                        onChange={e => setNewStaff({ ...newStaff, username: e.target.value })}\n                                    />\n                                </div>\n                                <div className=\"form-group\">\n                                    <label>{newStaff.id ? 'New Password (Optional)' : 'Password'} *</label>\n                                    <input\n                                        type=\"password\"\n                                        placeholder={newStaff.id ? \"Leave blank to keep current\" : \"Enter password\"}\n                                        value={newStaff.password}\n                                        onChange={e => setNewStaff({ ...newStaff, password: e.target.value })}\n                                    />\n                                    {newStaff.id && (\n                                        <small style={{color: '#64748b', display: 'block', marginTop: '4px'}}>\n                                             Staff can use new password immediately on next login\n                                        </small>\n                                    )}\n                                </div>\n                                <div className=\"form-group\">\n                                    <label>Free Period Mode</label>\n                                    <select\n                                        value={newStaff.freePeriodMode}\n                                        onChange={e => setNewStaff({ ...newStaff, freePeriodMode: e.target.value })}\n                                    >\n                                        <option value=\"auto\">Auto</option>\n                                        <option value=\"manual\">Manual</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            {newStaff.freePeriodMode === 'manual' && (\n                                <div className=\"form-group\">\n                                    <label>Free Periods per Week</label>\n                                    <input\n                                        type=\"number\"\n                                        min=\"0\"\n                                        max=\"30\"\n                                        value={newStaff.manualFreePeriods}\n                                        onChange={e => setNewStaff({ \n                                            ...newStaff, \n                                            manualFreePeriods: parseInt(e.target.value) || 0 \n                                        })}\n                                    />\n                                </div>\n                            )}\n\n                            <div className=\"button-group\">\n                                <button className=\"btn btn-primary\" onClick={addOrUpdateStaff}>\n                                    {newStaff.id ? ' Save Changes' : ' Add Staff'}\n                                </button>\n                                <button className=\"btn btn-secondary\" onClick={() => {resetStaffForm(); setShowAddStaffForm(false);}}>\n                                     Cancel\n                                </button>\n                            </div>\n                        </div>\n                    )}\n                </div>\n\n                {/* ==================== SUBJECTS SECTION ==================== */}\n                <div className=\"section\" id=\"subject-section\">\n                    <div className=\"section-header\">\n                        <span className=\"section-icon\"></span>\n                        <h2 className=\"section-title\">Manage Subjects</h2>\n                    </div>\n\n                    {/* EXISTING SUBJECTS - FIRST */}\n                    <div className=\"card\">\n                        <h3>Existing Subjects ({subjects.length})</h3>\n                        {subjects.length === 0 ? (\n                            <p style={{color: '#64748b', textAlign: 'center', padding: '20px'}}>\n                                No subjects added yet\n                            </p>\n                        ) : (\n                            <>\n                                {classes.map(cls => {\n                                    const classSubjects = subjects.filter(s => s.className === cls.name);\n                                    if (classSubjects.length === 0) return null;\n\n                                    const totalHours = classSubjects.reduce((sum, s) => sum + s.hoursPerWeek, 0);\n                                    const progress = (totalHours / 30) * 100;\n\n                                    return (\n                                        <div key={cls.id} style={{marginBottom: '30px'}}>\n                                            <div style={{\n                                                marginBottom: '8px',\n                                                display: 'flex',\n                                                alignItems: 'center',\n                                                justifyContent: 'space-between',\n                                                gap: '10px',\n                                                color: '#1e293b',\n                                                flexWrap: 'wrap'\n                                            }}>\n                                                <h4 style={{ margin: 0, display: 'flex', alignItems: 'center', gap: '8px' }}>\n                                                    Class: <strong>{cls.name}</strong>\n                                                </h4>\n                                                <div style={{ display: 'flex', alignItems: 'center', gap: '16px', color: '#64748b', fontWeight: 600 }}>\n                                                    <span>{totalHours}/30 hours</span>\n                                                    <span>{Math.max(30 - totalHours, 0)}h remaining</span>\n                                                </div>\n                                            </div>\n\n                                            {/* Progress Bar */}\n                                            <div style={{\n                                                width: '100%',\n                                                height: '8px',\n                                                backgroundColor: '#e2e8f0',\n                                                borderRadius: '4px',\n                                                overflow: 'hidden',\n                                                marginBottom: '15px'\n                                            }}>\n                                                <div style={{\n                                                    height: '100%',\n                                                    width: `${Math.min(progress, 100)}%`,\n                                                    backgroundColor: totalHours === 30 ? '#10b981' : '#f59e0b',\n                                                    transition: 'width 0.3s ease'\n                                                }}></div>\n                                            </div>\n\n                                            <div className=\"desktop-table\">\n                                                <table>\n                                                    <thead>\n                                                        <tr>\n                                                            <th>Subject</th>\n                                                            <th>Type</th>\n                                                            <th>Hours</th>\n                                                            <th>Teacher</th>\n                                                            <th>Continuous</th>\n                                                            <th>Actions</th>\n                                                        </tr>\n                                                    </thead>\n                                                    <tbody>\n                                                        {classSubjects.map(sub => (\n                                                            <tr key={sub.id}>\n                                                                <td><strong>{sub.name}</strong></td>\n                                                                <td>{sub.subjectType}</td>\n                                                                <td>{sub.hoursPerWeek}h</td>\n                                                                <td>{sub.teacher}</td>\n                                                                <td>\n                                                                    {sub.isContinuous ? `Yes (${sub.blockSize}p)` : 'No'}\n                                                                </td>\n                                                                <td>\n                                                                    <div className=\"action-buttons\">\n                                                                        <button \n                                                                            className=\"btn-icon btn-icon-primary\"\n                                                                            onClick={() => editSubject(sub)}\n                                                                            title=\"Edit\"\n                                                                        >\n                                                                            \n                                                                        </button>\n                                                                        <button \n                                                                            className=\"btn-icon btn-icon-danger\"\n                                                                            onClick={() => deleteSubject(sub.id)}\n                                                                            title=\"Delete\"\n                                                                        >\n                                                                            \n                                                                        </button>\n                                                                    </div>\n                                                                </td>\n                                                            </tr>\n                                                        ))}\n                                                    </tbody>\n                                                </table>\n                                            </div>\n\n                                            <div className=\"mobile-cards\">\n                                                {classSubjects.map(sub => (\n                                                    <div key={sub.id} className=\"mobile-card\">\n                                                        <div className=\"mobile-card-header\">\n                                                            <span className=\"mobile-card-title\">{sub.name}</span>\n                                                            <span className=\"mobile-card-badge\">{sub.subjectType}</span>\n                                                        </div>\n                                                        <div className=\"mobile-card-body\">\n                                                            <div className=\"mobile-card-row\">\n                                                                <span className=\"mobile-card-label\">Hours:</span>\n                                                                <span className=\"mobile-card-value\">{sub.hoursPerWeek}h</span>\n                                                            </div>\n                                                            <div className=\"mobile-card-row\">\n                                                                <span className=\"mobile-card-label\">Teacher:</span>\n                                                                <span className=\"mobile-card-value\">{sub.teacher}</span>\n                                                            </div>\n                                                            <div className=\"mobile-card-row\">\n                                                                <span className=\"mobile-card-label\">Continuous:</span>\n                                                                <span className=\"mobile-card-value\">\n                                                                    {sub.isContinuous ? `Yes (${sub.blockSize}p)` : 'No'}\n                                                                </span>\n                                                            </div>\n                                                        </div>\n                                                        <div className=\"mobile-card-actions\">\n                                                            <button className=\"btn btn-primary btn-sm\" onClick={() => editSubject(sub)}>\n                                                                 Edit\n                                                            </button>\n                                                            <button className=\"btn btn-danger btn-sm\" onClick={() => deleteSubject(sub.id)}>\n                                                                 Delete\n                                                            </button>\n                                                        </div>\n                                                    </div>\n                                                ))}\n                                            </div>\n                                        </div>\n                                    );\n                                })}\n                            </>\n                        )}\n                        <button \n                            className=\"btn btn-success btn-sm\" \n                            onClick={() => {setShowAddSubjectForm(true); resetSubjectForm()}}\n                            style={{marginTop: '15px'}}\n                        >\n                             Add Subject\n                        </button>\n                    </div>\n\n                    {/* ADD/EDIT SUBJECT - SECOND (COLLAPSIBLE) */}\n                    {showAddSubjectForm && (\n                        <div className=\"card\" ref={subjectFormRef}>\n                            <h3>{newSubject.id ? ' Edit Subject' : ' Add New Subject'}</h3>\n                            \n                            {newSubject.className && (\n                                <HoursTracker className={newSubject.className} subjects={subjects} />\n                            )}\n\n                            <div className=\"grid-2\">\n                                <div className=\"form-group\">\n                                    <label>Select Class *</label>\n                                    <select\n                                        value={newSubject.className}\n                                        onChange={e => setNewSubject({ ...newSubject, className: e.target.value })}\n                                    >\n                                        <option value=\"\">-- Select Class --</option>\n                                        {classes.map(cls => (\n                                            <option key={cls.id} value={cls.name}>{cls.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n                                <div className=\"form-group\">\n                                    <label>Subject Name *</label>\n                                    <input\n                                        type=\"text\"\n                                        value={newSubject.name}\n                                        onChange={e => setNewSubject({ ...newSubject, name: e.target.value })}\n                                        placeholder=\"DBMS, AI Lab, etc.\"\n                                    />\n                                </div>\n                                <div className=\"form-group\">\n                                    <label>Subject Type *</label>\n                                    <select\n                                        value={newSubject.subjectType}\n                                        onChange={e => setNewSubject({ ...newSubject, subjectType: e.target.value })}\n                                    >\n                                        <option value=\"Core\">Core</option>\n                                        <option value=\"Elective\">Elective</option>\n                                        <option value=\"Lab\">Lab</option>\n                                        <option value=\"Other\">Other</option>\n                                    </select>\n                                </div>\n                                <div className=\"form-group\">\n                                    <label>Hours per Week *</label>\n                                    <input\n                                        type=\"number\"\n                                        min=\"1\"\n                                        max=\"30\"\n                                        value={newSubject.hoursPerWeek}\n                                        onChange={e => setNewSubject({ \n                                            ...newSubject, \n                                            hoursPerWeek: parseInt(e.target.value) || 6 \n                                        })}\n                                    />\n                                </div>\n                                <div className=\"form-group\">\n                                    <label>Teacher *</label>\n                                    <select\n                                        value={newSubject.teacher}\n                                        onChange={e => setNewSubject({ ...newSubject, teacher: e.target.value })}\n                                    >\n                                        <option value=\"\">-- Select Teacher --</option>\n                                        {teachers.map(t => (\n                                            <option key={t.id} value={t.name}>{t.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div className=\"checkbox-group\">\n                                <input\n                                    type=\"checkbox\"\n                                    id=\"continuous\"\n                                    checked={newSubject.isContinuous}\n                                    onChange={e => setNewSubject({ ...newSubject, isContinuous: e.target.checked })}\n                                />\n                                <label htmlFor=\"continuous\" style={{marginBottom: 0}}>\n                                    Continuous Period (Lab)\n                                </label>\n                            </div>\n\n                            {newSubject.isContinuous && (\n                                <div className=\"form-group\">\n                                    <label>Block Size</label>\n                                    <select\n                                        value={newSubject.blockSize}\n                                        onChange={e => setNewSubject({ \n                                            ...newSubject, \n                                            blockSize: parseInt(e.target.value) \n                                        })}\n                                    >\n                                        <option value={2}>2 Periods</option>\n                                        <option value={3}>3 Periods</option>\n                                    </select>\n                                </div>\n                            )}\n\n                            <div className=\"button-group\">\n                                <button className=\"btn btn-primary\" onClick={addOrUpdateSubject}>\n                                    {newSubject.id ? ' Save Changes' : ' Add Subject'}\n                                </button>\n                                <button className=\"btn btn-secondary\" onClick={() => {resetSubjectForm(); setShowAddSubjectForm(false);}}>\n                                     Cancel\n                                </button>\n                            </div>\n                        </div>\n                    )}\n                </div>\n\n                {/* ==================== GENERATE TIMETABLE ==================== */}\n                <div className=\"section\">\n                    <div className=\"section-header\">\n                        <span className=\"section-icon\"></span>\n                        <h2 className=\"section-title\">Generate Timetable</h2>\n                    </div>\n\n                    <div className=\"card\">\n                        <h3>Ready to Generate</h3>\n                        <div className=\"stats-grid\">\n                            <div className=\"stat-card stat-primary\">\n                                <div className=\"stat-label\">Classes</div>\n                                <div className=\"stat-value\">{classes.length}</div>\n                            </div>\n                            <div className=\"stat-card stat-success\">\n                                <div className=\"stat-label\">Teachers</div>\n                                <div className=\"stat-value\">{teachers.length}</div>\n                            </div>\n                            <div className=\"stat-card stat-warning\">\n                                <div className=\"stat-label\">Subjects</div>\n                                <div className=\"stat-value\">{subjects.length}</div>\n                            </div>\n                        </div>\n\n                        <button \n                            className=\"btn btn-success btn-lg\"\n                            onClick={generateTimetable}\n                            disabled={loading}\n                        >\n                            {loading ? ' Generating...' : ' Generate Timetable'}\n                        </button>\n                    </div>\n                </div>\n\n                {/* ==================== VIEW TIMETABLES ==================== */}\n                {timetable && (\n                    <div className=\"section\" id=\"view-timetables\">\n                        <div className=\"section-header\">\n                            <span className=\"section-icon\"></span>\n                            <h2 className=\"section-title\">Generated Timetables</h2>\n                        </div>\n\n                        <div className=\"card\">\n                            <h3>Time Tables</h3>\n                            {(() => {\n                                const sorted = [...classes].sort((a, b) => (a.department || 'Unassigned').localeCompare(b.department || 'Unassigned') || a.name.localeCompare(b.name));\n                                const groups = {};\n                                sorted.forEach(cls => {\n                                    const dept = cls.department || 'Unassigned';\n                                    if (!groups[dept]) groups[dept] = [];\n                                    groups[dept].push(\n                                        <div key={cls.id} className=\"timetable-container\" id={`timetable-export-${cls.id}`}>\n                                            <h4 className=\"timetable-title\">{cls.name}</h4>\n                                            <div className=\"timetable-scroll\">\n                                                <TimetableGrid timetable={timetable.classTimetables} className={cls.name} />\n                                            </div>\n                                            <div className=\"timetable-actions no-print no-export\">\n                                                <button className=\"btn btn-primary btn-sm\" onClick={() => exportToPDF(`timetable-export-${cls.id}`, `${cls.name}_Timetable.pdf`, { title: cls.name })}> Download PDF</button>\n                                            </div>\n                                        </div>\n                                    );\n                                });\n                                return Object.keys(groups)\n                                    .filter(dept => groups[dept].length > 0)\n                                    .map(dept => (\n                                        <div key={`dept-block-${dept}`} className=\"dept-group\">\n                                            <div className=\"dept-chip\">{dept}</div>\n                                            {groups[dept].map(node => (\n                                                <div key={node.key} className=\"class-box\">{node}</div>\n                                            ))}\n                                        </div>\n                                    ));\n                            })()}\n                        </div>\n\n                        <div className=\"card\">\n                            <h3>Staff-wise Timetables</h3>\n                            {[...teachers].sort((a, b) => a.name.localeCompare(b.name)).map(teacher => (\n                                <div key={teacher.id} className=\"timetable-container\" id={`staff-timetable-export-${teacher.id}`}>\n                                    <h4 className=\"timetable-title\">Teacher: {teacher.name}</h4>\n                                    <div className=\"timetable-scroll\">\n                                        <StaffTimetableGrid timetable={timetable.staffTimetables} staffName={teacher.name} />\n                                    </div>\n                                    <div className=\"timetable-actions no-print no-export\">\n                                        <button className=\"btn btn-primary btn-sm\" onClick={() => exportToPDF(`staff-timetable-export-${teacher.id}`, `${teacher.name}_Timetable.pdf`, { title: `Staff Timetable  ${teacher.name}` })}> Download PDF</button>\n                                    </div>\n                                </div>\n                            ))}\n                        </div>\n                    </div>\n                )}\n\n            </div>\n\n          <ToastContainer toasts={toasts} onRemove={removeToast} />\n\n          \n        </>\n    );\n}\n","import React from 'react';\r\nexport const Toast = ({ id, message, type, onRemove, undoAction }) => {\r\n  return (\r\n    <div\r\n      style={{\r\n        padding: '12px 16px',\r\n        borderRadius: '8px',\r\n        marginBottom: '10px',\r\n        background: type === 'error' ? '#ff4444' : type === 'success' ? '#00C851' : '#ffbb33',\r\n        color: 'white',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'space-between',\r\n        boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\r\n        animation: 'slideIn 0.3s ease-out'\r\n      }}\r\n    >\r\n      <span>{message}</span>\r\n      <div style={{ display: 'flex', gap: '8px', marginLeft: '16px' }}>\r\n        {undoAction && (\r\n          <button\r\n            onClick={() => {\r\n              if (typeof undoAction === 'function') {\r\n                undoAction();\r\n              }\r\n              if (typeof onRemove === 'function') {\r\n                onRemove(id);\r\n              }\r\n            }}\r\n            style={{\r\n              background: 'white',\r\n              color: type === 'success' ? '#00C851' : '#333',\r\n              border: 'none',\r\n              padding: '4px 12px',\r\n              borderRadius: '4px',\r\n              cursor: 'pointer',\r\n              fontSize: '13px',\r\n              fontWeight: '600'\r\n            }}\r\n          >\r\n            UNDO\r\n          </button>\r\n        )}\r\n        <button\r\n          onClick={() => {\r\n            if (typeof onRemove === 'function') {\r\n              onRemove(id);\r\n            }\r\n          }}\r\n          style={{\r\n            background: 'transparent',\r\n            border: 'none',\r\n            color: 'white',\r\n            cursor: 'pointer',\r\n            fontSize: '18px',\r\n            padding: '0 4px',\r\n            lineHeight: '1'\r\n          }}\r\n          title=\"Close\"\r\n        >\r\n          \r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const ToastContainer = ({ toasts, onRemove }) => {\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        top: '20px',\r\n        right: '20px',\r\n        zIndex: 9999,\r\n        minWidth: '300px',\r\n        maxWidth: '500px'\r\n      }}\r\n    >\r\n      {toasts.map(toast => (\r\n        <Toast\r\n          key={toast.id}\r\n          id={toast.id}\r\n          message={toast.message}\r\n          type={toast.type}\r\n          onRemove={onRemove}\r\n          undoAction={toast.undoAction}\r\n        />\r\n      ))}\r\n    </div>\r\n  );\r\n};","import React from 'react';\r\n\r\nexport default function HoursTracker({ timetable, staff }) {\r\n  if (!timetable || !timetable.staffTimetables) {\r\n    return null;\r\n  }\r\n\r\n  const teachers = staff.filter(s => s.role === 'staff');\r\n\r\n  return (\r\n    <div style={{ marginBottom: '30px' }}>\r\n      <h3 style={{ marginBottom: '15px' }}> Staff Hours Summary</h3>\r\n      <table className=\"data-table\">\r\n        <thead>\r\n          <tr>\r\n            <th>Staff Name</th>\r\n            <th>Teaching Hours</th>\r\n            <th>Free Periods</th>\r\n            <th>Status</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {teachers.map((teacher) => {\r\n            const staffTT = timetable.staffTimetables[teacher.name];\r\n            if (!staffTT) {\r\n              return (\r\n                <tr key={teacher.id}>\r\n                  <td>{teacher.name}</td>\r\n                  <td>0</td>\r\n                  <td>30</td>\r\n                  <td> Not Assigned</td>\r\n                </tr>\r\n              );\r\n            }\r\n\r\n            // Count teaching hours\r\n            let teachingHours = 0;\r\n            let freePeriods = 0;\r\n\r\n            staffTT.forEach(day => {\r\n              day.forEach(period => {\r\n                if (period && period.type !== 'free') {\r\n                  teachingHours++;\r\n                } else {\r\n                  freePeriods++;\r\n                }\r\n              });\r\n            });\r\n\r\n            const status = teachingHours >= 24 ? ' Full Load' :\r\n                          teachingHours >= 18 ? ' Good' :\r\n                          teachingHours > 0 ? ' Low Load' :\r\n                          ' No Classes';\r\n\r\n            return (\r\n              <tr key={teacher.id}>\r\n                <td>{teacher.name}</td>\r\n                <td>{teachingHours}/30</td>\r\n                <td>{freePeriods}/30</td>\r\n                <td>{status}</td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}","import React from 'react';\r\n\r\nconst DAYS = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];\r\n\r\nexport default function TimetableGrid({ timetable, className }) {\r\n    if (!timetable || !timetable[className]) {\r\n        return (\r\n            <div style={{padding: '40px', textAlign: 'center', color: '#64748b'}}>\r\n                No timetable available\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const grid = timetable[className];\r\n\r\n    // Debug code\r\n    console.log('TimetableGrid - className:', className);\r\n    console.log('TimetableGrid - grid:', grid);\r\n    console.log('TimetableGrid - grid is array?', Array.isArray(grid));\r\n\r\n    // Safety check: if grid is not an array or not nested properly\r\n    if (!Array.isArray(grid) || grid.length === 0) {\r\n        return (\r\n            <div style={{padding: '40px', textAlign: 'center', color: '#64748b'}}>\r\n                Invalid timetable format\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div id=\"timetable-export\" className=\"timetable-grid\">\r\n            <div className=\"timetable-header\">Day/Period</div>\r\n            {[...Array(6)].map((_, i) => (\r\n                <div key={i} className=\"timetable-header\">P{i + 1}</div>\r\n            ))}\r\n\r\n            {DAYS.map((day, dayIndex) => {\r\n                // Safety check for each day\r\n                if (!grid[dayIndex] || !Array.isArray(grid[dayIndex])) {\r\n                    return null;\r\n                }\r\n\r\n                return (\r\n                    <React.Fragment key={day}>\r\n                        <div className=\"timetable-day\">{day}</div>\r\n                        {grid[dayIndex].map((slot, periodIndex) => (\r\n                            <div \r\n                                key={periodIndex} \r\n                                className={`timetable-cell subject-${slot && slot.type ? slot.type.toLowerCase() : 'free'}`}\r\n                            >\r\n                                {slot && slot.subject !== 'FREE' ? (\r\n                                    <>\r\n                                        <div className=\"subject-name\">{slot.subject}</div>\r\n                                        <div className=\"teacher-name\">{slot.teacher}</div>\r\n                                    </>\r\n                                ) : (\r\n                                    <div style={{ color: '#94a3b8' }}>FREE</div>\r\n                                )}\r\n                            </div>\r\n                        ))}\r\n                    </React.Fragment>\r\n                );\r\n            })}\r\n        </div>\r\n    );\r\n}\r\n","import React from 'react';\r\n\r\nexport default function StaffTimetableGrid({ timetable, staffName }) {\r\n    const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];\r\n    const periods = ['P1', 'P2', 'P3', 'P4', 'P5', 'P6'];\r\n\r\n    const staffSchedule = timetable[staffName];\r\n\r\n    console.log('StaffTimetableGrid - Staff:', staffName);\r\n    console.log('StaffTimetableGrid - Available:', Object.keys(timetable));\r\n\r\n    if (!staffSchedule) {\r\n        return (\r\n            <div style={{ padding: '40px', textAlign: 'center' }}>\r\n                <div style={{ fontSize: '48px', marginBottom: '20px' }}></div>\r\n                <h3>No Timetable Found</h3>\r\n                <p style={{color: '#64748b'}}>No timetable for \"{staffName}\"</p>\r\n                <p style={{color: '#64748b', fontSize: '14px'}}>Available: {Object.keys(timetable).join(', ')}</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"timetable-container\" id=\"staff-timetable-export\">\r\n            <table className=\"timetable\">\r\n                <thead>\r\n                    <tr>\r\n                        <th className=\"day-header\">DAY/PERIOD</th>\r\n                        {periods.map(p => <th key={p} className=\"period-header\">{p}</th>)}\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    {days.map((day, dayIdx) => (\r\n                        <tr key={day}>\r\n                            <td className=\"day-cell\">{day}</td>\r\n                            {periods.map((period, periodIdx) => {\r\n                                const slot = staffSchedule[dayIdx]?.[periodIdx];\r\n                                const isFree = !slot || slot.type === 'free' || slot.subject === 'FREE';\r\n\r\n                                return (\r\n                                    <td key={period} className={`period-cell ${isFree ? 'free-period' : 'class-period'}`}>\r\n                                        {isFree ? (\r\n                                            <div className=\"period-content free\">\r\n                                                <span className=\"subject-name\">FREE</span>\r\n                                            </div>\r\n                                        ) : (\r\n                                            <div className=\"period-content\">\r\n                                                <span className=\"subject-name\">{slot.subject}</span>\r\n                                                <span className=\"class-name\">{slot.class}</span>\r\n                                            </div>\r\n                                        )}\r\n                                    </td>\r\n                                );\r\n                            })}\r\n                        </tr>\r\n                    ))}\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    );\r\n}","/**\r\n * Timetable Generator - CLEAN VERSION 2025-12-04\r\n * NO TYPOS - PRODUCTION READY\r\n * Generates intelligent timetables based on defined rules\r\n */\r\n\r\nexport class TimetableGenerator {\r\n    constructor(classes, staff, subjects, options = {}) {\r\n        this.classes = classes || [];\r\n        this.staff = staff || [];\r\n        this.subjects = subjects || [];\r\n        this.options = options || {};\r\n\r\n        // Output structures\r\n        this.classTimetables = {};\r\n        this.staffTimetables = {};\r\n\r\n        // Tracking structures\r\n        this.teacherBusySlots = {};\r\n        this.teacherWeeklyHours = {};\r\n        this.teacherDailyHours = {};\r\n        this.teacherExpectedWeeklyHours = {};\r\n        this.subjectPlacementTracker = {};\r\n        this.placements = [];\r\n        this.subjectPeriodUsage = {};\r\n        this.labStartPositions = {};\r\n\r\n        this.DAYS = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];\r\n        \r\n        this.PERIODS = 6;\r\n        this.TOTAL_WEEKLY_HOURS = 30;\r\n\r\n        this.dailyMaxPerSubject = typeof this.options.dailyMaxPerSubject === 'number' ? this.options.dailyMaxPerSubject : 2;\r\n        const seed = typeof this.options.seed === 'number' ? this.options.seed : 123456789;\r\n        this._rng = (() => {\r\n            let a = seed >>> 0;\r\n            return () => {\r\n                a += 0x6D2B79F5;\r\n                let t = a;\r\n                t = Math.imul(t ^ (t >>> 15), t | 1);\r\n                t ^= t + Math.imul(t ^ (t >>> 7), t | 61);\r\n                return ((t ^ (t >>> 14)) >>> 0) / 4294967296;\r\n            };\r\n        })();\r\n    }\r\n\r\n    /**\r\n     * Validate input data before generation\r\n     */\r\n    validate() {\r\n        const errors = [];\r\n\r\n        if (!this.classes || this.classes.length === 0) {\r\n            errors.push('No classes added');\r\n        }\r\n\r\n        if (!this.staff || this.staff.filter(s => s.role === 'staff').length === 0) {\r\n            errors.push('No staff added');\r\n        }\r\n\r\n        if (!this.subjects || this.subjects.length === 0) {\r\n            errors.push('No subjects added');\r\n        }\r\n\r\n        if (errors.length > 0) {\r\n            return { valid: false, errors };\r\n        }\r\n\r\n        // Check if each class has exactly 30 hours per week\r\n        const classHours = {};\r\n        this.subjects.forEach(subject => {\r\n            if (subject && subject.className && subject.hoursPerWeek) {\r\n                classHours[subject.className] = (classHours[subject.className] || 0) + subject.hoursPerWeek;\r\n            }\r\n        });\r\n\r\n        this.classes.forEach(cls => {\r\n            if (cls && cls.name) {\r\n                const hours = classHours[cls.name] || 0;\r\n                if (hours !== this.TOTAL_WEEKLY_HOURS) {\r\n                    errors.push(`Class ${cls.name} must have exactly ${this.TOTAL_WEEKLY_HOURS} hours (current: ${hours}).`);\r\n                }\r\n            }\r\n        });\r\n\r\n        if (errors.length > 0) {\r\n            return { valid: false, errors };\r\n        }\r\n\r\n        return { valid: true, warnings: [] };\r\n    }\r\n\r\n    /**\r\n     * Main generation method\r\n     */\r\n    generate() {\r\n        try {\r\n            console.log(' Starting intelligent timetable generation...');\r\n\r\n            this._initialize();\r\n\r\n            // Generate timetable for each class\r\n            for (const cls of this.classes) {\r\n                if (!cls || !cls.name) continue;\r\n\r\n                console.log(`\\n Generating timetable for ${cls.name}`);\r\n                const success = this._generateClassTimetable(cls.name);\r\n\r\n                if (!success) {\r\n                    return {\r\n                        success: false,\r\n                        error: `Failed to generate complete timetable for ${cls.name}`\r\n                    };\r\n                }\r\n            }\r\n\r\n            // Generate staff timetables\r\n            this._generateStaffTimetables();\r\n\r\n            const warnings = [];\r\n\r\n            // Post-validate teacher weekly totals\r\n            Object.keys(this.teacherExpectedWeeklyHours).forEach(t => {\r\n                const expected = this.teacherExpectedWeeklyHours[t] || 0;\r\n                const actual = this.teacherWeeklyHours[t] || 0;\r\n                if (actual !== expected) {\r\n                    warnings.push(`Teacher ${t} scheduled ${actual}/${expected} hours.`);\r\n                }\r\n            });\r\n\r\n            // Post-validate class filled hours\r\n            this.classes.forEach(cls => {\r\n                if (!cls || !cls.name) return;\r\n                let filled = 0;\r\n                this.DAYS.forEach((_, d) => {\r\n                    const row = this.classTimetables[cls.name]?.[d] || [];\r\n                    row.forEach(s => { if (s) filled++; });\r\n                });\r\n                if (filled !== this.TOTAL_WEEKLY_HOURS) {\r\n                    warnings.push(`Class ${cls.name} filled ${filled}/${this.TOTAL_WEEKLY_HOURS} periods.`);\r\n                }\r\n            });\r\n\r\n            console.log('\\n Timetable generation completed successfully');\r\n\r\n            const diag = this._computeDiagnosticsAndScore();\r\n            return {\r\n                success: true,\r\n                classTimetables: this.classTimetables,\r\n                staffTimetables: this.staffTimetables,\r\n                placements: this.placements,\r\n                score: diag.score,\r\n                diagnostics: diag.diagnostics,\r\n                warnings\r\n            };\r\n\r\n        } catch (error) {\r\n            console.error(' Error generating timetable:', error);\r\n            return {\r\n                success: false,\r\n                error: `Error: ${error.message || 'Unknown error'}`\r\n            };\r\n        }\r\n    }\r\n\r\n    _computeDiagnosticsAndScore() {\r\n        let violations = [];\r\n        let notes = [];\r\n\r\n        // Subject weekly hours\r\n        Object.keys(this.subjectPlacementTracker).forEach(k => {\r\n            const t = this.subjectPlacementTracker[k];\r\n            if (!t) return;\r\n            if (t.remaining !== 0) {\r\n                violations.push(`Subject ${k} remaining ${t.remaining}`);\r\n            }\r\n        });\r\n\r\n        // Daily max per subject\r\n        let sameSubjectExcesses = 0;\r\n        Object.keys(this.subjectPlacementTracker).forEach(k => {\r\n            const t = this.subjectPlacementTracker[k];\r\n            if (!t) return;\r\n            this.DAYS.forEach(d => {\r\n                const c = t.dailyCount[d] || 0;\r\n                if (c > this.dailyMaxPerSubject) sameSubjectExcesses += (c - this.dailyMaxPerSubject);\r\n            });\r\n        });\r\n\r\n        // Labs at edges\r\n        let labsAtEdges = 0;\r\n        for (const p of this.placements) {\r\n            if (p.type === 'lab') {\r\n                if (p.period === 1 || p.period === this.PERIODS) labsAtEdges++;\r\n            }\r\n        }\r\n\r\n        // Preferred spread\r\n        let insufficientSpread = 0;\r\n        const bySubject = {};\r\n        for (const p of this.placements) {\r\n            const key = `${p.className}-${p.subject}`;\r\n            bySubject[key] = bySubject[key] || new Set();\r\n            bySubject[key].add(p.day);\r\n        }\r\n        this.subjects.forEach(s => {\r\n            if (!s || !s.name) return;\r\n            if ((s.hoursPerWeek || 0) >= 4) {\r\n                const key = `${s.className}-${s.name}`;\r\n                const usedDays = bySubject[key]?.size || 0;\r\n                if (usedDays < 3) insufficientSpread++;\r\n            }\r\n        });\r\n\r\n        // Teacher continuous periods over 3\r\n        let teacherOver3 = 0;\r\n        const teachers = Object.keys(this.staffTimetables);\r\n        teachers.forEach(t => {\r\n            const tt = this.staffTimetables[t];\r\n            if (!tt) return;\r\n            for (let d = 0; d < this.DAYS.length; d++) {\r\n                let run = 0;\r\n                for (let p = 0; p < this.PERIODS; p++) {\r\n                    const slot = tt[d][p];\r\n                    if (slot && slot.subject !== 'FREE') {\r\n                        run++;\r\n                    } else {\r\n                        if (run > 3) teacherOver3 += (run - 3);\r\n                        run = 0;\r\n                    }\r\n                }\r\n                if (run > 3) teacherOver3 += (run - 3);\r\n            }\r\n        });\r\n\r\n        let score = 1000;\r\n        score -= 500 * (violations.length);\r\n        score -= 10 * sameSubjectExcesses;\r\n        score -= 5 * labsAtEdges;\r\n        score -= 2 * insufficientSpread;\r\n        score -= 1 * teacherOver3;\r\n\r\n        const diagnostics = { violations, notes };\r\n        return { score, diagnostics };\r\n    }\r\n\r\n    /**\r\n     * Initialize all data structures\r\n     */\r\n    _initialize() {\r\n        console.log(' Initializing timetables...');\r\n\r\n        // Initialize class timetables\r\n        this.classes.forEach(cls => {\r\n            if (cls && cls.name) {\r\n                this.classTimetables[cls.name] = this.DAYS.map(() => \r\n                    Array(this.PERIODS).fill(null)\r\n                );\r\n            }\r\n        });\r\n\r\n        // Initialize teacher tracking\r\n        const staffMembers = this.staff.filter(s => s && s.role === 'staff');\r\n        staffMembers.forEach(teacher => {\r\n            if (teacher && teacher.name) {\r\n                this.teacherBusySlots[teacher.name] = {};\r\n                this.teacherWeeklyHours[teacher.name] = 0;\r\n                this.teacherDailyHours[teacher.name] = {};\r\n\r\n                this.DAYS.forEach(day => {\r\n                    this.teacherDailyHours[teacher.name][day] = 0;\r\n                });\r\n            }\r\n        });\r\n\r\n        // Compute expected weekly hours per teacher\r\n        this.teacherExpectedWeeklyHours = {};\r\n        this.subjects.forEach(subject => {\r\n            if (subject && subject.teacher && subject.hoursPerWeek) {\r\n                this.teacherExpectedWeeklyHours[subject.teacher] = (this.teacherExpectedWeeklyHours[subject.teacher] || 0) + subject.hoursPerWeek;\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Generate timetable for a specific class\r\n     */\r\n    _generateClassTimetable(className) {\r\n        try {\r\n            const classSubjects = this.subjects.filter(s => \r\n                s && s.className === className\r\n            );\r\n\r\n            if (classSubjects.length === 0) {\r\n                console.warn(`No subjects found for ${className}`);\r\n                return true;\r\n            }\r\n\r\n            // Initialize subject tracking\r\n            classSubjects.forEach(subject => {\r\n                if (subject) {\r\n                    const key = `${className}-${subject.name}`;\r\n                    this.subjectPlacementTracker[key] = {\r\n                        placed: 0,\r\n                        remaining: subject.hoursPerWeek || 0,\r\n                        dailyCount: {},\r\n                        lastPlacedSlot: -1\r\n                    };\r\n\r\n                    this.DAYS.forEach(day => {\r\n                        this.subjectPlacementTracker[key].dailyCount[day] = 0;\r\n                    });\r\n                }\r\n            });\r\n\r\n            // Initialize usage trackers for anti-pattern rules\r\n            if (!this.subjectPeriodUsage[className]) this.subjectPeriodUsage[className] = {};\r\n            if (!this.labStartPositions[className]) this.labStartPositions[className] = {};\r\n\r\n            // Pre-place labs before theories\r\n            this._prePlaceLabs(className, classSubjects);\r\n\r\n            // Fill timetable slot by slot\r\n            for (let dayIdx = 0; dayIdx < this.DAYS.length; dayIdx++) {\r\n                const day = this.DAYS[dayIdx];\r\n                console.log(`   ${day}:`);\r\n\r\n                for (let period = 0; period < this.PERIODS; period++) {\r\n                    // Check if we're in the middle of a lab block\r\n                    if (period > 0) {\r\n                        const prevSlot = this.classTimetables[className][dayIdx][period - 1];\r\n                        if (prevSlot && prevSlot.isLabContinuation && prevSlot.blockRemaining > 0) {\r\n                            // Continue the lab block\r\n                            const subject = classSubjects.find(s => s.name === prevSlot.subject);\r\n                            if (subject) {\r\n                                this._placeSubject(className, dayIdx, period, subject, true, prevSlot.blockRemaining - 1);\r\n                                console.log(`    P${period + 1}: ${subject.name} (Lab continuation)`);\r\n                                continue;\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    // Find best subject for this slot\r\n                    const bestSubject = this._findBestSubject(className, dayIdx, period, classSubjects);\r\n\r\n                    if (bestSubject) {\r\n                        // Check if it's a lab and needs multiple periods\r\n                        if (bestSubject.isContinuous) {\r\n                            const blockSize = bestSubject.blockSize || 2;\r\n\r\n                            // Check if we have enough consecutive periods\r\n                            if (period + blockSize <= this.PERIODS) {\r\n                                // Check if all periods are free and teacher is available\r\n                                let canPlaceLab = true;\r\n                                \r\n                                for (let i = 0; i < blockSize; i++) {\r\n                                    if (this.classTimetables[className][dayIdx][period + i] !== null) {\r\n                                        canPlaceLab = false;\r\n                                        break;\r\n                                    }\r\n\r\n                                    const slotKey = `${day}-P${period + 1 + i}`;\r\n                                    if (this.teacherBusySlots[bestSubject.teacher]?.[slotKey]) {\r\n                                        canPlaceLab = false;\r\n                                        break;\r\n                                    }\r\n                                    if (!this._isTeacherAvailable(bestSubject.teacher, dayIdx, period + i)) {\r\n                                        canPlaceLab = false;\r\n                                        break;\r\n                                    }\r\n                                }\r\n\r\n                                if (canPlaceLab) {\r\n                                    // Place the entire lab block\r\n                                    for (let i = 0; i < blockSize; i++) {\r\n                                        this._placeSubject(\r\n                                            className, \r\n                                            dayIdx, \r\n                                            period + i, \r\n                                            bestSubject, \r\n                                            true, \r\n                                            blockSize - i - 1\r\n                                        );\r\n                                    }\r\n                                    console.log(`    P${period + 1}-P${period + blockSize}: ${bestSubject.name} (Lab block)`);\r\n                                    period += blockSize - 1; // Skip the periods we just filled\r\n                                    continue;\r\n                                } else {\r\n                                    console.log(`    P${period + 1}: Cannot place ${bestSubject.name} lab (not enough space or teacher busy)`);\r\n                                }\r\n                            }\r\n                        } else {\r\n                            // Place theory subject\r\n                            this._placeSubject(className, dayIdx, period, bestSubject, false, 0);\r\n                            console.log(`    P${period + 1}: ${bestSubject.name}`);\r\n                        }\r\n                    } else {\r\n                        console.log(`    P${period + 1}: No suitable subject found (will remain empty)`);\r\n                    }\r\n                }\r\n            }\r\n\r\n            return true;\r\n\r\n        } catch (error) {\r\n            console.error(` Error generating timetable for ${className}:`, error);\r\n            return false;\r\n        }\r\n    }\r\n\r\n    _prePlaceLabs(className, classSubjects) {\r\n        const labs = classSubjects.filter(s => s && s.isContinuous);\r\n        if (labs.length === 0) return;\r\n\r\n        const dayLabCount = {};\r\n        this.DAYS.forEach(d => { dayLabCount[d] = 0; });\r\n\r\n        const lastLabDay = {};\r\n\r\n        for (const subject of labs) {\r\n            const blockSize = subject.blockSize || 2;\r\n            let remaining = subject.hoursPerWeek || 0;\r\n            const staffMember = this.staff.find(s => s.name === subject.teacher);\r\n\r\n            while (remaining >= blockSize) {\r\n                let placed = false;\r\n                const choices = [];\r\n                for (let dayIdx = 0; dayIdx < this.DAYS.length; dayIdx++) {\r\n                    const day = this.DAYS[dayIdx];\r\n                    for (let period = 0; period <= this.PERIODS - blockSize; period++) {\r\n                        let canPlace = true;\r\n                        for (let i = 0; i < blockSize; i++) {\r\n                            if (this.classTimetables[className][dayIdx][period + i] !== null) { canPlace = false; break; }\r\n                            const slotKey = `${day}-P${period + 1 + i}`;\r\n                            if (this.teacherBusySlots[subject.teacher]?.[slotKey]) { canPlace = false; break; }\r\n                            if (!this._isTeacherAvailable(subject.teacher, dayIdx, period + i)) { canPlace = false; break; }\r\n                        }\r\n                        if (canPlace) {\r\n                            let w = 100;\r\n                            if (period === 0 || period + blockSize - 1 === this.PERIODS - 1) w -= 25;\r\n                            if (dayLabCount[day] >= 1) w -= 30;\r\n                            if (lastLabDay[subject.name] !== undefined && Math.abs(dayIdx - lastLabDay[subject.name]) < 1) w -= 20;\r\n                            const teacherDaily = this.teacherDailyHours[subject.teacher]?.[this.DAYS[dayIdx]] || 0;\r\n                            if (teacherDaily >= 3) w -= 15;\r\n                            const startsUsed = this.labStartPositions[className][subject.name] || new Set();\r\n                            if (startsUsed.has(period)) continue; // avoid repeating same start block across days\r\n                            choices.push({ dayIdx, period, weight: Math.max(1, w) });\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (choices.length > 0) {\r\n                    const pick = this._weightedPick(choices);\r\n                    for (let i = 0; i < blockSize; i++) {\r\n                        this._placeSubject(className, pick.dayIdx, pick.period + i, subject, true, blockSize - i - 1);\r\n                    }\r\n                    const day = this.DAYS[pick.dayIdx];\r\n                    dayLabCount[day] += 1;\r\n                    lastLabDay[subject.name] = pick.dayIdx;\r\n                    remaining -= blockSize;\r\n                    placed = true;\r\n                    const s = this.labStartPositions[className][subject.name] || new Set();\r\n                    s.add(pick.period);\r\n                    this.labStartPositions[className][subject.name] = s;\r\n                }\r\n\r\n                if (!placed) {\r\n                    for (let dayIdx = 0; dayIdx < this.DAYS.length && !placed; dayIdx++) {\r\n                        const day = this.DAYS[dayIdx];\r\n                        for (let period = 0; period <= this.PERIODS - blockSize; period++) {\r\n                            let canPlace = true;\r\n                            for (let i = 0; i < blockSize; i++) {\r\n                                if (this.classTimetables[className][dayIdx][period + i] !== null) { canPlace = false; break; }\r\n                                const slotKey = `${day}-P${period + 1 + i}`;\r\n                                if (this.teacherBusySlots[subject.teacher]?.[slotKey]) { canPlace = false; break; }\r\n                                if (!this._isTeacherAvailable(subject.teacher, dayIdx, period + i)) { canPlace = false; break; }\r\n                            }\r\n                            if (canPlace) {\r\n                                for (let i = 0; i < blockSize; i++) {\r\n                                    this._placeSubject(className, dayIdx, period + i, subject, true, blockSize - i - 1);\r\n                                }\r\n                                dayLabCount[day] += 1;\r\n                                lastLabDay[subject.name] = dayIdx;\r\n                                remaining -= blockSize;\r\n                                placed = true;\r\n                                const s2 = this.labStartPositions[className][subject.name] || new Set();\r\n                                s2.add(period);\r\n                                this.labStartPositions[className][subject.name] = s2;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (!placed) break;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Find the best subject to place in a given slot\r\n     */\r\n    _findBestSubject(className, dayIdx, period, classSubjects) {\r\n        const day = this.DAYS[dayIdx];\r\n        const slotKey = `${day}-P${period + 1}`;\r\n        const candidates = [];\r\n\r\n        for (const subject of classSubjects) {\r\n            if (!subject || !subject.name) continue;\r\n\r\n            const trackingKey = `${className}-${subject.name}`;\r\n            const tracker = this.subjectPlacementTracker[trackingKey];\r\n\r\n            // Skip if no hours remaining\r\n            if (!tracker || tracker.remaining <= 0) continue;\r\n\r\n            // Check teacher availability (Rule: teacher not in two classes at once)\r\n            if (this.teacherBusySlots[subject.teacher]?.[slotKey]) {\r\n                continue;\r\n            }\r\n            if (!this._isTeacherAvailable(subject.teacher, dayIdx, period)) {\r\n                continue;\r\n            }\r\n\r\n            // Hard cap: do not exceed teacher's expected weekly hours\r\n            const expectedWeekly = this.teacherExpectedWeeklyHours[subject.teacher] || 0;\r\n            const currentWeekly = this.teacherWeeklyHours[subject.teacher] || 0;\r\n            if (expectedWeekly > 0 && currentWeekly >= expectedWeekly) {\r\n                continue;\r\n            }\r\n\r\n            let score = 100;\r\n            const reasons = [];\r\n\r\n            const dailyCount = tracker.dailyCount[day] || 0;\r\n            if (!subject.isContinuous) {\r\n                if (dailyCount >= this.dailyMaxPerSubject) {\r\n                    continue;\r\n                } else if (dailyCount === 1) {\r\n                    score -= 25;\r\n                    reasons.push('Second usage same day -25');\r\n                }\r\n            }\r\n\r\n            // Vertical pattern avoidance: limit same subject in the same period across days to 2\r\n            const usageMap = this.subjectPeriodUsage[className][subject.name] || {};\r\n            const usedCountSamePeriod = usageMap[period] || 0;\r\n            if (!subject.isContinuous) {\r\n                if (usedCountSamePeriod >= 2) {\r\n                    continue;\r\n                } else if (usedCountSamePeriod === 1) {\r\n                    score -= 20;\r\n                    reasons.push('Repeat same period across days -20');\r\n                } else {\r\n                    score += 10;\r\n                    reasons.push('Prefer unused period slot +10');\r\n                }\r\n            }\r\n\r\n            // Daily variety anti-pattern: avoid same 2/3 subject order across days\r\n            if (!subject.isContinuous) {\r\n                // Check pair\r\n                if (period >= 1) {\r\n                    const prevSubj = this.classTimetables[className][dayIdx][period - 1]?.subject || null;\r\n                    if (prevSubj) {\r\n                        for (let d = 0; d < this.DAYS.length; d++) {\r\n                            if (d === dayIdx) continue;\r\n                            const s1 = this.classTimetables[className][d]?.[period - 1]?.subject || null;\r\n                            const s2 = this.classTimetables[className][d]?.[period]?.subject || null;\r\n                            if (s1 === prevSubj && s2 === subject.name) {\r\n                                score -= 25;\r\n                                reasons.push('Avoid repeating pair order across days -25');\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                // Check triple\r\n                if (period >= 2) {\r\n                    const ps2 = this.classTimetables[className][dayIdx][period - 2]?.subject || null;\r\n                    const ps1 = this.classTimetables[className][dayIdx][period - 1]?.subject || null;\r\n                    if (ps2 && ps1) {\r\n                        for (let d = 0; d < this.DAYS.length; d++) {\r\n                            if (d === dayIdx) continue;\r\n                            const t0 = this.classTimetables[className][d]?.[period - 2]?.subject || null;\r\n                            const t1 = this.classTimetables[className][d]?.[period - 1]?.subject || null;\r\n                            const t2 = this.classTimetables[className][d]?.[period]?.subject || null;\r\n                            if (t0 === ps2 && t1 === ps1 && t2 === subject.name) {\r\n                                score -= 40;\r\n                                reasons.push('Avoid repeating triple order across days -40');\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (!subject.isContinuous && period >= 2) {\r\n                let continuousCount = 0;\r\n                for (let i = 1; i <= 2; i++) {\r\n                    const prevSlot = this.classTimetables[className][dayIdx][period - i];\r\n                    if (prevSlot && prevSlot.subject === subject.name && !prevSlot.isLabContinuation) {\r\n                        continuousCount++;\r\n                    } else {\r\n                        break;\r\n                    }\r\n                }\r\n                if (continuousCount >= 2) {\r\n                    continue;\r\n                } else if (continuousCount === 1) {\r\n                    score -= 25;\r\n                    reasons.push('Avoid back-to-back theory -25');\r\n                }\r\n            }\r\n\r\n            if (!subject.isContinuous) {\r\n                if (period >= 1 && period <= 4) {\r\n                    score += 20;\r\n                    reasons.push('Middle period theory +20');\r\n                } else {\r\n                    score -= 25;\r\n                    reasons.push('Edge period theory -25');\r\n                }\r\n            }\r\n\r\n            // RULE: Labs prefer afternoon (period 3-5)\r\n            if (subject.isContinuous) {\r\n                const blockSize = subject.blockSize || 2;\r\n\r\n                // Check if lab can fit\r\n                if (period + blockSize > this.PERIODS) {\r\n                    score -= 1000;\r\n                    reasons.push('Lab cannot fit -1000');\r\n                } else {\r\n                    if (period >= 2) {\r\n                        score += 25;\r\n                        reasons.push('Lab in afternoon +25');\r\n                    }\r\n\r\n                    // RULE: Avoid last period for labs\r\n                    if (period + blockSize === this.PERIODS + 1) {\r\n                        score -= 20;\r\n                        reasons.push('Lab at last period -20');\r\n                    }\r\n\r\n                    // Count labs already placed today\r\n                    let labsToday = 0;\r\n                    for (let p = 0; p < period; p++) {\r\n                        const slot = this.classTimetables[className][dayIdx][p];\r\n                        if (slot && slot.isLabContinuation && slot.blockRemaining === (slot.blockSize || 2) - 1) {\r\n                            labsToday++;\r\n                        }\r\n                    }\r\n\r\n                    // Prefer 1 lab per day; second only if necessary\r\n                    if (labsToday >= 1) {\r\n                        score -= 50;\r\n                        reasons.push('Second lab same day -50');\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Weekly distribution preference: prefer unused days for the subject\r\n            if (!subject.isContinuous) {\r\n                const uniqueDaysUsed = this.DAYS.reduce((acc, d) => acc + ((tracker.dailyCount[d] || 0) > 0 ? 1 : 0), 0);\r\n                if (tracker.dailyCount[day] === 0) {\r\n                    score += 15;\r\n                    reasons.push('Prefer spreading to new day +15');\r\n                }\r\n            }\r\n\r\n            // Daily diversity: prefer at least 3 different subjects per day\r\n            if (!subject.isContinuous) {\r\n                const existingSlots = this.classTimetables[className][dayIdx];\r\n                const distinctSubjects = new Set();\r\n                for (let p = 0; p < existingSlots.length; p++) {\r\n                    const sl = existingSlots[p];\r\n                    if (sl && !sl.isLabContinuation) {\r\n                        distinctSubjects.add(sl.subject);\r\n                    }\r\n                }\r\n                const distinctCount = distinctSubjects.size;\r\n                if (distinctCount < 3) {\r\n                    if (distinctSubjects.has(subject.name)) {\r\n                        score -= 30;\r\n                        reasons.push('Improve daily mix -30');\r\n                    } else {\r\n                        score += 30;\r\n                        reasons.push('New subject improves mix +30');\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Teacher dominance control per day\r\n            if (!subject.isContinuous) {\r\n                const teacherDaily = (this.teacherDailyHours[subject.teacher]?.[day]) || 0;\r\n                if (teacherDaily >= 3) {\r\n                    score -= 25;\r\n                    reasons.push('Teacher day dominance -25');\r\n                } else if (teacherDaily >= 2) {\r\n                    score -= 10;\r\n                    reasons.push('Teacher appearing often -10');\r\n                }\r\n            }\r\n\r\n            // Priority to subjects with more remaining hours\r\n            const remainingRatio = tracker.remaining / (subject.hoursPerWeek || 1);\r\n            score += remainingRatio * 20;\r\n            reasons.push(`Remaining priority +${Math.round(remainingRatio * 20)}`);\r\n\r\n            // Teacher free period rules\r\n            const staffMember = this.staff.find(s => s.name === subject.teacher);\r\n            if (staffMember) {\r\n                const dailyHours = (this.teacherDailyHours[subject.teacher]?.[day]) || 0;\r\n\r\n                if (staffMember.freePeriodMode === 'manual') {\r\n                    const maxDailyHours = this.PERIODS - (staffMember.manualFreePeriods || 0);\r\n                    if (dailyHours >= maxDailyHours) {\r\n                        continue;\r\n                    }\r\n                } else {\r\n                    // Auto mode: try to leave at least 1 free period per day\r\n                    if (dailyHours >= this.PERIODS - 1) {\r\n                        score -= 50;\r\n                        reasons.push('Auto: prefer leaving free period -50');\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Teacher load: avoid creating >3 consecutive teaching periods\r\n            const dayName = this.DAYS[dayIdx];\r\n            let prevRun = 0;\r\n            for (let p = period - 1; p >= 0; p--) {\r\n                const keyPrev = `${dayName}-P${p + 1}`;\r\n                if (this.teacherBusySlots[subject.teacher]?.[keyPrev]) prevRun++; else break;\r\n            }\r\n            let nextRun = 0;\r\n            for (let p = period + 1; p < this.PERIODS; p++) {\r\n                const keyNext = `${dayName}-P${p + 1}`;\r\n                if (this.teacherBusySlots[subject.teacher]?.[keyNext]) nextRun++; else break;\r\n            }\r\n            if (prevRun + 1 + nextRun > 3) {\r\n                score -= 40;\r\n                reasons.push('Avoid >3 consecutive teacher load -40');\r\n            }\r\n\r\n            candidates.push({ subject, score, reasons });\r\n        }\r\n\r\n        if (candidates.length > 0) {\r\n            const weighted = candidates.map(c => ({ item: c.subject, weight: Math.max(1, Math.round(c.score)) }));\r\n            const pick = this._weightedPick(weighted);\r\n            if (pick) return pick.item;\r\n        }\r\n\r\n        // Fallback: return any subject with remaining hours\r\n        const fallback = classSubjects.find(s => {\r\n            const key = `${className}-${s.name}`;\r\n            return s && this.subjectPlacementTracker[key]?.remaining > 0;\r\n        });\r\n\r\n        return fallback || null;\r\n    }\r\n\r\n    /**\r\n     * Place a subject in a specific slot\r\n     */\r\n    _placeSubject(className, dayIdx, period, subject, isLab, blockRemaining) {\r\n        if (!className || !subject || !subject.name || !subject.teacher) return;\r\n\r\n        const day = this.DAYS[dayIdx];\r\n        const slotKey = `${day}-P${period + 1}`;\r\n        const trackingKey = `${className}-${subject.name}`;\r\n\r\n        // Place in timetable\r\n        this.classTimetables[className][dayIdx][period] = {\r\n            subject: subject.name,\r\n            teacher: subject.teacher,\r\n            type: subject.subjectType || 'Core',\r\n            isLabContinuation: isLab,\r\n            blockRemaining: blockRemaining,\r\n            blockSize: subject.blockSize || 2\r\n        };\r\n\r\n        // Update tracking only once per lab block\r\n        if (!isLab || blockRemaining === (subject.blockSize || 2) - 1) {\r\n            const tracker = this.subjectPlacementTracker[trackingKey];\r\n            if (tracker) {\r\n                if (isLab) {\r\n                    tracker.remaining -= (subject.blockSize || 2);\r\n                    tracker.placed += (subject.blockSize || 2);\r\n                } else {\r\n                    tracker.remaining -= 1;\r\n                    tracker.placed += 1;\r\n                }\r\n                tracker.dailyCount[day] = (tracker.dailyCount[day] || 0) + 1;\r\n                tracker.lastPlacedSlot = dayIdx * this.PERIODS + period;\r\n            }\r\n        }\r\n\r\n        // Ensure teacher tracking is initialized\r\n        if (!this.teacherBusySlots[subject.teacher]) {\r\n            this.teacherBusySlots[subject.teacher] = {};\r\n        }\r\n        if (!this.teacherWeeklyHours[subject.teacher]) {\r\n            this.teacherWeeklyHours[subject.teacher] = 0;\r\n        }\r\n        if (!this.teacherDailyHours[subject.teacher]) {\r\n            this.teacherDailyHours[subject.teacher] = {};\r\n            this.DAYS.forEach(d => {\r\n                if (this.teacherDailyHours[subject.teacher][d] === undefined) {\r\n                    this.teacherDailyHours[subject.teacher][d] = 0;\r\n                }\r\n            });\r\n        }\r\n\r\n        // Mark teacher as busy\r\n        this.teacherBusySlots[subject.teacher][slotKey] = true;\r\n\r\n        // Update teacher hours\r\n        this.teacherWeeklyHours[subject.teacher] = (this.teacherWeeklyHours[subject.teacher] || 0) + 1;\r\n        this.teacherDailyHours[subject.teacher][day] = (this.teacherDailyHours[subject.teacher][day] || 0) + 1;\r\n\r\n        // Update subject period usage for vertical anti-pattern control\r\n        const subjUsage = this.subjectPeriodUsage[className][subject.name] || {};\r\n        subjUsage[period] = (subjUsage[period] || 0) + 1;\r\n        this.subjectPeriodUsage[className][subject.name] = subjUsage;\r\n\r\n        this.placements.push({\r\n            day: this.DAYS[dayIdx],\r\n            period: period + 1,\r\n            subject: subject.name,\r\n            teacher: subject.teacher,\r\n            type: isLab ? 'lab' : 'theory',\r\n            className\r\n        });\r\n    }\r\n\r\n    _isTeacherAvailable(teacherName, dayIdx, period) {\r\n        const day = this.DAYS[dayIdx];\r\n        const staffMember = this.staff.find(s => s.name === teacherName);\r\n        const availability = staffMember?.availability;\r\n        if (!availability) return true;\r\n        const daySlots = availability[day];\r\n        if (!Array.isArray(daySlots)) return true;\r\n        const v = daySlots[period];\r\n        if (v === undefined) return true;\r\n        return !!v;\r\n    }\r\n\r\n    _weightedPick(items) {\r\n        let total = 0;\r\n        for (const it of items) total += it.weight;\r\n        if (total <= 0) return null;\r\n        let r = this._rng() * total;\r\n        for (const it of items) {\r\n            if (r < it.weight) return it;\r\n            r -= it.weight;\r\n        }\r\n        return items[items.length - 1] || null;\r\n    }\r\n\r\n    /**\r\n     * Generate staff timetables from class timetables\r\n     */\r\n    _generateStaffTimetables() {\r\n        console.log('\\n Generating staff timetables...');\r\n\r\n        const staffMembers = this.staff.filter(s => s && s.role === 'staff');\r\n\r\n        // Initialize staff timetables with FREE periods\r\n        staffMembers.forEach(teacher => {\r\n            if (teacher && teacher.name) {\r\n                this.staffTimetables[teacher.name] = this.DAYS.map(() =>\r\n                    Array(this.PERIODS).fill(null).map(() => ({\r\n                        subject: 'FREE',\r\n                        class: '-',\r\n                        type: 'free'\r\n                    }))\r\n                );\r\n            }\r\n        });\r\n\r\n        // Fill in scheduled periods from class timetables\r\n        this.classes.forEach(cls => {\r\n            if (!cls || !cls.name || !this.classTimetables[cls.name]) return;\r\n\r\n            this.DAYS.forEach((day, dayIdx) => {\r\n                const daySchedule = this.classTimetables[cls.name][dayIdx];\r\n                if (!daySchedule) return;\r\n\r\n                daySchedule.forEach((slot, period) => {\r\n                    if (slot && slot.teacher && this.staffTimetables[slot.teacher]) {\r\n                        this.staffTimetables[slot.teacher][dayIdx][period] = {\r\n                            subject: slot.subject,\r\n                            class: cls.name,\r\n                            type: slot.type\r\n                        };\r\n                    }\r\n                });\r\n            });\r\n        });\r\n\r\n        console.log(' Staff timetables generated');\r\n    }\r\n}"],"names":["$parcel$export","e","n","v","s","Object","defineProperty","get","set","enumerable","configurable","parcelRequire","$parcel$global","globalThis","parcelRegister","register","module","exports","value","$9b678cdbbac6dec2$export$2e2bcd8739ae039","$ayMG0","$acw62","$aOD4d","$2A5UH","$4XiCD","$e3nvF","$hyYFF","$gqAsg","$bU9CP","$fAZ67","$6AR8M","$ilpIi","user","onLogout","sorted","groups","currentDept","cards","classes","setClasses","useState","departments","setDepartments","staff","setStaff","subjects","setSubjects","timetable","setTimetable","toasts","setToasts","loading","setLoading","showAddStaffForm","setShowAddStaffForm","showAddSubjectForm","setShowAddSubjectForm","showAddDepartmentForm","setShowAddDepartmentForm","showAddClassForm","setShowAddClassForm","staffFormRef","useRef","subjectFormRef","newClass","setNewClass","name","hallNumber","department","newStaff","setNewStaff","id","username","password","freePeriodMode","manualFreePeriods","newSubject","setNewSubject","className","subjectType","hoursPerWeek","isContinuous","blockSize","teacher","newDepartment","setNewDepartment","teachers","filter","role","showToast","message","type","duration","undoAction","newToast","Date","now","prev","setTimeout","removeToast","t","convertFlatToNested","flatTimetable","nested","keys","forEach","key","slots","Array","isArray","length","days","slot","day","period","subject","class","idx","p","undefined","fetchData","cls","st","sb","tt","dp","Promise","all","getDocs","collection","db","docs","map","doc","data","empty","ttData","convertedData","classTimetables","staffTimetables","error","console","useEffect","restoreFromUndo","undoItem","classData","setDoc","staffData","firebaseUid","subjectData","addClass","find","c","updateDoc","docRef","addDoc","editClass","window","scrollTo","top","behavior","addOrUpdateDepartment","trim","d","ref","editDepartment","dept","deleteDepartment","confirm","deleteDoc","deleteClass","classToDelete","addOrUpdateStaff","staffToUpdate","updateData","firestoreUpdateData","tempPassword","passwordLastChanged","toISOString","needsPasswordChange","resetStaffForm","email","uid","userCredential","createUserWithEmailAndPassword","auth","editStaff","staffMember","current","scrollIntoView","block","deleteStaff","staffToDelete","x","addOrUpdateSubject","resetSubjectForm","editSubject","deleteSubject","subjectToDelete","generateTimetable","generator","TimetableGenerator","validation","validate","valid","errors","result","generate","success","serializableClassTimetables","serializableStaffTimetables","dayIndex","periodIndex","flat","staffName","timetableData","generatedAt","ttRef","existing","staffTT","displayClassTimetables","displayStaffTimetables","document","getElementById","jsxs","Fragment","children","jsx","default","style","display","flexDirection","justifyContent","alignItems","height","color","fontSize","gap","onClick","textAlign","padding","classCount","title","marginTop","onChange","target","placeholder","sort","a","b","localeCompare","push","classSubjects","totalHours","reduce","sum","progress","marginBottom","flexWrap","margin","fontWeight","Math","max","width","backgroundColor","borderRadius","overflow","min","transition","toUpperCase","parseInt","sub","checked","htmlFor","disabled","exportToPDF","node","ToastContainer","onRemove","$e0e81a01ed643521$export$f2815235e76a62b9","$e0e81a01ed643521$export$8d8dc7d5f743331b","background","boxShadow","animation","marginLeft","border","cursor","lineHeight","position","right","zIndex","minWidth","maxWidth","toast","$511984d6a1a2608c$export$2e2bcd8739ae039","teachingHours","freePeriods","status","$0e552b1b7a884617$export$2e2bcd8739ae039","$0e552b1b7a884617$var$DAYS","grid","log","_","i","__esModule","toLowerCase","$81aa4954b90786d4$export$2e2bcd8739ae039","periods","staffSchedule","dayIdx","periodIdx","isFree","join","$a77c14b5958cefc4$export$21295ca23168aa6a","options","teacherBusySlots","teacherWeeklyHours","teacherDailyHours","teacherExpectedWeeklyHours","subjectPlacementTracker","placements","subjectPeriodUsage","labStartPositions","DAYS","PERIODS","TOTAL_WEEKLY_HOURS","dailyMaxPerSubject","seed","_rng","imul","classHours","hours","warnings","_initialize","_generateClassTimetable","_generateStaffTimetables","expected","actual","filled","row","diag","_computeDiagnosticsAndScore","score","diagnostics","violations","k","remaining","sameSubjectExcesses","dailyCount","labsAtEdges","insufficientSpread","bySubject","Set","add","usedDays","size","teacherOver3","run","notes","fill","staffMembers","warn","placed","lastPlacedSlot","_prePlaceLabs","prevSlot","isLabContinuation","blockRemaining","_placeSubject","bestSubject","_findBestSubject","canPlaceLab","slotKey","_isTeacherAvailable","labs","dayLabCount","lastLabDay","choices","canPlace","w","abs","teacherDaily","startsUsed","has","weight","pick","_weightedPick","s2","candidates","trackingKey","tracker","expectedWeekly","currentWeekly","reasons","usedCountSamePeriod","usageMap","prevSubj","s1","ps2","ps1","t0","t1","t2","continuousCount","labsToday","acc","existingSlots","distinctSubjects","sl","remainingRatio","round","dailyHours","dayName","prevRun","keyPrev","nextRun","keyNext","weighted","item","fallback","isLab","subjUsage","teacherName","availability","daySlots","items","total","it","r","daySchedule"],"version":3,"file":"AdminDashboard.a14ccb47.js.map"}
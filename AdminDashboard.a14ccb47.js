function e(e,s,a,t){Object.defineProperty(e,s,{get:a,set:t,enumerable:!0,configurable:!0})}var s=globalThis.parcelRequireb79f,a=s.register;a("dXtBz",function(a,t){Object.defineProperty(a.exports,"__esModule",{value:!0,configurable:!0}),e(a.exports,"default",()=>x);var i=s("ayMG0"),l=s("acw62"),r=s("aOD4d"),n=s("2A5UH"),c=s("4XiCD"),d=s("e3nvF"),o=s("hyYFF"),h=s("gqAsg"),m=s("bU9CP"),u=s("fAZ67"),b=s("6AR8M"),p=s("ilpIi");function x({user:e,onLogout:s}){let a,t,x,j,f,g,y,[N,v]=(0,l.useState)([]),[S,k]=(0,l.useState)([]),[C,P]=(0,l.useState)([]),[T,D]=(0,l.useState)([]),[w,E]=(0,l.useState)(null),[A,$]=(0,l.useState)([]),[F,O]=(0,l.useState)(!0),[W,R]=(0,l.useState)(!1),[M,H]=(0,l.useState)(!1),[I,_]=(0,l.useState)(!1),[U,Y]=(0,l.useState)(!1),L=(0,l.useRef)(null),z=(0,l.useRef)(null),[B,G]=(0,l.useState)({name:"",hallNumber:"",department:""}),[q,K]=(0,l.useState)({id:null,name:"",username:"",password:"",freePeriodMode:"auto",manualFreePeriods:0}),[V,X]=(0,l.useState)({id:null,className:"",name:"",subjectType:"Core",hoursPerWeek:6,isContinuous:!1,blockSize:2,teacher:""}),[J,Z]=(0,l.useState)({id:null,name:""}),Q=C.filter(e=>"staff"===e.role),ee=(e,s,a=3e3,t=null)=>{let i={message:e,type:s,id:Date.now(),undoAction:t};$(e=>[...e,i]),setTimeout(()=>es(i.id),a)},es=e=>{$(s=>s.filter(s=>s.id!==e))},ea=e=>{if(!e)return null;let s={};return Object.keys(e).forEach(a=>{let t=e[a];if(Array.isArray(t)&&t.length>0&&Array.isArray(t[0]))s[a]=t;else if(Array.isArray(t)){let e=[[],[],[],[],[]];t.forEach(s=>{s&&"number"==typeof s.day&&"number"==typeof s.period&&(e[s.day]||(e[s.day]=[]),e[s.day][s.period]={subject:s.subject,teacher:s.teacher,class:s.class,type:s.type})}),e.forEach((s,a)=>{e[a]||(e[a]=[]);for(let s=0;s<6;s++)e[a][s]||(e[a][s]=t[0]?.class!==void 0?{subject:"FREE",class:"-",type:"free"}:null)}),s[a]=e}}),s},et=async()=>{O(!0);try{let[e,s,a,t,i]=await Promise.all([(0,p.getDocs)((0,p.collection)(u.db,"classes")),(0,p.getDocs)((0,p.collection)(u.db,"staff")),(0,p.getDocs)((0,p.collection)(u.db,"subjects")),(0,p.getDocs)((0,p.collection)(u.db,"timetable")),(0,p.getDocs)((0,p.collection)(u.db,"departments"))]);if(v(e.docs.map(e=>({id:e.id,...e.data()}))),P(s.docs.map(e=>({id:e.id,...e.data()}))),D(a.docs.map(e=>({id:e.id,...e.data()}))),k(i.docs.map(e=>({id:e.id,...e.data()}))),!t.empty){let e=t.docs[0].data(),s={classTimetables:ea(e.classTimetables),staffTimetables:ea(e.staffTimetables)};E(s)}}catch(e){ee("âŒ Error loading data: "+e.message,"error"),console.error(e)}O(!1)};(0,l.useEffect)(()=>{et()},[]);let ei=async e=>{try{if("class"===e.type){let{id:s,...a}=e.data;await (0,p.setDoc)((0,p.doc)(u.db,"classes",s),a)}else if("staff"===e.type){let{id:s,...a}=e.data;await (0,p.setDoc)((0,p.doc)(u.db,"staff",s),a),e.data.firebaseUid&&await (0,p.setDoc)((0,p.doc)(u.db,"users",e.data.firebaseUid),{name:e.data.name,username:e.data.username,role:"staff"})}else if("subject"===e.type){let{id:s,...a}=e.data;await (0,p.setDoc)((0,p.doc)(u.db,"subjects",s),a)}await et(),ee("âœ… Data restored!","success")}catch(e){console.error("Restore error:",e),ee("âŒ Restore failed: "+e.message,"error")}},el=async()=>{if(!B.name)return ee("Enter class name","error");if(N.find(e=>e.name===B.name&&!B.id))return ee("Class already exists","error");try{if(B.id)await (0,p.updateDoc)((0,p.doc)(u.db,"classes",B.id),{name:B.name,hallNumber:B.hallNumber,department:B.department||""}),v(N.map(e=>e.id===B.id?{id:B.id,...B}:e)),ee("âœ… Class updated!","success");else{let e=await (0,p.addDoc)((0,p.collection)(u.db,"classes"),{name:B.name,hallNumber:B.hallNumber||"",department:B.department||""});v([...N,{id:e.id,name:B.name,hallNumber:B.hallNumber||"",department:B.department||""}]),ee("âœ… Class added!","success")}G({name:"",hallNumber:"",department:""})}catch(e){ee("âŒ Operation failed","error")}},er=e=>{G({id:e.id,name:e.name,hallNumber:e.hallNumber||"",department:e.department||""}),window.scrollTo({top:0,behavior:"smooth"})},en=async()=>{if(!J.name.trim())return ee("Enter department name","error");try{if(J.id)await (0,p.updateDoc)((0,p.doc)(u.db,"departments",J.id),{name:J.name}),k(S.map(e=>e.id===J.id?{...e,name:J.name}:e)),ee("âœ… Department updated!","success");else{let e=await (0,p.addDoc)((0,p.collection)(u.db,"departments"),{name:J.name});k([...S,{id:e.id,name:J.name}]),ee("âœ… Department added!","success")}Z({id:null,name:""})}catch(e){ee("âŒ Operation failed","error")}},ec=e=>{Z({id:e.id,name:e.name}),window.scrollTo({top:0,behavior:"smooth"})},ed=async e=>{if(window.confirm("Delete this department?"))try{await (0,p.deleteDoc)((0,p.doc)(u.db,"departments",e)),k(S.filter(s=>s.id!==e)),ee("âœ… Department deleted","success")}catch(e){ee("âŒ Failed to delete","error")}},eo=async e=>{if(window.confirm("Delete this class?"))try{let s=N.find(s=>s.id===e);if(!s)return;let a={type:"class",data:{...s}};await (0,p.deleteDoc)((0,p.doc)(u.db,"classes",e)),v(N.filter(s=>s.id!==e)),ee(`\u{2705} Class deleted`,"success",5e3,()=>ei(a))}catch(e){console.error("Delete error:",e),ee("âŒ Failed to delete","error")}},eh=async()=>{if(!q.name||!q.username)return ee("Fill all required fields","error");try{if(q.id){let e=C.find(e=>e.id===q.id),{password:s,...a}=q,t={name:a.name,freePeriodMode:a.freePeriodMode,manualFreePeriods:a.manualFreePeriods};e.username!==a.username&&(t.username=a.username),await (0,p.updateDoc)((0,p.doc)(u.db,"staff",q.id),t),e.firebaseUid&&await (0,p.updateDoc)((0,p.doc)(u.db,"users",e.firebaseUid),{name:q.name,username:q.username,role:"staff"}),s&&s.trim()?(await (0,p.updateDoc)((0,p.doc)(u.db,"staff",q.id),{tempPassword:s,passwordLastChanged:new Date().toISOString(),needsPasswordChange:!0}),ee("âœ… Temporary password set. Share it with staff.","success")):ee("âœ… Staff updated!","success"),P(C.map(e=>e.id===q.id?{...e,...t}:e)),eu(),R(!1);return}if(!q.password)return ee("Password required","error");let e=`${q.username}@timetable.com`,s=(await (0,b.createUserWithEmailAndPassword)(u.auth,e,q.password)).user.uid,a={name:q.name,username:q.username,freePeriodMode:q.freePeriodMode,manualFreePeriods:q.manualFreePeriods,role:"staff",firebaseUid:s},t=await (0,p.addDoc)((0,p.collection)(u.db,"staff"),a);await (0,p.setDoc)((0,p.doc)(u.db,"users",s),{name:q.name,username:q.username,role:"staff"}),P([...C,{id:t.id,...a}]),eu(),R(!1),ee("âœ… Staff added!","success")}catch(e){ee("âŒ Operation failed: "+e.message,"error"),console.error(e)}},em=e=>{K({...e,password:""}),R(!0),setTimeout(()=>{L.current?.scrollIntoView({behavior:"smooth",block:"center"})},100)},eu=()=>{K({id:null,name:"",username:"",password:"",freePeriodMode:"auto",manualFreePeriods:0})},eb=async e=>{if(window.confirm("Delete this staff member?"))try{let s=C.find(s=>s.id===e);if(!s)return;let a={type:"staff",data:{...s}};await (0,p.deleteDoc)((0,p.doc)(u.db,"staff",e)),s.firebaseUid&&await (0,p.deleteDoc)((0,p.doc)(u.db,"users",s.firebaseUid)),P(C.filter(s=>s.id!==e)),ee("âœ… Staff deleted","success",5e3,()=>ei(a))}catch(e){console.error("Delete staff error:",e),ee("âŒ Failed to delete","error")}},ep=async()=>{if(!V.className||!V.name||!V.teacher)return ee("Fill all required fields","error");try{let e={className:V.className,name:V.name,subjectType:V.subjectType,hoursPerWeek:V.hoursPerWeek,isContinuous:V.isContinuous,blockSize:V.blockSize,teacher:V.teacher};if(V.id)await (0,p.updateDoc)((0,p.doc)(u.db,"subjects",V.id),e),D(T.map(s=>s.id===V.id?{id:V.id,...e}:s)),ee("âœ… Subject updated!","success");else{let s=await (0,p.addDoc)((0,p.collection)(u.db,"subjects"),e);D([...T,{id:s.id,...e}]),ee("âœ… Subject added!","success")}ej(),H(!1)}catch(e){ee("âŒ Operation failed","error"),console.error(e)}},ex=e=>{X({id:e.id,className:e.className,name:e.name,subjectType:e.subjectType,hoursPerWeek:e.hoursPerWeek,isContinuous:e.isContinuous||!1,blockSize:e.blockSize||2,teacher:e.teacher}),H(!0),setTimeout(()=>{z.current?.scrollIntoView({behavior:"smooth",block:"center"})},100)},ej=()=>{X({id:null,className:"",name:"",subjectType:"Core",hoursPerWeek:6,isContinuous:!1,blockSize:2,teacher:""})},ef=async e=>{if(window.confirm("Delete this subject?"))try{let s=T.find(s=>s.id===e);if(!s)return;let a={type:"subject",data:{...s}};await (0,p.deleteDoc)((0,p.doc)(u.db,"subjects",e)),D(T.filter(s=>s.id!==e)),ee("âœ… Subject deleted","success",5e3,()=>ei(a))}catch(e){console.error("Delete subject error:",e),ee("âŒ Failed to delete","error")}},eg=async()=>{O(!0);try{let e=new(0,m.TimetableGenerator)(N,C.filter(e=>"staff"===e.role),T),s=e.validate();if(!s.valid){ee("âŒ Validation: "+s.errors[0],"error"),O(!1);return}let a=e.generate();if(a.success){let e={},s={};Object.keys(a.classTimetables).forEach(s=>{e[s]=a.classTimetables[s].map((e,s)=>e.map((e,a)=>({day:s,period:a,subject:e?.subject||null,teacher:e?.teacher||null,type:e?.type||null}))).flat()}),Object.keys(a.staffTimetables).forEach(e=>{s[e]=a.staffTimetables[e].map((e,s)=>e.map((e,a)=>({day:s,period:a,subject:e?.subject||null,class:e?.class||null,type:e?.type||null}))).flat()});let t={classTimetables:e,staffTimetables:s,generatedAt:new Date().toISOString()},i=(0,p.collection)(u.db,"timetable"),l=await (0,p.getDocs)(i);for(let e of(l.empty?await (0,p.addDoc)(i,t):await (0,p.updateDoc)((0,p.doc)(u.db,"timetable",l.docs[0].id),t),C.filter(e=>"staff"===e.role))){let a=s[e.name];a&&await (0,p.setDoc)((0,p.doc)(u.db,"staffTimetables",e.id),{staffName:e.name,timetable:a,generatedAt:new Date().toISOString()})}let r={};Object.keys(e).forEach(s=>{let a=[[],[],[],[],[]];e[s].forEach(e=>{a[e.day]||(a[e.day]=[]),a[e.day][e.period]={subject:e.subject,teacher:e.teacher,type:e.type}}),a.forEach((e,s)=>{a[s]||(a[s]=[]);for(let e=0;e<6;e++)a[s][e]||(a[s][e]=null)}),r[s]=a});let n={};Object.keys(s).forEach(e=>{let a=[[],[],[],[],[]];s[e].forEach(e=>{a[e.day]||(a[e.day]=[]),a[e.day][e.period]={subject:e.subject,class:e.class,type:e.type}}),a.forEach((e,s)=>{a[s]||(a[s]=[]);for(let e=0;e<6;e++)a[s][e]||(a[s][e]={subject:"FREE",class:"-",type:"free"})}),n[e]=a}),E({classTimetables:r,staffTimetables:n}),ee("âœ… Timetable generated & saved!","success"),setTimeout(()=>{document.getElementById("view-timetables")?.scrollIntoView({behavior:"smooth"})},1e3)}else ee("âŒ Failed: "+a.error,"error")}catch(e){ee("âŒ Error: "+e.message,"error"),console.error(e)}O(!1)};return F?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.default,{}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",color:"white",fontSize:"24px",gap:"20px"},children:[(0,i.jsx)("div",{className:"spinner"}),(0,i.jsx)("div",{children:"Loading..."})]})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.default,{}),(0,i.jsx)("div",{className:"min-h-screen relative z-10 text-white",children:(0,i.jsxs)("div",{className:"header-content",children:[(0,i.jsx)("h1",{children:"ðŸ« Admin Dashboard"}),(0,i.jsx)("div",{className:"header-actions",children:(0,i.jsx)("button",{className:"btn btn-danger btn-sm",onClick:s,children:"Logout"})})]})}),(0,i.jsxs)("div",{className:"content",children:[(0,i.jsxs)("div",{className:"section",children:[(0,i.jsxs)("div",{className:"section-header",children:[(0,i.jsx)("span",{className:"section-icon",children:"ðŸ¢"}),(0,i.jsx)("h2",{className:"section-title",children:"Manage Departments"})]}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsxs)("h3",{children:["Existing Departments (",S.length,")"]}),0===S.length?(0,i.jsx)("p",{style:{color:"#64748b",textAlign:"center",padding:"20px"},children:"No departments added yet"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"desktop-table",children:(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"#"}),(0,i.jsx)("th",{children:"Department"}),(0,i.jsx)("th",{children:"Classes"}),(0,i.jsx)("th",{children:"Actions"})]})}),(0,i.jsx)("tbody",{children:S.map((e,s)=>{let a=N.filter(s=>(s.department||"")===e.name).length;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:s+1}),(0,i.jsx)("td",{children:(0,i.jsx)("strong",{children:e.name})}),(0,i.jsx)("td",{children:a}),(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"action-buttons",children:[(0,i.jsx)("button",{className:"btn-icon btn-icon-primary",onClick:()=>{ec(e),_(!0)},title:"Edit",children:"âœï¸"}),(0,i.jsx)("button",{className:"btn-icon btn-icon-danger",onClick:()=>ed(e.id),title:"Delete",children:"ðŸ—‘ï¸"})]})})]},e.id)})})]})}),(0,i.jsx)("div",{className:"mobile-cards",children:S.map((e,s)=>{let a=N.filter(s=>(s.department||"")===e.name).length;return(0,i.jsxs)("div",{className:"mobile-card",children:[(0,i.jsxs)("div",{className:"mobile-card-header",children:[(0,i.jsx)("span",{className:"mobile-card-title",children:e.name}),(0,i.jsxs)("span",{className:"mobile-card-badge",children:["#",s+1]})]}),(0,i.jsx)("div",{className:"mobile-card-body",children:(0,i.jsxs)("div",{className:"mobile-card-row",children:[(0,i.jsx)("span",{className:"mobile-card-label",children:"Classes:"}),(0,i.jsx)("span",{className:"mobile-card-value",children:a})]})}),(0,i.jsxs)("div",{className:"mobile-card-actions",children:[(0,i.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>{ec(e),_(!0)},children:"âœï¸ Edit"}),(0,i.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>ed(e.id),children:"ðŸ—‘ï¸ Delete"})]})]},e.id)})})]}),(0,i.jsx)("button",{className:"btn btn-success btn-sm",onClick:()=>_(!0),style:{marginTop:"15px"},children:"âž• Add Department"})]}),I&&(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("h3",{children:J.id?"âœï¸ Edit Department":"âž• Add New Department"}),(0,i.jsx)("div",{className:"grid-2",children:(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Department Name *"}),(0,i.jsx)("input",{type:"text",value:J.name,onChange:e=>Z({...J,name:e.target.value}),placeholder:"Computer Science"})]})}),(0,i.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,i.jsx)("button",{className:"btn btn-primary",onClick:en,children:J.id?"ðŸ’¾ Save Changes":"âž• Add Department"}),(0,i.jsx)("button",{className:"btn btn-secondary",onClick:()=>{Z({id:null,name:""}),_(!1)},children:"âŒ Cancel"})]})]})]}),(0,i.jsxs)("div",{className:"section",children:[(0,i.jsxs)("div",{className:"section-header",children:[(0,i.jsx)("span",{className:"section-icon",children:"ðŸ“š"}),(0,i.jsx)("h2",{className:"section-title",children:"Manage Classes"})]}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsxs)("h3",{children:["Existing Classes (",N.length,")"]}),0===N.length?(0,i.jsx)("p",{style:{color:"#64748b",textAlign:"center",padding:"20px"},children:"No classes added yet"}):(0,i.jsxs)(i.Fragment,{children:[(a=[...N].sort((e,s)=>(e.department||"Unassigned").localeCompare(s.department||"Unassigned")||e.name.localeCompare(s.name)),t={},a.forEach(e=>{let s=e.department||"Unassigned";t[s]||(t[s]=[]),t[s].push(e)}),Object.keys(t).filter(e=>t[e].length>0).map(e=>(0,i.jsxs)("div",{className:"dept-group",children:[(0,i.jsx)("div",{className:"dept-chip",children:e}),t[e].map((e,s)=>{let a=T.filter(s=>s.className===e.name),t=a.reduce((e,s)=>e+s.hoursPerWeek,0),l=t/30*100;return(0,i.jsxs)("div",{className:"class-box",children:[(0,i.jsxs)("div",{style:{marginBottom:"8px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"10px",color:"#1e293b",flexWrap:"wrap"},children:[(0,i.jsxs)("h4",{style:{margin:0,display:"flex",alignItems:"center",gap:"8px"},children:["Class: ",(0,i.jsx)("strong",{children:e.name})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px",color:"#64748b",fontWeight:600},children:[(0,i.jsxs)("span",{children:[t,"/30 hours"]}),(0,i.jsxs)("span",{children:[Math.max(30-t,0),"h remaining"]})]})]}),(0,i.jsx)("div",{style:{width:"100%",height:"8px",backgroundColor:"#e2e8f0",borderRadius:"4px",overflow:"hidden",marginBottom:"15px"},children:(0,i.jsx)("div",{style:{height:"100%",width:`${Math.min(l,100)}%`,backgroundColor:30===t?"#10b981":"#f59e0b",transition:"width 0.3s ease"}})}),(0,i.jsx)("div",{className:"desktop-table",children:(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Hall Number"}),(0,i.jsx)("th",{children:"Subjects"}),(0,i.jsx)("th",{children:"Hours"}),(0,i.jsx)("th",{children:"Actions"})]})}),(0,i.jsx)("tbody",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.hallNumber||"-"}),(0,i.jsx)("td",{children:a.length}),(0,i.jsx)("td",{children:(0,i.jsxs)("span",{className:`badge ${30===t?"badge-success":"badge-danger"}`,children:[t,"/30h"]})}),(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"action-buttons",children:[(0,i.jsx)("button",{className:"btn-icon btn-icon-primary",onClick:()=>{er(e),Y(!0)},title:"Edit",children:"âœï¸"}),(0,i.jsx)("button",{className:"btn-icon btn-icon-danger",onClick:()=>eo(e.id),title:"Delete",children:"ðŸ—‘ï¸"})]})})]})})]})})]},e.id)})]},`dept-classes-${e}`))),(0,i.jsx)("div",{className:"mobile-cards",children:(x=[...N].sort((e,s)=>(e.department||"Unassigned").localeCompare(s.department||"Unassigned")||e.name.localeCompare(s.name)),j=null,f=[],x.forEach((e,s)=>{let a=e.department||"Unassigned",t=T.filter(s=>s.className===e.name),l=t.reduce((e,s)=>e+s.hoursPerWeek,0);a!==j&&(j=a,f.push((0,i.jsx)("div",{className:"group-header",style:{fontWeight:700,margin:"10px 0"},children:a},`dept-mobile-${a}`))),f.push((0,i.jsxs)("div",{className:"mobile-card",children:[(0,i.jsxs)("div",{className:"mobile-card-header",children:[(0,i.jsx)("span",{className:"mobile-card-title",children:e.name}),(0,i.jsxs)("span",{className:"mobile-card-badge",children:["#",s+1]})]}),(0,i.jsxs)("div",{className:"mobile-card-body",children:[(0,i.jsxs)("div",{className:"mobile-card-row",children:[(0,i.jsx)("span",{className:"mobile-card-label",children:"Hall:"}),(0,i.jsx)("span",{className:"mobile-card-value",children:e.hallNumber||"-"})]}),(0,i.jsxs)("div",{className:"mobile-card-row",children:[(0,i.jsx)("span",{className:"mobile-card-label",children:"Subjects:"}),(0,i.jsx)("span",{className:"mobile-card-value",children:t.length})]}),(0,i.jsxs)("div",{className:"mobile-card-row",children:[(0,i.jsx)("span",{className:"mobile-card-label",children:"Hours:"}),(0,i.jsxs)("span",{className:"mobile-card-value",children:[l,"/30h"]})]})]}),(0,i.jsxs)("div",{className:"mobile-card-actions",children:[(0,i.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>{er(e),Y(!0)},children:"âœï¸ Edit"}),(0,i.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>eo(e.id),children:"ðŸ—‘ï¸ Delete"})]})]},e.id))}),f)})]}),(0,i.jsx)("button",{className:"btn btn-success btn-sm",onClick:()=>{Y(!0),G({id:null,name:"",hallNumber:"",department:""})},style:{marginTop:"15px"},children:"âž• Add Class"})]}),U&&(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("h3",{children:B.id?"âœï¸ Edit Class":"âž• Add New Class"}),(0,i.jsxs)("div",{className:"grid-2",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Class Name *"}),(0,i.jsx)("input",{type:"text",value:B.name,onChange:e=>G({...B,name:e.target.value.toUpperCase()}),placeholder:"CS3A, EE2B"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Hall Number (Optional)"}),(0,i.jsx)("input",{type:"text",value:B.hallNumber,onChange:e=>G({...B,hallNumber:e.target.value}),placeholder:"Hall 101"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Department"}),(0,i.jsxs)("select",{value:B.department,onChange:e=>G({...B,department:e.target.value}),children:[(0,i.jsx)("option",{value:"",children:"Unassigned"}),S.map(e=>(0,i.jsx)("option",{value:e.name,children:e.name},e.id))]})]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,i.jsx)("button",{className:"btn btn-primary",onClick:el,children:B.id?"ðŸ’¾ Update Class":"âž• Add Class"}),(0,i.jsx)("button",{className:"btn btn-secondary",onClick:()=>{G({name:"",hallNumber:"",department:""}),Y(!1)},children:"âŒ Cancel"})]})]})]}),(0,i.jsxs)("div",{className:"section",children:[(0,i.jsxs)("div",{className:"section-header",children:[(0,i.jsx)("span",{className:"section-icon",children:"ðŸ‘¥"}),(0,i.jsx)("h2",{className:"section-title",children:"Manage Staff"})]}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsxs)("h3",{children:["Existing Staff (",Q.length,")"]}),0===Q.length?(0,i.jsx)("p",{style:{color:"#64748b",textAlign:"center",padding:"20px"},children:"No staff added yet"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"desktop-table",children:(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"S.No"}),(0,i.jsx)("th",{children:"Name"}),(0,i.jsx)("th",{children:"Username"}),(0,i.jsx)("th",{children:"Free Periods"}),(0,i.jsx)("th",{children:"Actions"})]})}),(0,i.jsx)("tbody",{children:Q.map((e,s)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsxs)("span",{className:"staff-badge",children:["S",s+1]})}),(0,i.jsx)("td",{children:(0,i.jsx)("strong",{children:e.name})}),(0,i.jsx)("td",{children:e.username}),(0,i.jsx)("td",{children:"manual"===e.freePeriodMode?`Manual (${e.manualFreePeriods} free periods)`:"Auto"}),(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"action-buttons",children:[(0,i.jsx)("button",{className:"btn-icon btn-icon-primary",onClick:()=>em(e),title:"Edit",children:"âœï¸"}),(0,i.jsx)("button",{className:"btn-icon btn-icon-danger",onClick:()=>eb(e.id),title:"Delete",children:"ðŸ—‘ï¸"})]})})]},e.id))})]})}),(0,i.jsx)("div",{className:"mobile-cards",children:Q.map((e,s)=>(0,i.jsxs)("div",{className:"mobile-card",children:[(0,i.jsxs)("div",{className:"mobile-card-header",children:[(0,i.jsx)("span",{className:"mobile-card-title",children:e.name}),(0,i.jsxs)("span",{className:"mobile-card-badge",children:["S",s+1]})]}),(0,i.jsxs)("div",{className:"mobile-card-body",children:[(0,i.jsxs)("div",{className:"mobile-card-row",children:[(0,i.jsx)("span",{className:"mobile-card-label",children:"Username:"}),(0,i.jsx)("span",{className:"mobile-card-value",children:e.username})]}),(0,i.jsxs)("div",{className:"mobile-card-row",children:[(0,i.jsx)("span",{className:"mobile-card-label",children:"Free Periods:"}),(0,i.jsx)("span",{className:"mobile-card-value",children:"manual"===e.freePeriodMode?`Manual (${e.manualFreePeriods} free periods)`:"Auto"})]})]}),(0,i.jsxs)("div",{className:"mobile-card-actions",children:[(0,i.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>em(e),children:"âœï¸ Edit"}),(0,i.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>eb(e.id),children:"ðŸ—‘ï¸ Delete"})]})]},e.id))})]}),(0,i.jsx)("button",{className:"btn btn-success btn-sm",onClick:()=>{R(!0),eu()},style:{marginTop:"15px"},children:"âž• Add Staff"})]}),W&&(0,i.jsxs)("div",{className:"card",ref:L,children:[(0,i.jsx)("h3",{children:q.id?"âœï¸ Edit Staff":"âž• Add New Staff"}),(0,i.jsxs)("div",{className:"grid-2",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Full Name *"}),(0,i.jsx)("input",{type:"text",placeholder:"Dr. John Doe",value:q.name,onChange:e=>K({...q,name:e.target.value})})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Username *"}),(0,i.jsx)("input",{type:"text",placeholder:"john",value:q.username,onChange:e=>K({...q,username:e.target.value})})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsxs)("label",{children:[q.id?"New Password (Optional)":"Password"," *"]}),(0,i.jsx)("input",{type:"password",placeholder:q.id?"Leave blank to keep current":"Enter password",value:q.password,onChange:e=>K({...q,password:e.target.value})}),q.id&&(0,i.jsx)("small",{style:{color:"#64748b",display:"block",marginTop:"4px"},children:"âœ“ Staff can use new password immediately on next login"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Free Period Mode"}),(0,i.jsxs)("select",{value:q.freePeriodMode,onChange:e=>K({...q,freePeriodMode:e.target.value}),children:[(0,i.jsx)("option",{value:"auto",children:"Auto"}),(0,i.jsx)("option",{value:"manual",children:"Manual"})]})]})]}),"manual"===q.freePeriodMode&&(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Free Periods per Week"}),(0,i.jsx)("input",{type:"number",min:"0",max:"30",value:q.manualFreePeriods,onChange:e=>K({...q,manualFreePeriods:parseInt(e.target.value)||0})})]}),(0,i.jsxs)("div",{className:"button-group",children:[(0,i.jsx)("button",{className:"btn btn-primary",onClick:eh,children:q.id?"ðŸ’¾ Save Changes":"âž• Add Staff"}),(0,i.jsx)("button",{className:"btn btn-secondary",onClick:()=>{eu(),R(!1)},children:"âŒ Cancel"})]})]})]}),(0,i.jsxs)("div",{className:"section",id:"subject-section",children:[(0,i.jsxs)("div",{className:"section-header",children:[(0,i.jsx)("span",{className:"section-icon",children:"ðŸ“–"}),(0,i.jsx)("h2",{className:"section-title",children:"Manage Subjects"})]}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsxs)("h3",{children:["Existing Subjects (",T.length,")"]}),0===T.length?(0,i.jsx)("p",{style:{color:"#64748b",textAlign:"center",padding:"20px"},children:"No subjects added yet"}):(0,i.jsx)(i.Fragment,{children:N.map(e=>{let s=T.filter(s=>s.className===e.name);if(0===s.length)return null;let a=s.reduce((e,s)=>e+s.hoursPerWeek,0),t=a/30*100;return(0,i.jsxs)("div",{style:{marginBottom:"30px"},children:[(0,i.jsxs)("div",{style:{marginBottom:"8px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"10px",color:"#1e293b",flexWrap:"wrap"},children:[(0,i.jsxs)("h4",{style:{margin:0,display:"flex",alignItems:"center",gap:"8px"},children:["Class: ",(0,i.jsx)("strong",{children:e.name})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px",color:"#64748b",fontWeight:600},children:[(0,i.jsxs)("span",{children:[a,"/30 hours"]}),(0,i.jsxs)("span",{children:[Math.max(30-a,0),"h remaining"]})]})]}),(0,i.jsx)("div",{style:{width:"100%",height:"8px",backgroundColor:"#e2e8f0",borderRadius:"4px",overflow:"hidden",marginBottom:"15px"},children:(0,i.jsx)("div",{style:{height:"100%",width:`${Math.min(t,100)}%`,backgroundColor:30===a?"#10b981":"#f59e0b",transition:"width 0.3s ease"}})}),(0,i.jsx)("div",{className:"desktop-table",children:(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Subject"}),(0,i.jsx)("th",{children:"Type"}),(0,i.jsx)("th",{children:"Hours"}),(0,i.jsx)("th",{children:"Teacher"}),(0,i.jsx)("th",{children:"Continuous"}),(0,i.jsx)("th",{children:"Actions"})]})}),(0,i.jsx)("tbody",{children:s.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)("strong",{children:e.name})}),(0,i.jsx)("td",{children:e.subjectType}),(0,i.jsxs)("td",{children:[e.hoursPerWeek,"h"]}),(0,i.jsx)("td",{children:e.teacher}),(0,i.jsx)("td",{children:e.isContinuous?`Yes (${e.blockSize}p)`:"No"}),(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"action-buttons",children:[(0,i.jsx)("button",{className:"btn-icon btn-icon-primary",onClick:()=>ex(e),title:"Edit",children:"âœï¸"}),(0,i.jsx)("button",{className:"btn-icon btn-icon-danger",onClick:()=>ef(e.id),title:"Delete",children:"ðŸ—‘ï¸"})]})})]},e.id))})]})}),(0,i.jsx)("div",{className:"mobile-cards",children:s.map(e=>(0,i.jsxs)("div",{className:"mobile-card",children:[(0,i.jsxs)("div",{className:"mobile-card-header",children:[(0,i.jsx)("span",{className:"mobile-card-title",children:e.name}),(0,i.jsx)("span",{className:"mobile-card-badge",children:e.subjectType})]}),(0,i.jsxs)("div",{className:"mobile-card-body",children:[(0,i.jsxs)("div",{className:"mobile-card-row",children:[(0,i.jsx)("span",{className:"mobile-card-label",children:"Hours:"}),(0,i.jsxs)("span",{className:"mobile-card-value",children:[e.hoursPerWeek,"h"]})]}),(0,i.jsxs)("div",{className:"mobile-card-row",children:[(0,i.jsx)("span",{className:"mobile-card-label",children:"Teacher:"}),(0,i.jsx)("span",{className:"mobile-card-value",children:e.teacher})]}),(0,i.jsxs)("div",{className:"mobile-card-row",children:[(0,i.jsx)("span",{className:"mobile-card-label",children:"Continuous:"}),(0,i.jsx)("span",{className:"mobile-card-value",children:e.isContinuous?`Yes (${e.blockSize}p)`:"No"})]})]}),(0,i.jsxs)("div",{className:"mobile-card-actions",children:[(0,i.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>ex(e),children:"âœï¸ Edit"}),(0,i.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>ef(e.id),children:"ðŸ—‘ï¸ Delete"})]})]},e.id))})]},e.id)})}),(0,i.jsx)("button",{className:"btn btn-success btn-sm",onClick:()=>{H(!0),ej()},style:{marginTop:"15px"},children:"âž• Add Subject"})]}),M&&(0,i.jsxs)("div",{className:"card",ref:z,children:[(0,i.jsx)("h3",{children:V.id?"âœï¸ Edit Subject":"âž• Add New Subject"}),V.className&&(0,i.jsx)(c.default,{className:V.className,subjects:T}),(0,i.jsxs)("div",{className:"grid-2",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Select Class *"}),(0,i.jsxs)("select",{value:V.className,onChange:e=>X({...V,className:e.target.value}),children:[(0,i.jsx)("option",{value:"",children:"-- Select Class --"}),N.map(e=>(0,i.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Subject Name *"}),(0,i.jsx)("input",{type:"text",value:V.name,onChange:e=>X({...V,name:e.target.value}),placeholder:"DBMS, AI Lab, etc."})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Subject Type *"}),(0,i.jsxs)("select",{value:V.subjectType,onChange:e=>X({...V,subjectType:e.target.value}),children:[(0,i.jsx)("option",{value:"Core",children:"Core"}),(0,i.jsx)("option",{value:"Elective",children:"Elective"}),(0,i.jsx)("option",{value:"Lab",children:"Lab"}),(0,i.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Hours per Week *"}),(0,i.jsx)("input",{type:"number",min:"1",max:"30",value:V.hoursPerWeek,onChange:e=>X({...V,hoursPerWeek:parseInt(e.target.value)||6})})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Teacher *"}),(0,i.jsxs)("select",{value:V.teacher,onChange:e=>X({...V,teacher:e.target.value}),children:[(0,i.jsx)("option",{value:"",children:"-- Select Teacher --"}),Q.map(e=>(0,i.jsx)("option",{value:e.name,children:e.name},e.id))]})]})]}),(0,i.jsxs)("div",{className:"checkbox-group",children:[(0,i.jsx)("input",{type:"checkbox",id:"continuous",checked:V.isContinuous,onChange:e=>X({...V,isContinuous:e.target.checked})}),(0,i.jsx)("label",{htmlFor:"continuous",style:{marginBottom:0},children:"Continuous Period (Lab)"})]}),V.isContinuous&&(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Block Size"}),(0,i.jsxs)("select",{value:V.blockSize,onChange:e=>X({...V,blockSize:parseInt(e.target.value)}),children:[(0,i.jsx)("option",{value:2,children:"2 Periods"}),(0,i.jsx)("option",{value:3,children:"3 Periods"})]})]}),(0,i.jsxs)("div",{className:"button-group",children:[(0,i.jsx)("button",{className:"btn btn-primary",onClick:ep,children:V.id?"ðŸ’¾ Save Changes":"âž• Add Subject"}),(0,i.jsx)("button",{className:"btn btn-secondary",onClick:()=>{ej(),H(!1)},children:"âŒ Cancel"})]})]})]}),(0,i.jsxs)("div",{className:"section",children:[(0,i.jsxs)("div",{className:"section-header",children:[(0,i.jsx)("span",{className:"section-icon",children:"âš¡"}),(0,i.jsx)("h2",{className:"section-title",children:"Generate Timetable"})]}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("h3",{children:"Ready to Generate"}),(0,i.jsxs)("div",{className:"stats-grid",children:[(0,i.jsxs)("div",{className:"stat-card stat-primary",children:[(0,i.jsx)("div",{className:"stat-label",children:"Classes"}),(0,i.jsx)("div",{className:"stat-value",children:N.length})]}),(0,i.jsxs)("div",{className:"stat-card stat-success",children:[(0,i.jsx)("div",{className:"stat-label",children:"Teachers"}),(0,i.jsx)("div",{className:"stat-value",children:Q.length})]}),(0,i.jsxs)("div",{className:"stat-card stat-warning",children:[(0,i.jsx)("div",{className:"stat-label",children:"Subjects"}),(0,i.jsx)("div",{className:"stat-value",children:T.length})]})]}),(0,i.jsx)("button",{className:"btn btn-success btn-lg",onClick:eg,disabled:F,children:F?"â³ Generating...":"âš¡ Generate Timetable"})]})]}),w&&(0,i.jsxs)("div",{className:"section",id:"view-timetables",children:[(0,i.jsxs)("div",{className:"section-header",children:[(0,i.jsx)("span",{className:"section-icon",children:"ðŸ“Š"}),(0,i.jsx)("h2",{className:"section-title",children:"Generated Timetables"})]}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("h3",{children:"Time Tables"}),(g=[...N].sort((e,s)=>(e.department||"Unassigned").localeCompare(s.department||"Unassigned")||e.name.localeCompare(s.name)),y={},g.forEach(e=>{let s=e.department||"Unassigned";y[s]||(y[s]=[]),y[s].push((0,i.jsxs)("div",{className:"timetable-container",id:`timetable-export-${e.id}`,children:[(0,i.jsx)("h4",{className:"timetable-title",children:e.name}),(0,i.jsx)("div",{className:"timetable-scroll",children:(0,i.jsx)(d.default,{timetable:w.classTimetables,className:e.name})}),(0,i.jsx)("div",{className:"timetable-actions no-print no-export",children:(0,i.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>(0,h.exportToPDF)(`timetable-export-${e.id}`,`${e.name}_Timetable.pdf`,{title:e.name}),children:"ðŸ“„ Download PDF"})})]},e.id))}),Object.keys(y).filter(e=>y[e].length>0).map(e=>(0,i.jsxs)("div",{className:"dept-group",children:[(0,i.jsx)("div",{className:"dept-chip",children:e}),y[e].map(e=>(0,i.jsx)("div",{className:"class-box",children:e},e.key))]},`dept-block-${e}`)))]}),(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("h3",{children:"Staff-wise Timetables"}),[...Q].sort((e,s)=>e.name.localeCompare(s.name)).map(e=>(0,i.jsxs)("div",{className:"timetable-container",id:`staff-timetable-export-${e.id}`,children:[(0,i.jsxs)("h4",{className:"timetable-title",children:["Teacher: ",e.name]}),(0,i.jsx)("div",{className:"timetable-scroll",children:(0,i.jsx)(o.default,{timetable:w.staffTimetables,staffName:e.name})}),(0,i.jsx)("div",{className:"timetable-actions no-print no-export",children:(0,i.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>(0,h.exportToPDF)(`staff-timetable-export-${e.id}`,`${e.name}_Timetable.pdf`,{title:`Staff Timetable \u{2014} ${e.name}`}),children:"ðŸ“„ Download PDF"})})]},e.id))]})]})]}),(0,i.jsx)(n.ToastContainer,{toasts:A,onRemove:es})]})}}),a("2A5UH",function(a,t){e(a.exports,"ToastContainer",()=>r);var i=s("ayMG0");s("acw62");let l=({id:e,message:s,type:a,onRemove:t,undoAction:l})=>(0,i.jsxs)("div",{style:{padding:"12px 16px",borderRadius:"8px",marginBottom:"10px",background:"error"===a?"#ff4444":"success"===a?"#00C851":"#ffbb33",color:"white",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",animation:"slideIn 0.3s ease-out"},children:[(0,i.jsx)("span",{children:s}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px",marginLeft:"16px"},children:[l&&(0,i.jsx)("button",{onClick:()=>{"function"==typeof l&&l(),"function"==typeof t&&t(e)},style:{background:"white",color:"success"===a?"#00C851":"#333",border:"none",padding:"4px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:"UNDO"}),(0,i.jsx)("button",{onClick:()=>{"function"==typeof t&&t(e)},style:{background:"transparent",border:"none",color:"white",cursor:"pointer",fontSize:"18px",padding:"0 4px",lineHeight:"1"},title:"Close",children:"Ã—"})]})]}),r=({toasts:e,onRemove:s})=>(0,i.jsx)("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:9999,minWidth:"300px",maxWidth:"500px"},children:e.map(e=>(0,i.jsx)(l,{id:e.id,message:e.message,type:e.type,onRemove:s,undoAction:e.undoAction},e.id))})}),a("4XiCD",function(a,t){e(a.exports,"default",()=>l);var i=s("ayMG0");function l({timetable:e,staff:s}){if(!e||!e.staffTimetables)return null;let a=s.filter(e=>"staff"===e.role);return(0,i.jsxs)("div",{style:{marginBottom:"30px"},children:[(0,i.jsx)("h3",{style:{marginBottom:"15px"},children:"ðŸ“Š Staff Hours Summary"}),(0,i.jsxs)("table",{className:"data-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Staff Name"}),(0,i.jsx)("th",{children:"Teaching Hours"}),(0,i.jsx)("th",{children:"Free Periods"}),(0,i.jsx)("th",{children:"Status"})]})}),(0,i.jsx)("tbody",{children:a.map(s=>{let a=e.staffTimetables[s.name];if(!a)return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:s.name}),(0,i.jsx)("td",{children:"0"}),(0,i.jsx)("td",{children:"30"}),(0,i.jsx)("td",{children:"âš ï¸ Not Assigned"})]},s.id);let t=0,l=0;a.forEach(e=>{e.forEach(e=>{e&&"free"!==e.type?t++:l++})});let r=t>=24?"âœ… Full Load":t>=18?"âš¡ Good":t>0?"âš ï¸ Low Load":"âŒ No Classes";return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:s.name}),(0,i.jsxs)("td",{children:[t,"/30"]}),(0,i.jsxs)("td",{children:[l,"/30"]}),(0,i.jsx)("td",{children:r})]},s.id)})})]})]})}s("acw62")}),a("e3nvF",function(a,t){e(a.exports,"default",()=>n);var i=s("ayMG0"),l=s("acw62");let r=["Monday","Tuesday","Wednesday","Thursday","Friday"];function n({timetable:e,className:s}){if(!e||!e[s])return(0,i.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#64748b"},children:"No timetable available"});let a=e[s];return(console.log("TimetableGrid - className:",s),console.log("TimetableGrid - grid:",a),console.log("TimetableGrid - grid is array?",Array.isArray(a)),Array.isArray(a)&&0!==a.length)?(0,i.jsxs)("div",{id:"timetable-export",className:"timetable-grid",children:[(0,i.jsx)("div",{className:"timetable-header",children:"Day/Period"}),[...Array(6)].map((e,s)=>(0,i.jsxs)("div",{className:"timetable-header",children:["P",s+1]},s)),r.map((e,s)=>a[s]&&Array.isArray(a[s])?(0,i.jsxs)((l&&l.__esModule?l.default:l).Fragment,{children:[(0,i.jsx)("div",{className:"timetable-day",children:e}),a[s].map((e,s)=>(0,i.jsx)("div",{className:`timetable-cell subject-${e&&e.type?e.type.toLowerCase():"free"}`,children:e&&"FREE"!==e.subject?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"subject-name",children:e.subject}),(0,i.jsx)("div",{className:"teacher-name",children:e.teacher})]}):(0,i.jsx)("div",{style:{color:"#94a3b8"},children:"FREE"})},s))]},e):null)]}):(0,i.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#64748b"},children:"Invalid timetable format"})}}),a("hyYFF",function(a,t){e(a.exports,"default",()=>l);var i=s("ayMG0");function l({timetable:e,staffName:s}){let a=["P1","P2","P3","P4","P5","P6"],t=e[s];return(console.log("StaffTimetableGrid - Staff:",s),console.log("StaffTimetableGrid - Available:",Object.keys(e)),t)?(0,i.jsx)("div",{className:"timetable-container",id:"staff-timetable-export",children:(0,i.jsxs)("table",{className:"timetable",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"day-header",children:"DAY/PERIOD"}),a.map(e=>(0,i.jsx)("th",{className:"period-header",children:e},e))]})}),(0,i.jsx)("tbody",{children:["Monday","Tuesday","Wednesday","Thursday","Friday"].map((e,s)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"day-cell",children:e}),a.map((e,a)=>{let l=t[s]?.[a],r=!l||"free"===l.type||"FREE"===l.subject;return(0,i.jsx)("td",{className:`period-cell ${r?"free-period":"class-period"}`,children:r?(0,i.jsx)("div",{className:"period-content free",children:(0,i.jsx)("span",{className:"subject-name",children:"FREE"})}):(0,i.jsxs)("div",{className:"period-content",children:[(0,i.jsx)("span",{className:"subject-name",children:l.subject}),(0,i.jsx)("span",{className:"class-name",children:l.class})]})},e)})]},e))})]})}):(0,i.jsxs)("div",{style:{padding:"40px",textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"âš ï¸"}),(0,i.jsx)("h3",{children:"No Timetable Found"}),(0,i.jsxs)("p",{style:{color:"#64748b"},children:['No timetable for "',s,'"']}),(0,i.jsxs)("p",{style:{color:"#64748b",fontSize:"14px"},children:["Available: ",Object.keys(e).join(", ")]})]})}s("acw62")}),a("bU9CP",function(s,a){e(s.exports,"TimetableGenerator",()=>t);class t{constructor(e,s,a,t={}){let i;this.classes=e||[],this.staff=s||[],this.subjects=a||[],this.options=t||{},this.classTimetables={},this.staffTimetables={},this.teacherBusySlots={},this.teacherWeeklyHours={},this.teacherDailyHours={},this.teacherExpectedWeeklyHours={},this.subjectPlacementTracker={},this.placements=[],this.subjectPeriodUsage={},this.labStartPositions={},this.DAYS=["Monday","Tuesday","Wednesday","Thursday","Friday"],this.PERIODS=6,this.TOTAL_WEEKLY_HOURS=30,this.dailyMaxPerSubject="number"==typeof this.options.dailyMaxPerSubject?this.options.dailyMaxPerSubject:2;let l="number"==typeof this.options.seed?this.options.seed:0x75bcd15;this._rng=(i=l>>>0,()=>{let e=i+=0x6d2b79f5;return e=Math.imul(e^e>>>15,1|e),(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/0x100000000})}validate(){let e=[];if(this.classes&&0!==this.classes.length||e.push("No classes added"),this.staff&&0!==this.staff.filter(e=>"staff"===e.role).length||e.push("No staff added"),this.subjects&&0!==this.subjects.length||e.push("No subjects added"),e.length>0)return{valid:!1,errors:e};let s={};return(this.subjects.forEach(e=>{e&&e.className&&e.hoursPerWeek&&(s[e.className]=(s[e.className]||0)+e.hoursPerWeek)}),this.classes.forEach(a=>{if(a&&a.name){let t=s[a.name]||0;t!==this.TOTAL_WEEKLY_HOURS&&e.push(`Class ${a.name} must have exactly ${this.TOTAL_WEEKLY_HOURS} hours (current: ${t}).`)}}),e.length>0)?{valid:!1,errors:e}:{valid:!0,warnings:[]}}generate(){try{for(let e of(console.log("ðŸš€ Starting intelligent timetable generation..."),this._initialize(),this.classes))if(e&&e.name&&(console.log(`
\u{1F4CB} Generating timetable for ${e.name}`),!this._generateClassTimetable(e.name)))return{success:!1,error:`Failed to generate complete timetable for ${e.name}`};this._generateStaffTimetables();let e=[];Object.keys(this.teacherExpectedWeeklyHours).forEach(s=>{let a=this.teacherExpectedWeeklyHours[s]||0,t=this.teacherWeeklyHours[s]||0;t!==a&&e.push(`Teacher ${s} scheduled ${t}/${a} hours.`)}),this.classes.forEach(s=>{if(!s||!s.name)return;let a=0;this.DAYS.forEach((e,t)=>{(this.classTimetables[s.name]?.[t]||[]).forEach(e=>{e&&a++})}),a!==this.TOTAL_WEEKLY_HOURS&&e.push(`Class ${s.name} filled ${a}/${this.TOTAL_WEEKLY_HOURS} periods.`)}),console.log("\nâœ… Timetable generation completed successfully");let s=this._computeDiagnosticsAndScore();return{success:!0,classTimetables:this.classTimetables,staffTimetables:this.staffTimetables,placements:this.placements,score:s.score,diagnostics:s.diagnostics,warnings:e}}catch(e){return console.error("âŒ Error generating timetable:",e),{success:!1,error:`Error: ${e.message||"Unknown error"}`}}}_computeDiagnosticsAndScore(){let e=[];Object.keys(this.subjectPlacementTracker).forEach(s=>{let a=this.subjectPlacementTracker[s];a&&0!==a.remaining&&e.push(`Subject ${s} remaining ${a.remaining}`)});let s=0;Object.keys(this.subjectPlacementTracker).forEach(e=>{let a=this.subjectPlacementTracker[e];a&&this.DAYS.forEach(e=>{let t=a.dailyCount[e]||0;t>this.dailyMaxPerSubject&&(s+=t-this.dailyMaxPerSubject)})});let a=0;for(let e of this.placements)"lab"===e.type&&(1===e.period||e.period===this.PERIODS)&&a++;let t=0,i={};for(let e of this.placements){let s=`${e.className}-${e.subject}`;i[s]=i[s]||new Set,i[s].add(e.day)}this.subjects.forEach(e=>{if(e&&e.name&&(e.hoursPerWeek||0)>=4){let s=`${e.className}-${e.name}`;3>(i[s]?.size||0)&&t++}});let l=0;return Object.keys(this.staffTimetables).forEach(e=>{let s=this.staffTimetables[e];if(s)for(let e=0;e<this.DAYS.length;e++){let a=0;for(let t=0;t<this.PERIODS;t++){let i=s[e][t];i&&"FREE"!==i.subject?a++:(a>3&&(l+=a-3),a=0)}a>3&&(l+=a-3)}}),{score:1e3-500*e.length-10*s-5*a-2*t-l,diagnostics:{violations:e,notes:[]}}}_initialize(){console.log("âš™ï¸ Initializing timetables..."),this.classes.forEach(e=>{e&&e.name&&(this.classTimetables[e.name]=this.DAYS.map(()=>Array(this.PERIODS).fill(null)))}),this.staff.filter(e=>e&&"staff"===e.role).forEach(e=>{e&&e.name&&(this.teacherBusySlots[e.name]={},this.teacherWeeklyHours[e.name]=0,this.teacherDailyHours[e.name]={},this.DAYS.forEach(s=>{this.teacherDailyHours[e.name][s]=0}))}),this.teacherExpectedWeeklyHours={},this.subjects.forEach(e=>{e&&e.teacher&&e.hoursPerWeek&&(this.teacherExpectedWeeklyHours[e.teacher]=(this.teacherExpectedWeeklyHours[e.teacher]||0)+e.hoursPerWeek)})}_generateClassTimetable(e){try{let s=this.subjects.filter(s=>s&&s.className===e);if(0===s.length)return console.warn(`No subjects found for ${e}`),!0;s.forEach(s=>{if(s){let a=`${e}-${s.name}`;this.subjectPlacementTracker[a]={placed:0,remaining:s.hoursPerWeek||0,dailyCount:{},lastPlacedSlot:-1},this.DAYS.forEach(e=>{this.subjectPlacementTracker[a].dailyCount[e]=0})}}),this.subjectPeriodUsage[e]||(this.subjectPeriodUsage[e]={}),this.labStartPositions[e]||(this.labStartPositions[e]={}),this._prePlaceLabs(e,s);for(let a=0;a<this.DAYS.length;a++){let t=this.DAYS[a];console.log(`  \u{1F4C5} ${t}:`);for(let i=0;i<this.PERIODS;i++){if(i>0){let t=this.classTimetables[e][a][i-1];if(t&&t.isLabContinuation&&t.blockRemaining>0){let l=s.find(e=>e.name===t.subject);if(l){this._placeSubject(e,a,i,l,!0,t.blockRemaining-1),console.log(`    P${i+1}: ${l.name} (Lab continuation)`);continue}}}let l=this._findBestSubject(e,a,i,s);if(l)if(l.isContinuous){let s=l.blockSize||2;if(i+s<=this.PERIODS){let r=!0;for(let n=0;n<s;n++){if(null!==this.classTimetables[e][a][i+n]){r=!1;break}let s=`${t}-P${i+1+n}`;if(this.teacherBusySlots[l.teacher]?.[s]||!this._isTeacherAvailable(l.teacher,a,i+n)){r=!1;break}}if(r){for(let t=0;t<s;t++)this._placeSubject(e,a,i+t,l,!0,s-t-1);console.log(`    P${i+1}-P${i+s}: ${l.name} (Lab block)`),i+=s-1;continue}console.log(`    P${i+1}: Cannot place ${l.name} lab (not enough space or teacher busy)`)}}else this._placeSubject(e,a,i,l,!1,0),console.log(`    P${i+1}: ${l.name}`);else console.log(`    P${i+1}: No suitable subject found (will remain empty)`)}}return!0}catch(s){return console.error(`\u{274C} Error generating timetable for ${e}:`,s),!1}}_prePlaceLabs(e,s){let a=s.filter(e=>e&&e.isContinuous);if(0===a.length)return;let t={};this.DAYS.forEach(e=>{t[e]=0});let i={};for(let s of a){let a=s.blockSize||2,l=s.hoursPerWeek||0;for(this.staff.find(e=>e.name===s.teacher);l>=a;){let r=!1,n=[];for(let l=0;l<this.DAYS.length;l++){let r=this.DAYS[l];for(let c=0;c<=this.PERIODS-a;c++){let d=!0;for(let t=0;t<a;t++){if(null!==this.classTimetables[e][l][c+t]){d=!1;break}let a=`${r}-P${c+1+t}`;if(this.teacherBusySlots[s.teacher]?.[a]||!this._isTeacherAvailable(s.teacher,l,c+t)){d=!1;break}}if(d){let d=100;if((0===c||c+a-1==this.PERIODS-1)&&(d-=25),t[r]>=1&&(d-=30),void 0!==i[s.name]&&1>Math.abs(l-i[s.name])&&(d-=20),(this.teacherDailyHours[s.teacher]?.[this.DAYS[l]]||0)>=3&&(d-=15),(this.labStartPositions[e][s.name]||new Set).has(c))continue;n.push({dayIdx:l,period:c,weight:Math.max(1,d)})}}}if(n.length>0){let c=this._weightedPick(n);for(let t=0;t<a;t++)this._placeSubject(e,c.dayIdx,c.period+t,s,!0,a-t-1);let d=this.DAYS[c.dayIdx];t[d]+=1,i[s.name]=c.dayIdx,l-=a,r=!0;let o=this.labStartPositions[e][s.name]||new Set;o.add(c.period),this.labStartPositions[e][s.name]=o}if(!r)for(let n=0;n<this.DAYS.length&&!r;n++){let c=this.DAYS[n];for(let d=0;d<=this.PERIODS-a;d++){let o=!0;for(let t=0;t<a;t++){if(null!==this.classTimetables[e][n][d+t]){o=!1;break}let a=`${c}-P${d+1+t}`;if(this.teacherBusySlots[s.teacher]?.[a]||!this._isTeacherAvailable(s.teacher,n,d+t)){o=!1;break}}if(o){for(let t=0;t<a;t++)this._placeSubject(e,n,d+t,s,!0,a-t-1);t[c]+=1,i[s.name]=n,l-=a,r=!0;let o=this.labStartPositions[e][s.name]||new Set;o.add(d),this.labStartPositions[e][s.name]=o;break}}}if(!r)break}}}_findBestSubject(e,s,a,t){let i=this.DAYS[s],l=`${i}-P${a+1}`,r=[];for(let n of t){if(!n||!n.name)continue;let t=`${e}-${n.name}`,c=this.subjectPlacementTracker[t];if(!c||c.remaining<=0||this.teacherBusySlots[n.teacher]?.[l]||!this._isTeacherAvailable(n.teacher,s,a))continue;let d=this.teacherExpectedWeeklyHours[n.teacher]||0,o=this.teacherWeeklyHours[n.teacher]||0;if(d>0&&o>=d)continue;let h=100,m=[],u=c.dailyCount[i]||0;if(!n.isContinuous)if(u>=this.dailyMaxPerSubject)continue;else 1===u&&(h-=25,m.push("Second usage same day -25"));let b=(this.subjectPeriodUsage[e][n.name]||{})[a]||0;if(!n.isContinuous)if(b>=2)continue;else 1===b?(h-=20,m.push("Repeat same period across days -20")):(h+=10,m.push("Prefer unused period slot +10"));if(!n.isContinuous){if(a>=1){let t=this.classTimetables[e][s][a-1]?.subject||null;if(t)for(let i=0;i<this.DAYS.length;i++){if(i===s)continue;let l=this.classTimetables[e][i]?.[a-1]?.subject||null,r=this.classTimetables[e][i]?.[a]?.subject||null;if(l===t&&r===n.name){h-=25,m.push("Avoid repeating pair order across days -25");break}}}if(a>=2){let t=this.classTimetables[e][s][a-2]?.subject||null,i=this.classTimetables[e][s][a-1]?.subject||null;if(t&&i)for(let l=0;l<this.DAYS.length;l++){if(l===s)continue;let r=this.classTimetables[e][l]?.[a-2]?.subject||null,c=this.classTimetables[e][l]?.[a-1]?.subject||null,d=this.classTimetables[e][l]?.[a]?.subject||null;if(r===t&&c===i&&d===n.name){h-=40,m.push("Avoid repeating triple order across days -40");break}}}}if(!n.isContinuous&&a>=2){let t=0;for(let i=1;i<=2;i++){let l=this.classTimetables[e][s][a-i];if(l&&l.subject===n.name&&!l.isLabContinuation)t++;else break}if(t>=2)continue;1===t&&(h-=25,m.push("Avoid back-to-back theory -25"))}if(n.isContinuous||(a>=1&&a<=4?(h+=20,m.push("Middle period theory +20")):(h-=25,m.push("Edge period theory -25"))),n.isContinuous){let t=n.blockSize||2;if(a+t>this.PERIODS)h-=1e3,m.push("Lab cannot fit -1000");else{a>=2&&(h+=25,m.push("Lab in afternoon +25")),a+t===this.PERIODS+1&&(h-=20,m.push("Lab at last period -20"));let i=0;for(let t=0;t<a;t++){let a=this.classTimetables[e][s][t];a&&a.isLabContinuation&&a.blockRemaining===(a.blockSize||2)-1&&i++}i>=1&&(h-=50,m.push("Second lab same day -50"))}}if(n.isContinuous||(this.DAYS.reduce((e,s)=>e+ +((c.dailyCount[s]||0)>0),0),0===c.dailyCount[i]&&(h+=15,m.push("Prefer spreading to new day +15"))),!n.isContinuous){let a=this.classTimetables[e][s],t=new Set;for(let e=0;e<a.length;e++){let s=a[e];s&&!s.isLabContinuation&&t.add(s.subject)}t.size<3&&(t.has(n.name)?(h-=30,m.push("Improve daily mix -30")):(h+=30,m.push("New subject improves mix +30")))}if(!n.isContinuous){let e=this.teacherDailyHours[n.teacher]?.[i]||0;e>=3?(h-=25,m.push("Teacher day dominance -25")):e>=2&&(h-=10,m.push("Teacher appearing often -10"))}let p=c.remaining/(n.hoursPerWeek||1);h+=20*p,m.push(`Remaining priority +${Math.round(20*p)}`);let x=this.staff.find(e=>e.name===n.teacher);if(x){let e=this.teacherDailyHours[n.teacher]?.[i]||0;if("manual"===x.freePeriodMode){if(e>=this.PERIODS-(x.manualFreePeriods||0))continue}else e>=this.PERIODS-1&&(h-=50,m.push("Auto: prefer leaving free period -50"))}let j=this.DAYS[s],f=0;for(let e=a-1;e>=0;e--){let s=`${j}-P${e+1}`;if(this.teacherBusySlots[n.teacher]?.[s])f++;else break}let g=0;for(let e=a+1;e<this.PERIODS;e++){let s=`${j}-P${e+1}`;if(this.teacherBusySlots[n.teacher]?.[s])g++;else break}f+1+g>3&&(h-=40,m.push("Avoid >3 consecutive teacher load -40")),r.push({subject:n,score:h,reasons:m})}if(r.length>0){let e=r.map(e=>({item:e.subject,weight:Math.max(1,Math.round(e.score))})),s=this._weightedPick(e);if(s)return s.item}return t.find(s=>{let a=`${e}-${s.name}`;return s&&this.subjectPlacementTracker[a]?.remaining>0})||null}_placeSubject(e,s,a,t,i,l){if(!e||!t||!t.name||!t.teacher)return;let r=this.DAYS[s],n=`${r}-P${a+1}`,c=`${e}-${t.name}`;if(this.classTimetables[e][s][a]={subject:t.name,teacher:t.teacher,type:t.subjectType||"Core",isLabContinuation:i,blockRemaining:l,blockSize:t.blockSize||2},!i||l===(t.blockSize||2)-1){let e=this.subjectPlacementTracker[c];e&&(i?(e.remaining-=t.blockSize||2,e.placed+=t.blockSize||2):(e.remaining-=1,e.placed+=1),e.dailyCount[r]=(e.dailyCount[r]||0)+1,e.lastPlacedSlot=s*this.PERIODS+a)}this.teacherBusySlots[t.teacher]||(this.teacherBusySlots[t.teacher]={}),this.teacherWeeklyHours[t.teacher]||(this.teacherWeeklyHours[t.teacher]=0),this.teacherDailyHours[t.teacher]||(this.teacherDailyHours[t.teacher]={},this.DAYS.forEach(e=>{void 0===this.teacherDailyHours[t.teacher][e]&&(this.teacherDailyHours[t.teacher][e]=0)})),this.teacherBusySlots[t.teacher][n]=!0,this.teacherWeeklyHours[t.teacher]=(this.teacherWeeklyHours[t.teacher]||0)+1,this.teacherDailyHours[t.teacher][r]=(this.teacherDailyHours[t.teacher][r]||0)+1;let d=this.subjectPeriodUsage[e][t.name]||{};d[a]=(d[a]||0)+1,this.subjectPeriodUsage[e][t.name]=d,this.placements.push({day:this.DAYS[s],period:a+1,subject:t.name,teacher:t.teacher,type:i?"lab":"theory",className:e})}_isTeacherAvailable(e,s,a){let t=this.DAYS[s],i=this.staff.find(s=>s.name===e),l=i?.availability;if(!l)return!0;let r=l[t];if(!Array.isArray(r))return!0;let n=r[a];return void 0===n||!!n}_weightedPick(e){let s=0;for(let a of e)s+=a.weight;if(s<=0)return null;let a=this._rng()*s;for(let s of e){if(a<s.weight)return s;a-=s.weight}return e[e.length-1]||null}_generateStaffTimetables(){console.log("\nðŸ‘¨â€ðŸ« Generating staff timetables..."),this.staff.filter(e=>e&&"staff"===e.role).forEach(e=>{e&&e.name&&(this.staffTimetables[e.name]=this.DAYS.map(()=>Array(this.PERIODS).fill(null).map(()=>({subject:"FREE",class:"-",type:"free"}))))}),this.classes.forEach(e=>{e&&e.name&&this.classTimetables[e.name]&&this.DAYS.forEach((s,a)=>{let t=this.classTimetables[e.name][a];t&&t.forEach((s,t)=>{s&&s.teacher&&this.staffTimetables[s.teacher]&&(this.staffTimetables[s.teacher][a][t]={subject:s.subject,class:e.name,type:s.type})})})}),console.log("âœ… Staff timetables generated")}}});
//# sourceMappingURL=AdminDashboard.a14ccb47.js.map
